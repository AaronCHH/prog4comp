
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Basic constructions</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <script src="http://sagecell.sagemath.org/static/jquery.min.js"></script>
        <script src="http://sagecell.sagemath.org/static/embedded_sagecell.js"></script>

        <script>sagecell.makeSagecell({inputLocation: ".sage"});</script>

        <style type="text/css">
                .sagecell .CodeMirror-scroll {
                        overflow-y: hidden;
                        overflow-x: auto;
                }
                .sagecell .CodeMirror {
                        height: auto;
                }
        </style>

    
    <link rel="top" title="Programming for Computations" href="index.html" />
    <link rel="next" title="Computing integrals" href="._pylight004.html" />
    <link rel="prev" title="The first few steps" href="._pylight002.html" />

   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  
       <style type="text/css">
         div.admonition {
           background-color: whiteSmoke;
           border: 1px solid #bababa;
         }
       </style>
      </head>
    
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="._pylight004.html" title="Computing integrals"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="._pylight002.html" title="The first few steps"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Programming for Computations</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="basic-constructions">
<h1>Basic constructions<a class="headerlink" href="#basic-constructions" title="Permalink to this headline">¶</a></h1>
<div class="figure">
<a class="reference internal image-reference" href="_images/opt_exec.png"><img alt="_images/opt_exec.png" src="_images/opt_exec.png" style="width: 800px;" /></a>
</div>
<div class="section" id="if-tests-colon-and-indentation">
<h2>If tests, colon and indentation<a class="headerlink" href="#if-tests-colon-and-indentation" title="Permalink to this headline">¶</a></h2>
<span class="target" id="index-0"></span><span class="target" id="index-1"></span><span class="target" id="index-2"></span><span class="target" id="index-3"></span><span class="target" id="index-4"></span><span class="target" id="index-5"></span><span class="target" id="index-6"></span><span class="target" id="index-7"></span><span class="target" id="index-8"></span><span class="target" id="index-9"></span><span class="target" id="index-10"></span><p id="index-11">Very often in life, and in computer programs, the next action depends on
the outcome of a question starting with &#8220;if&#8221;. This gives the possibility
to branch into different types of action depending on some criterion.
Let us as usual focus on a specific example, which is the core of
so-called random walk algorithms used in a wide range of branches in
science and engineering, including materials manufacturing and brain research.
The action is to move randomly to the north
(N), east (E), south (S), or west (W) with the same probability.
How can we implement such an action in life and in a computer program?</p>
<p>We need to randomly draw one out of four numbers to select the direction
in which to move.
A deck of cards can be
used in practice for this purpose. Let the four suits correspond to
the four directions: clubs to N, diamonds to E, hearts to S, and spades to W,
for instance. We draw a card, perform the corresponding move, and repeat
the process a large number of times. The resulting path is a typical
realization of the path of a diffusing molecule.</p>
<p>In a computer program, we need to draw a random number, and depending on
the number, update the coordinates of the point to be moved.
There are many ways to draw random numbers and translate them into
(e.g.) four random directions, but the technical details usually depend
on the programming language. Our technique here is universal: we draw a
random number in the interval <span class="math">\([0,1)\)</span> and let <span class="math">\([0,0.25)\)</span> correspond to
N, <span class="math">\([0.25,0.5)\)</span> to E, <span class="math">\([0.5,0.75)\)</span> to S, and <span class="math">\([0.75,1)\)</span> to W.
Let <code class="docutils literal"><span class="pre">x</span></code> and <code class="docutils literal"><span class="pre">y</span></code> hold the coordinates of a point and let <code class="docutils literal"><span class="pre">d</span></code> be
the length of the move. A pseudo code (i.e., not &#8220;real&#8221; code, just
a &#8220;sketch of the logic&#8221;) then goes like</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">r</span> <span class="o">=</span> <span class="n">random</span> <span class="n">number</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mf">0.25</span>
   <span class="n">move</span> <span class="n">north</span><span class="p">:</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">d</span>
<span class="k">else</span> <span class="k">if</span> <span class="mf">0.25</span> <span class="o">&lt;=</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mf">0.5</span>
   <span class="n">move</span> <span class="n">east</span><span class="p">:</span>  <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">d</span>
<span class="k">else</span> <span class="k">if</span> <span class="mf">0.5</span> <span class="o">&lt;=</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mf">0.75</span>
   <span class="n">move</span> <span class="n">south</span><span class="p">:</span>  <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">d</span>
<span class="k">else</span> <span class="k">if</span> <span class="mf">0.75</span> <span class="o">&lt;=</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mi">1</span>
   <span class="n">move</span> <span class="n">west</span><span class="p">:</span>  <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">d</span>
</pre></div>
</div>
<p>Note the need for first asking about the value of <code class="docutils literal"><span class="pre">r</span></code> and then performing an
action. If the answer to the &#8220;if&#8221; question is positive (true), we are done
and can skip the next <code class="docutils literal"><span class="pre">else</span> <span class="pre">if</span></code> questions.
If the answer is negative (false), we
proceed with the next question. The last test if <span class="math">\(0.75\leq r &lt; 1\)</span>
could also read just <code class="docutils literal"><span class="pre">else</span></code>, since we here cover all the remaining
possible <code class="docutils literal"><span class="pre">r</span></code> values.</p>
<p>The exact code in Python reads</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">random</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>        <span class="c"># random number in [0,1)</span>
<span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mf">0.25</span><span class="p">:</span>
   <span class="c"># move north</span>
   <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">d</span>
<span class="k">elif</span> <span class="mf">0.25</span> <span class="o">&lt;=</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>
   <span class="c"># move east</span>
   <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">d</span>
<span class="k">elif</span> <span class="mf">0.5</span> <span class="o">&lt;=</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mf">0.75</span><span class="p">:</span>
   <span class="c"># move south</span>
   <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">d</span>
<span class="k">else</span><span class="p">:</span>
   <span class="c"># move west</span>
   <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">d</span>
</pre></div>
</div>
<p>We use <code class="docutils literal"><span class="pre">else</span></code> in the last test to cover the different types of
syntax that is allowed.
Python recognizes the reserved words <code class="docutils literal"><span class="pre">if</span></code>, <code class="docutils literal"><span class="pre">elif</span></code> (short for <code class="docutils literal"><span class="pre">else</span> <span class="pre">if</span></code>),
and <code class="docutils literal"><span class="pre">else</span></code>
and expects the code to be compatible with the rules of if tests:</p>
<blockquote>
<div><ul class="simple">
<li>The test reads <code class="docutils literal"><span class="pre">if</span> <span class="pre">condition:</span></code>, <code class="docutils literal"><span class="pre">elif</span> <span class="pre">condition:</span></code>, or <code class="docutils literal"><span class="pre">else:</span></code>, where
<code class="docutils literal"><span class="pre">condition</span></code> is a <em>boolean expression</em> that evaluates to <code class="docutils literal"><span class="pre">True</span></code> or <code class="docutils literal"><span class="pre">False</span></code>.
Note the closing colon (easy to forget!).</li>
<li>If <code class="docutils literal"><span class="pre">condition</span></code> is <code class="docutils literal"><span class="pre">True</span></code>, the following <em>indented</em> block of statements
are executed and the remaining <code class="docutils literal"><span class="pre">if</span></code>, <code class="docutils literal"><span class="pre">elif</span></code>, or <code class="docutils literal"><span class="pre">else</span></code> branches are
skipped.</li>
<li>If <code class="docutils literal"><span class="pre">condition</span></code> is <code class="docutils literal"><span class="pre">False</span></code>, the program flow jumps to the next
<code class="docutils literal"><span class="pre">if</span></code>, <code class="docutils literal"><span class="pre">elif</span></code>, or <code class="docutils literal"><span class="pre">else</span></code> branch.</li>
</ul>
</div></blockquote>
<p>The blocks after <code class="docutils literal"><span class="pre">if</span></code>, <code class="docutils literal"><span class="pre">elif</span></code>, or <code class="docutils literal"><span class="pre">else</span></code> may contain new if tests, if desired.
Regarding colon and indent, you will see below that these are
required in several other programming constructions as well.</p>
<p id="index-12">Working with if tests requires mastering boolean expressions.
Here are some basic boolean expressions involving the
<em>logical operators</em> <code class="docutils literal"><span class="pre">==</span></code>, <code class="docutils literal"><span class="pre">!=</span></code>, <code class="docutils literal"><span class="pre">&lt;</span></code>, <code class="docutils literal"><span class="pre">&lt;=</span></code>, <code class="docutils literal"><span class="pre">&gt;</span></code>, and <code class="docutils literal"><span class="pre">&gt;=</span></code>.
Given the assignment to <code class="docutils literal"><span class="pre">temp</span></code>, you should go through each boolean
expression and determine if it is true or false.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">temp</span> <span class="o">=</span> <span class="mi">21</span>       <span class="c"># assign value to a variable</span>
<span class="n">temp</span> <span class="o">==</span> <span class="mi">20</span>      <span class="c"># temp equal to 20</span>
<span class="n">temp</span> <span class="o">!=</span> <span class="mi">20</span>      <span class="c"># temp not equal to 20</span>
<span class="n">temp</span> <span class="o">&lt;</span>  <span class="mi">20</span>      <span class="c"># temp less than 20</span>
<span class="n">temp</span> <span class="o">&gt;</span>  <span class="mi">20</span>      <span class="c"># temp greater than 20</span>
<span class="n">temp</span> <span class="o">&lt;=</span> <span class="mi">20</span>      <span class="c"># temp less than or equal to 20</span>
<span class="n">temp</span> <span class="o">&gt;=</span> <span class="mi">20</span>      <span class="c"># temp greater than or equal to 20</span>
</pre></div>
</div>
</div>
<div class="section" id="functions">
<span id="sec-functions"></span><h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<span class="target" id="index-13"></span><span class="target" id="index-14"></span><span class="target" id="index-15"></span><span class="target" id="index-16"></span><span class="target" id="index-17"></span><span class="target" id="index-18"></span><p id="index-19">Functions are widely used in programming and is a concept that needs to
be mastered. In the simplest case, a function in a program is much like
a mathematical function: some input number <span class="math">\(x\)</span> is transformed to some output
number.
One example is the <span class="math">\(\tanh^{-1}(x)\)</span> function, called <code class="docutils literal"><span class="pre">atan</span></code> in computer
code: it takes one real number as input and returns another number.
Functions in Python are more general and can take a series of
variables as input and return one or more variables, or simply nothing.
The purpose of functions is two-fold:</p>
<ol class="arabic simple">
<li>to <em>group statements</em> into separate units of code lines that naturally belong together (a
strategy which may dramatically ease the problem solving process), and/or</li>
<li>to <em>parameterize</em> a set of statements such that they can be written only
once and easily be re-executed with variations.</li>
</ol>
<p>Examples will be given to illustrate how functions can be written in various contexts.</p>
<p>If we modify the program <code class="docutils literal"><span class="pre">ball.py</span></code> from the chapter <a class="reference internal" href="._pylight002.html#st-ex1"><span>A Python program with variables</span></a>
slightly, and include a function, we could let this be a new program
<a class="reference external" href="https://github.com/hplgit/prog4comp/src/py/ball_function.py">ball_function.py</a>
as</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">y</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="n">v0</span> <span class="o">=</span> <span class="mi">5</span>                    <span class="c"># Initial velocity</span>
    <span class="n">g</span> <span class="o">=</span> <span class="mf">9.81</span>                  <span class="c"># Acceleration of gravity</span>
    <span class="k">return</span> <span class="n">v0</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span>

<span class="n">time</span> <span class="o">=</span> <span class="mf">0.6</span>       <span class="c"># Just pick one point in time</span>
<span class="k">print</span> <span class="n">y</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
<span class="n">time</span> <span class="o">=</span> <span class="mf">0.9</span>       <span class="c"># Pick another point in time</span>
<span class="k">print</span> <span class="n">y</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
</pre></div>
</div>
<p>When Python reads and interprets this program from the top, it takes
the code from the line with <code class="docutils literal"><span class="pre">def</span></code>, to the line with <code class="docutils literal"><span class="pre">return</span></code>, to be
the definition of a function with the name <code class="docutils literal"><span class="pre">y</span></code> (note colon and
indentation). The <em>return statement</em> of the function <code class="docutils literal"><span class="pre">y</span></code>, i.e.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">return</span> <span class="n">v0</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
<p>will be understood by Python as <em>first compute the expression, then
send the result back (i.e., return) to where the function was called
from</em>. Both <code class="docutils literal"><span class="pre">def</span></code> and <code class="docutils literal"><span class="pre">return</span></code> are reserved words. The function
depends on one variable (or we say that it takes one <em>argument</em> or
<em>input parameter</em>), the value of which must be provided when the
function is called.</p>
<p>What actually happens when Python meets this code? The <code class="docutils literal"><span class="pre">def</span></code> line
just tells Python that here is a function with name <code class="docutils literal"><span class="pre">y</span></code> and it
has one argument <code class="docutils literal"><span class="pre">t</span></code>. Python does not look into the function at
this stage (except that it checks the code for syntax errors).
When Python later on meets the statement <code class="docutils literal"><span class="pre">print</span> <span class="pre">y(time)</span></code>, it
recognizes a function call <code class="docutils literal"><span class="pre">y(time)</span></code> and recalls that there is a
function <code class="docutils literal"><span class="pre">y</span></code> defined with one argument. The value of <code class="docutils literal"><span class="pre">time</span></code> is
then transferred to the <code class="docutils literal"><span class="pre">y(t)</span></code> function such that <code class="docutils literal"><span class="pre">t</span> <span class="pre">=</span> <span class="pre">time</span></code>
becomes the first action in the <code class="docutils literal"><span class="pre">y</span></code> function. Then Python
executes one line at a time in the <code class="docutils literal"><span class="pre">y</span></code> function.
In the final line, the arithmetic expression <code class="docutils literal"><span class="pre">v0*t</span> <span class="pre">-</span> <span class="pre">0.5*g*t**2</span></code>
is computed, resulting in a number, and this number (or more
precisely, the Python object representing the number) <em>replaces</em>
the call <code class="docutils literal"><span class="pre">y(time)</span></code> in the calling code such that we have <code class="docutils literal"><span class="pre">print</span></code>
proceeded by a number rather than a function call.</p>
<p>Python proceeds with the next line and sets <code class="docutils literal"><span class="pre">time</span></code> to a new value.
The next <code class="docutils literal"><span class="pre">print</span></code> statement triggers a new call to <code class="docutils literal"><span class="pre">y(t)</span></code>, this time
<code class="docutils literal"><span class="pre">t</span></code> is set to <code class="docutils literal"><span class="pre">0.9</span></code>, the computations are done line by line in the
<code class="docutils literal"><span class="pre">y</span></code> function, and the returned results replaces <code class="docutils literal"><span class="pre">y(time)</span></code>.
Instead of writing <code class="docutils literal"><span class="pre">print</span> <span class="pre">y(time)</span></code>, we could
alternatively have stored the returned result from the <code class="docutils literal"><span class="pre">y</span></code> function
in a variable,</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">h</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
<span class="k">print</span> <span class="n">h</span>
</pre></div>
</div>
<p>Note that when a function contains <code class="docutils literal"><span class="pre">if-elif-else</span></code> constructions,
<code class="docutils literal"><span class="pre">return</span></code> may be done from within any of the branches. This may be
illustrated by the following function containing three <code class="docutils literal"><span class="pre">return</span></code>
statements:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">check_sign</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">&#39;x is positive&#39;</span>
    <span class="k">elif</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">&#39;x is negative&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">&#39;x is zero&#39;</span>
</pre></div>
</div>
<p>Remember that only one of the branches is executed for a single call
on <code class="docutils literal"><span class="pre">check_sign</span></code>, so depending on the number <code class="docutils literal"><span class="pre">x</span></code>, the return may take
place from any of the three return alternatives.</p>
<div class="admonition-to-return-at-the-end-or-not admonition">
<p class="first admonition-title">To return at the end or not</p>
<p class="last">Programmers disagree whether it is a good idea to use <code class="docutils literal"><span class="pre">return</span></code>
inside a function where you want, or if there should only be
one single <code class="docutils literal"><span class="pre">return</span></code> statement <em>at the end of the function</em>.
The authors of this book emphasize readable code and
think that <code class="docutils literal"><span class="pre">return</span></code> can be useful in branches as in the example above
when the function is short. For longer or more complicated functions,
it might be better to have one single <code class="docutils literal"><span class="pre">return</span></code> statement.
Be prepared for critical comments if you return wherever you want...</p>
</div>
<p>An expression you will often encounter when dealing with programming, is <em>main
program</em>, or that some code is <em>in main</em>. This is nothing particular
to Python, and simply refers to that part of the program which is
<em>outside</em> functions. However, note that the <code class="docutils literal"><span class="pre">def</span></code> line of functions is
counted into main. So, in <code class="docutils literal"><span class="pre">ball_function.py</span></code> above, all
statements outside the function <code class="docutils literal"><span class="pre">y</span></code> are in main, and also the line
<code class="docutils literal"><span class="pre">def</span> <span class="pre">y(t):</span></code>.</p>
<p>A function may take no arguments, or many, in which case they are just
listed within the parentheses (following the function name) and
separated by a comma. Let us illustrate. Take a slight variation of the
ball example and assume that the ball is not thrown straight up, but
at an angle, so that two coordinates are needed to specify its
position at any time. According to Newton&#8217;s laws (when air resistance
is negligible), the vertical position is given by <span class="math">\(y(t) = v_{0y}t - 0.5gt^2\)</span> and
the horizontal position by <span class="math">\(x(t) = v_{0x}t\)</span>. We can include both these
expressions in a new version of our program that prints the position
of the ball for chosen times. Assume we want to evaluate these expressions at two
points in time, <span class="math">\(t = 0.6s\)</span> and <span class="math">\(t = 0.9s\)</span>. We can pick some numbers
for the initial velocity components <code class="docutils literal"><span class="pre">v0y</span></code> and <code class="docutils literal"><span class="pre">v0x</span></code>, name the program
<a class="reference external" href="https://github.com/hplgit/prog4comp/src/py/ball_position.py">ball_position.py</a>,
and write it for example as</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">y</span><span class="p">(</span><span class="n">v0y</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="n">g</span> <span class="o">=</span> <span class="mf">9.81</span>                  <span class="c"># Acceleration of gravity</span>
    <span class="k">return</span> <span class="n">v0y</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span>

<span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="n">v0x</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">v0x</span><span class="o">*</span><span class="n">t</span>

<span class="n">initial_velocity_x</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">initial_velocity_y</span> <span class="o">=</span> <span class="mf">5.0</span>

<span class="n">time</span> <span class="o">=</span> <span class="mf">0.6</span>       <span class="c"># Just pick one point in time</span>
<span class="k">print</span> <span class="n">x</span><span class="p">(</span><span class="n">initial_velocity_x</span><span class="p">,</span> <span class="n">time</span><span class="p">),</span> <span class="n">y</span><span class="p">(</span><span class="n">initial_velocity_y</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>
<span class="n">time</span> <span class="o">=</span> <span class="mf">0.9</span>       <span class="c"># ... Pick another point in time</span>
<span class="k">print</span> <span class="n">x</span><span class="p">(</span><span class="n">initial_velocity_x</span><span class="p">,</span> <span class="n">time</span><span class="p">),</span> <span class="n">y</span><span class="p">(</span><span class="n">initial_velocity_y</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we compute and print the two components for the position, for each
of the two chosen points in time. Notice how each of the two functions
now takes <em>two</em> arguments. Running the program gives the output</p>
<div class="highlight-text"><div class="highlight"><pre>1.2  1.2342
1.8  0.52695
</pre></div>
</div>
<p>A function may also have no return value, in which case we simply drop
the return statement, or it may return more than one value. For
example, the two functions we just defined could alternatively have
been written as one:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">xy</span><span class="p">(</span><span class="n">v0x</span><span class="p">,</span> <span class="n">v0y</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="n">g</span> <span class="o">=</span> <span class="mf">9.81</span>                          <span class="c"># acceleration of gravity</span>
    <span class="k">return</span> <span class="n">v0x</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="n">v0y</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
<p>Notice the two return values which are simply separated by a
comma. When calling the function (and printing), arguments must appear
in the same order as in the function definition. We would then write</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">print</span> <span class="n">xy</span><span class="p">(</span><span class="n">initial_x_velocity</span><span class="p">,</span> <span class="n">initial_y_velocity</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>
</pre></div>
</div>
<p>The two returned values from the function could alternatively have
been assigned to variables, e.g., as</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">x_pos</span><span class="p">,</span> <span class="n">y_pos</span> <span class="o">=</span> <span class="n">xy</span><span class="p">(</span><span class="n">initial_x_velocity</span><span class="p">,</span> <span class="n">initial_y_velocity</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>
</pre></div>
</div>
<p>The variables <code class="docutils literal"><span class="pre">x_pos</span></code> and <code class="docutils literal"><span class="pre">y_pos</span></code> could then have been printed or used
in other ways in the code.</p>
<p>There are possibilities for having a variable number of function input
and output parameters (using <code class="docutils literal"><span class="pre">*args</span></code> and <code class="docutils literal"><span class="pre">**kwargs</span></code> constructions
for the arguments). However, we do not go further into that topic here.</p>
<span class="target" id="index-20"></span><p id="index-21">Variables that are defined inside a function, e.g., <code class="docutils literal"><span class="pre">g</span></code> in the last
<code class="docutils literal"><span class="pre">xy</span></code> function, are <em>local variables</em>. This means they are only known
inside the function. Therefore, if you had accidentally used <code class="docutils literal"><span class="pre">g</span></code> in
some calculation outside the function, you would have got an error
message. The variable <code class="docutils literal"><span class="pre">time</span></code> is defined outside the function and is
therefore a <em>global variable</em>. It is known both outside and inside the
function(s). If you define one global and one local variable, both
with the same name, the function only sees the local one, so the
global variable is not affected by what happens with the local
variable of the same name.</p>
<p>The arguments named in the heading of a function definition are by
rule local variables inside the function. If you want to change the
value of a global variable inside a function, you need to declare the
variable as global inside the function. That is, if the global
variable was <code class="docutils literal"><span class="pre">x</span></code>, we would need to write <code class="docutils literal"><span class="pre">global</span> <span class="pre">x</span></code> inside the
function definition before we let the function change it. After function
execution, <code class="docutils literal"><span class="pre">x</span></code> would then have a changed value. One should
strive to define variables mostly where they are needed and not
everywhere.</p>
<span class="target" id="index-22"></span><span class="target" id="index-23"></span><span class="target" id="index-24"></span><p id="index-25">Another very useful way of handling function parameters in Python, is
by defining parameters as <em>keyword arguments</em>. This gives default
values to parameters and allows more freedom in function calls, since
the order and number of parameters may vary.</p>
<p>Let us illustrate the use of keyword arguments with the function
<code class="docutils literal"><span class="pre">xy</span></code>. Assume we defined <code class="docutils literal"><span class="pre">xy</span></code> as</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">xy</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">v0x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">v0y</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">g</span> <span class="o">=</span> <span class="mf">9.81</span>                          <span class="c"># acceleration of gravity</span>
    <span class="k">return</span> <span class="n">v0x</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="n">v0y</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
<p>Here, <code class="docutils literal"><span class="pre">t</span></code> is an <em>ordinary</em> or <em>positional argument</em>, whereas <code class="docutils literal"><span class="pre">v0x</span></code> and
<code class="docutils literal"><span class="pre">v0y</span></code> are <em>keyword arguments</em> or <em>named arguments</em>. Generally, there
can be many positional arguments and many keyword arguments, but the
positional arguments must <em>always</em> be listed before the keyword
arguments in function definition. Keyword arguments are given default
values, as shown here with <code class="docutils literal"><span class="pre">v0x</span></code> and <code class="docutils literal"><span class="pre">v0y</span></code>, both having zero as default
value. In a script, the function <code class="docutils literal"><span class="pre">xy</span></code> may now be called in many
different ways. For example,</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">print</span> <span class="n">xy</span><span class="p">(</span><span class="mf">0.6</span><span class="p">)</span>
</pre></div>
</div>
<p>would make <code class="docutils literal"><span class="pre">xy</span></code> perform the computations with <code class="docutils literal"><span class="pre">t</span> <span class="pre">=</span> <span class="pre">0.6</span></code> and the default
values (i.e zero) of <code class="docutils literal"><span class="pre">v0x</span></code> and <code class="docutils literal"><span class="pre">v0y</span></code>. The two numbers returned from
<code class="docutils literal"><span class="pre">xy</span></code> are printed to the screen. If we wanted to use another initial
value for <code class="docutils literal"><span class="pre">v0y</span></code>, we could, e.g., write</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">print</span> <span class="n">xy</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span><span class="n">v0y</span><span class="o">=</span><span class="mf">4.0</span><span class="p">)</span>
</pre></div>
</div>
<p>which would make <code class="docutils literal"><span class="pre">xy</span></code> perform the calculations with <code class="docutils literal"><span class="pre">t</span> <span class="pre">=</span> <span class="pre">0.6</span></code>, <code class="docutils literal"><span class="pre">v0x</span> <span class="pre">=</span> <span class="pre">0</span></code>
(i.e. the default value) and <code class="docutils literal"><span class="pre">v0y</span> <span class="pre">=</span> <span class="pre">4.0</span></code>. When there are several
positional arguments, they have to appear in the same order as defined
in the function definition, unless we explicitly use the names of
these also in the function call. With explicit name specification in
the call, any order of parameters is acceptable. To illustrate, we
could, e.g., call <code class="docutils literal"><span class="pre">xy</span></code> as</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">print</span> <span class="n">xy</span><span class="p">(</span><span class="n">v0y</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">v0x</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
</pre></div>
</div>
<span class="target" id="index-26"></span><p id="index-27">In any programming language, it is a good habit to include a little
explanation of what the function is doing, unless what is done by the
function is obvious, e.g., when having only a few simple code lines. This
explanation is called a <em>doc string</em>, which in Python should be placed just at the top of the function.
This explanation is meant for a human who wants
to understand the code, so it should say something about the purpose
of the code and possibly explain the arguments and return values if
needed. If we do that with our <code class="docutils literal"><span class="pre">xy</span></code> function from above, we may write
the first lines of the function as</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">xy</span><span class="p">(</span><span class="n">v0x</span><span class="p">,</span> <span class="n">v0y</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute the x and y position of the ball at time t&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Note that other functions may be called from within other functions,
and function input parameters are not required to be numbers. Any
object will do, e.g., string variables or other functions.</p>
<p>Functions are straightforwardly passed as arguments to other functions, as illustrated by the following script
<a class="reference external" href="https://github.com/hplgit/prog4comp/src/py/function_as_argument.py">function_as_argument.py</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">sum_xy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>

<span class="k">def</span> <span class="nf">prod_xy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span>

<span class="k">def</span> <span class="nf">treat_xy</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>  <span class="n">y</span> <span class="o">=</span> <span class="mi">3</span>
<span class="k">print</span> <span class="n">treat_xy</span><span class="p">(</span><span class="n">sum_xy</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="k">print</span> <span class="n">treat_xy</span><span class="p">(</span><span class="n">prod_xy</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>When run, this program first prints the sum of <code class="docutils literal"><span class="pre">x</span></code> and <code class="docutils literal"><span class="pre">y</span></code> (i.e., 5),
and then it prints the product (i.e., 6). We see that <code class="docutils literal"><span class="pre">treat_xy</span></code> takes
a function name as its first parameter. Inside <code class="docutils literal"><span class="pre">treat_xy</span></code>, that
function is used to actually <em>call</em> the function that was given as
input parameter. Therefore, as shown, we may call <code class="docutils literal"><span class="pre">treat_xy</span></code> with
either <code class="docutils literal"><span class="pre">sum_xy</span></code> or <code class="docutils literal"><span class="pre">prod_xy</span></code>, depending on whether we want the sum or
product of <code class="docutils literal"><span class="pre">x</span></code> and <code class="docutils literal"><span class="pre">y</span></code> to be calculated.</p>
<span class="target" id="index-28"></span><span class="target" id="index-29"></span><p id="index-30">Functions may also be defined <em>within</em> other functions. It that case,
they become <em>local functions</em>, or <em>nested functions</em>, known only to
the function inside which they are defined. Functions defined in main
are referred to as <em>global functions</em>.  A nested function has full
access to all variables in the <em>parent function</em>, i.e. the function
within which it is defined.</p>
<p id="index-31">Short functions can be defined in a compact way, using what is known
as a <em>lambda function</em>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span>

<span class="c"># Equivalent</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span>
</pre></div>
</div>
<p>The syntax consists of <code class="docutils literal"><span class="pre">lambda</span></code> followed by a series of arguments, colon,
and some Python expression resulting in an object to be returned from
the function. Lambda functions are particularly convenient as
function arguments:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">print</span> <span class="n">treat_xy</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition-overhead-of-function-calls admonition">
<p class="first admonition-title">Overhead of function calls</p>
<p class="last">Function calls have the downside of slowing down program execution.
Usually, it is a good thing to split a program into functions, but
in very computing intensive parts, e.g., inside long loops, one
must balance the convenience of calling a function and the
computational efficiency of avoiding function calls. It is a good
rule to develop a program using plenty of functions and then
in a later optimization stage, when everything computes correctly,
remove function calls that are quantified to slow down the code.</p>
</div>
</div>
<div class="section" id="for-loops">
<span id="sec-for-loops"></span><h2>For loops<a class="headerlink" href="#for-loops" title="Permalink to this headline">¶</a></h2>
<span class="target" id="index-32"></span><span class="target" id="index-33"></span><span class="target" id="index-34"></span><span class="target" id="index-35"></span><p id="index-36">Many computations are repetitive by nature and programming languages
have certain <em>loop structures</em> to deal with this. Here we will present
what is referred to as a <em>for loop</em> (another kind of loop is a <em>while</em>
loop, to be presented below). Assume you want to calculate the square
of each integer from 3 to 7. This could be done with the following
two-line program.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]:</span>
    <span class="k">print</span> <span class="n">i</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
<p>Note the colon and indentation again!</p>
<p>What happens when Python interprets your code here? First of all, the
word <code class="docutils literal"><span class="pre">for</span></code> is a reserved word signalling to Python that a <code class="docutils literal"><span class="pre">for</span></code> loop
is wanted. Python then sticks to the rules covering such
constructions and understands that, in the present example, the loop should
run 5 successive times (i.e., 5 <em>iterations</em> should be done),
letting the variable <code class="docutils literal"><span class="pre">i</span></code> take on the numbers <span class="math">\(3, 4, 5, 6, 7\)</span> in turn.
During each iteration, the statement inside the loop
(i.e. <code class="docutils literal"><span class="pre">print</span> <span class="pre">i**2</span></code>)
is carried out.  After each iteration, <code class="docutils literal"><span class="pre">i</span></code> is automatically (behind
the scene) updated. When the last number is reached, the last
iteration is performed and the loop is finished. When executed, the
program will therefore print out <span class="math">\(9, 16, 25, 36\)</span> and <span class="math">\(49\)</span>. The
variable <code class="docutils literal"><span class="pre">i</span></code> is often referred to as a <em>loop index</em>, and its name
(here <code class="docutils literal"><span class="pre">i</span></code>) is a choice of the programmer.</p>
<p>Note that, had there been several statements within the loop, they
would all be executed with the same value of <code class="docutils literal"><span class="pre">i</span></code> (before <code class="docutils literal"><span class="pre">i</span></code> changed
in the next iteration). Make sure you understand how program execution
flows here, it is important.</p>
<p>In Python, integer values specified for the loop variable are often produced by the built-in
function <code class="docutils literal"><span class="pre">range</span></code>. The function <code class="docutils literal"><span class="pre">range</span></code> may be called in different ways, that either
explicitly, or implicitly, specify the start, stop and step (i.e. change) of the loop
variable. Generally, a call to <code class="docutils literal"><span class="pre">range</span></code> may read</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
</pre></div>
</div>
<p>This call makes <code class="docutils literal"><span class="pre">range</span></code> return the integers from (and including) <code class="docutils literal"><span class="pre">start</span></code>,
up to (and excluding) <code class="docutils literal"><span class="pre">stop</span></code>, in steps of <code class="docutils literal"><span class="pre">step</span></code>. Note here that <code class="docutils literal"><span class="pre">stop-1</span></code>
is that last integer included. With <code class="docutils literal"><span class="pre">range</span></code>, the previous example would
rather read</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">i</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
<p>By default, if <code class="docutils literal"><span class="pre">range</span></code> is called with only two parameters, these are taken
to be <code class="docutils literal"><span class="pre">stop</span></code> and <code class="docutils literal"><span class="pre">step</span></code>, in which case a start at 0 is understood.
If only a single parameter is used in the call to <code class="docutils literal"><span class="pre">range</span></code>, this parameter is
taken to be <code class="docutils literal"><span class="pre">stop</span></code>. The default step of 1 is then used (combined with the
starting at 0). Thus, calling <code class="docutils literal"><span class="pre">range</span></code>, for example, as</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
<p>would return the list of integers <code class="docutils literal"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">5]</span></code>.</p>
<p>Note that decreasing integers may be produced by letting <code class="docutils literal"><span class="pre">start</span> <span class="pre">&gt;</span> <span class="pre">stop</span></code> combined
with a negative step. This makes it easy to, e.g., traverse
arrays in either direction.</p>
<p>Let us modify <code class="docutils literal"><span class="pre">ball_plot.py</span></code> from the chapter <a class="reference internal" href="._pylight002.html#st-ex3"><span>A Python program with vectorization and plotting</span></a> to illustrate how useful <code class="docutils literal"><span class="pre">for</span></code> loops are if you need to traverse arrays. In that example we computed the height of the ball at every milli-second during the first second of its (vertical) flight and plotted the height versus time.</p>
<p>Assume we want to find the maximum height during that time, how can we do it with a computer program? One alternative may be to compute all the thousand heights, store them in an array, and then run through the array to pick out the maximum. The program, named
<a class="reference external" href="https://github.com/hplgit/prog4comp/src/py/ball_ma_height.py">ball_max_height.py</a>,
may look as follows.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="n">v0</span> <span class="o">=</span> <span class="mi">5</span>                    <span class="c"># Initial velocity</span>
<span class="n">g</span> <span class="o">=</span> <span class="mf">9.81</span>                  <span class="c"># Acceleration of gravity</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>  <span class="c"># 1000 points in time interval</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">v0</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span>     <span class="c"># Generate all heights</span>

<span class="c"># At this point, the array y with all the heights is ready.</span>
<span class="c"># Now we need to find the largest value within y.</span>

<span class="n">largest_height</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>          <span class="c"># Starting value for search</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">largest_height</span><span class="p">:</span>
        <span class="n">largest_height</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

<span class="k">print</span> <span class="s">&quot;The largest height achieved was </span><span class="si">%f</span><span class="s"> m&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">largest_height</span><span class="p">)</span>

<span class="c"># We might also like to plot the path again just to compare</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Height (m)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>There is nothing new here, except the <code class="docutils literal"><span class="pre">for</span></code> loop construction, so let us look at it in more detail. As explained above, Python understands that a <code class="docutils literal"><span class="pre">for</span></code> loop is desired when it sees the word <code class="docutils literal"><span class="pre">for</span></code>.
The <code class="docutils literal"><span class="pre">range()</span></code> function will produce integers from, and including, <span class="math">\(1\)</span>,
up to, and including, <span class="math">\(999\)</span>, i.e. <span class="math">\(1000 - 1\)</span>. The value in <code class="docutils literal"><span class="pre">y[0]</span></code> is
used as the <em>preliminary</em> largest height, so that, e.g., the very
first check that is made is testing whether <code class="docutils literal"><span class="pre">y[1]</span></code> is larger than this
height. If so, <code class="docutils literal"><span class="pre">y[1]</span></code> is stored as the largest height. The for loop
then updates <code class="docutils literal"><span class="pre">i</span></code> to 2, and continues to check <code class="docutils literal"><span class="pre">y[2]</span></code>, and so on.
Each time we find a larger number, we store it.
When finished,
<code class="docutils literal"><span class="pre">largest_height</span></code> will contain the largest number from the array
<code class="docutils literal"><span class="pre">y</span></code>. When you run the program, you get</p>
<div class="highlight-text"><div class="highlight"><pre>The largest height achieved was 1.274210 m
</pre></div>
</div>
<p>which compares favorably to the plot that pops up.</p>
<p>To implement the traversing of arrays with loops and indices, is
sometimes challenging to get right. You need to understand the start,
stop and step length choices for an index, and also how the index
should enter expressions inside the loop. At the same time, however,
it is something that programmers do often, so it is important to
develop the right skills on these matters.</p>
<span class="target" id="index-37"></span><span class="target" id="index-38"></span><span class="target" id="index-39"></span><p id="index-40">Having one loop inside another, referred to as a <em>double loop</em>, is
sometimes useful, e.g., when doing linear algebra. Say we want to find
the maximum among the numbers stored in a <span class="math">\(4 \times 4\)</span> matrix <code class="docutils literal"><span class="pre">A</span></code>. The
code fragment could look like</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">largest_number</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">largest_number</span><span class="p">:</span>
            <span class="n">largest_number</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
</pre></div>
</div>
<p>Here, all the <code class="docutils literal"><span class="pre">j</span></code> indices (<code class="docutils literal"><span class="pre">0</span> <span class="pre">-</span> <span class="pre">3</span></code>) will be covered for <em>each</em> value
of index <code class="docutils literal"><span class="pre">i</span></code>. First, <code class="docutils literal"><span class="pre">i</span></code> stays fixed at <code class="docutils literal"><span class="pre">i</span> <span class="pre">=</span> <span class="pre">0</span></code>, while <code class="docutils literal"><span class="pre">j</span></code> runs over
all its indices. Then, <code class="docutils literal"><span class="pre">i</span></code> stays fixed at <code class="docutils literal"><span class="pre">i</span> <span class="pre">=</span> <span class="pre">1</span></code> while <code class="docutils literal"><span class="pre">j</span></code> runs over
all its indices again, and so on.
Sketch <code class="docutils literal"><span class="pre">A</span></code> on a piece of paper and
follow the first few loop iterations by hand, then you will realize
how the double loop construction works. Using two loops is just a
special case of using <em>multiple</em> or <em>nested loops</em>, and utilizing more
than two loops is just a straightforward extension of what was shown
here. Note, however, that the loop index <em>name</em> in multiple loops must
be unique to each of the nested loops. Note also that each nested loop
may have as many code lines as desired, both before and after the next
inner loop.</p>
<p>The vectorized computation of heights that we did in
<code class="docutils literal"><span class="pre">ball_plot.py</span></code> (the chapter <a class="reference internal" href="._pylight002.html#st-ex3"><span>A Python program with vectorization and plotting</span></a>) could alternatively have
been done by traversing the time array (<code class="docutils literal"><span class="pre">t</span></code>) and, for each <code class="docutils literal"><span class="pre">t</span></code>
element, computing the height according to the formula <span class="math">\(y = v_0t -
\frac{1}{2}gt^2\)</span>. However, it is important to know that vectorization goes
much quicker. So when speed is important, vectorization is valuable.</p>
<div class="admonition-use-loops-to-compute-sums admonition">
<p class="first admonition-title">Use loops to compute sums</p>
<p>One important use of loops, is to calculate sums. As a simple example,
assume some variable <span class="math">\(x\)</span> given by the mathematical expression</p>
<div class="math">
\[x = \sum_{i=1}^{N}2\cdot i  ,   \nonumber\]</div>
<p>i.e., summing up the <span class="math">\(N\)</span> first even numbers.
For some given <span class="math">\(N\)</span>, say <span class="math">\(N = 5\)</span>,
<span class="math">\(x\)</span> would typically be computed in a computer program as:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">N</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">+=</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span>
<span class="k">print</span> <span class="n">x</span>
</pre></div>
</div>
<p class="last">Executing this code will print the number 30 to the screen. Note in
particular how the <em>accumulation variable</em> <code class="docutils literal"><span class="pre">x</span></code> is initialized to
zero. The value of <code class="docutils literal"><span class="pre">x</span></code> then gets updated with each iteration of the
loop, and not until the loop is finished will <code class="docutils literal"><span class="pre">x</span></code> have the correct
value. This way of building up the value is very common in
programming, so make sure you understand it by simulating the
code segment above by hand. It is a technique used
with loops in any programming language.</p>
</div>
</div>
<div class="section" id="while-loops">
<span id="sec-while-loops"></span><h2>While loops<a class="headerlink" href="#while-loops" title="Permalink to this headline">¶</a></h2>
<span class="target" id="index-41"></span><span class="target" id="index-42"></span><span class="target" id="index-43"></span><span class="target" id="index-44"></span><p id="index-45">Python also has another standard loop construction, the <em>while loop</em>,
doing iterations with a loop index very much like the <code class="docutils literal"><span class="pre">for</span></code> loop. To
illustrate what such a loop may look like, we consider another
modification of <code class="docutils literal"><span class="pre">ball_plot.py</span></code> in the chapter <a class="reference internal" href="._pylight002.html#st-ex3"><span>A Python program with vectorization and plotting</span></a>. Assume
the ball is thrown with a slightly lower initial velocity, say
<span class="math">\(4.5\hbox{ ms}^{-1}\)</span>, while everything else is kept unchanged. Since
we still look at the first second of the flight, the heights at the
end of the flight become negative. However, this only means that the
ball has fallen below its initial starting position, i.e., the height
where it left the hand, so there is no problem with that. In our array
<code class="docutils literal"><span class="pre">y</span></code> we will then have a series of heights which towards the end of <code class="docutils literal"><span class="pre">y</span></code>
become negative. Let us, in a program named
<a class="reference external" href="https://github.com/hplgit/prog4comp/src/py/ball_time.py">ball_time.py</a>
find the time when heights starts to get negative, i.e., when the
ball crosses <span class="math">\(y=0\)</span>. The program could look like this</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">linspace</span>

<span class="n">v0</span> <span class="o">=</span> <span class="mf">4.5</span>                  <span class="c"># Initial velocity</span>
<span class="n">g</span> <span class="o">=</span> <span class="mf">9.81</span>                  <span class="c"># Acceleration of gravity</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>  <span class="c"># 1000 points in time interval</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">v0</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span>     <span class="c"># Generate all heights</span>

<span class="c"># Find where the ball hits y=0</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c"># Now, y[i-1]&gt;0 and y[i]&lt;0 so let&#39;s take the middle point</span>
<span class="c"># in time as the approximation for when the ball hits h=0</span>
<span class="k">print</span> <span class="s">&quot;y=0 at&quot;</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="c"># We plot the path again just for comparison</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="s">&#39;g--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Height (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>If you type and run this program you should get</p>
<div class="highlight-text"><div class="highlight"><pre>y=0 at 0.917417417417
</pre></div>
</div>
<p>The new thing here is the <code class="docutils literal"><span class="pre">while</span></code> loop only.
The loop (note colon and indentation) will run as long as the boolean
expression <code class="docutils literal"><span class="pre">y[i]</span> <span class="pre">&gt;</span> <span class="pre">0</span></code> evaluates to <code class="docutils literal"><span class="pre">True</span></code>. Note that the programmer
introduced a variable (the loop index) by the name <code class="docutils literal"><span class="pre">i</span></code>, initialized it
(<code class="docutils literal"><span class="pre">i</span> <span class="pre">=</span> <span class="pre">0</span></code>) before the loop, and updated it (<code class="docutils literal"><span class="pre">i</span> <span class="pre">+=</span> <span class="pre">1</span></code>) in the loop. So
for each iteration, <code class="docutils literal"><span class="pre">i</span></code> is <em>explicitly</em> increased by 1, allowing a
check of successive elements in the array <code class="docutils literal"><span class="pre">y</span></code>.</p>
<p>Compared to a <code class="docutils literal"><span class="pre">for</span></code> loop, the programmer does not have to specify the
number of iterations when coding a <code class="docutils literal"><span class="pre">while</span></code> loop. It simply runs until
the boolean expression becomes <code class="docutils literal"><span class="pre">False</span></code>.
However, the loop index is not
increased automatically; it must be done explicitly by the
programmer. Of course, just as in for loops and <code class="docutils literal"><span class="pre">if</span></code> blocks,
there might be (arbitrarily) many code lines in a <code class="docutils literal"><span class="pre">while</span></code>
loop. Any <code class="docutils literal"><span class="pre">for</span></code> loop may also be implemented as a <code class="docutils literal"><span class="pre">while</span></code> loop, but
<code class="docutils literal"><span class="pre">while</span></code> loops are more general so not all of them can be expressed
as a <code class="docutils literal"><span class="pre">for</span></code> loop.</p>
<p>A problem to be aware of, is what is usually referred to as an
<em>infinite loop</em>. In those unintentional (erroneous) cases, the boolean
expression of the <code class="docutils literal"><span class="pre">while</span></code> test never evaluates to <code class="docutils literal"><span class="pre">False</span></code>, and the program can not escape the loop. This is one
of the most frequent errors you will experience as a beginning
programmer.  If you accidentally enter an infinite loop and the
program just hangs forever, press <code class="docutils literal"><span class="pre">Ctrl+c</span></code> to stop the program.</p>
</div>
<div class="section" id="lists-and-tuples-alternatives-to-arrays">
<span id="sec-lists"></span><h2>Lists and tuples - alternatives to arrays<a class="headerlink" href="#lists-and-tuples-alternatives-to-arrays" title="Permalink to this headline">¶</a></h2>
<span class="target" id="index-46"></span><span class="target" id="index-47"></span><span class="target" id="index-48"></span><span class="target" id="index-49"></span><span class="target" id="index-50"></span><p id="index-51">We have seen that a group of numbers may be stored in an array that we
may treat as a whole, or element by element. In Python, there is
another way of organizing data that actually is much used, at least in
non-numerical contexts, and that is a construction called <em>list</em>.</p>
<p>A list is quite similar to an array in many ways, but there are pros
and cons to consider. For example, the number of elements in a list is
allowed to change, whereas arrays have a fixed length that must be
known at the time of memory allocation. Elements in a list can be of
different type, i.e you may mix integers, floats and strings, whereas
elements in an array must be of the same type. In general, lists
provide more flexibility than do arrays. On the other hand, arrays
give faster computations than lists, making arrays the prime choice
unless the flexibility of lists is needed. Arrays also require less
memory use and there is a lot of ready-made code for various
mathematical operations. Vectorization requires arrays to be used.</p>
<p>The <code class="docutils literal"><span class="pre">range()</span></code> function that we used above in our <code class="docutils literal"><span class="pre">for</span></code> loop actually
returns a list. If you for example write <code class="docutils literal"><span class="pre">range(5)</span></code> at the prompt in
<code class="docutils literal"><span class="pre">ipython</span></code>, you get <code class="docutils literal"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4]</span></code> in return, i.e., a list with 5
numbers. In a for loop, the line <code class="docutils literal"><span class="pre">for</span> <span class="pre">i</span> <span class="pre">in</span> <span class="pre">range[5]</span></code> makes <code class="docutils literal"><span class="pre">i</span></code> take on
each of the numbers <span class="math">\(0, 1, 2, 3, 4\)</span> in turn, as we saw above. Writing,
e.g., <code class="docutils literal"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">range(5)</span></code>, gives a list by the name <code class="docutils literal"><span class="pre">x</span></code>, containing those
five numbers. These numbers may now be accessed (e.g., as <code class="docutils literal"><span class="pre">x[2]</span></code>,
which contains the number 2) and used in computations just as we saw
for array elements. As with arrays, indices run from <span class="math">\(0\)</span> to <span class="math">\(n - 1\)</span>,
when <code class="docutils literal"><span class="pre">n</span></code> is the number of elements in a list. You may convert a list
to an array by <code class="docutils literal"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">array(L)</span></code>.</p>
<p>A list may also be created by simply writing, e.g.,</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;hello&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
<p>giving a list where <code class="docutils literal"><span class="pre">x[0]</span></code> contains the string <code class="docutils literal"><span class="pre">hello</span></code>, <code class="docutils literal"><span class="pre">x[1]</span></code>
contains the integer <code class="docutils literal"><span class="pre">4</span></code>, etc. We may add and/or delete elements
anywhere in the list as shown in the following example.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;hello&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">x</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="c"># x then becomes [-2, &#39;hello&#39;, 4, 3.14, 6]</span>
<span class="k">del</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>        <span class="c"># x then becomes [-2, &#39;hello&#39;, 4, 6]</span>
<span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">3.14</span><span class="p">)</span>  <span class="c"># x then becomes [-2, &#39;hello&#39;, 4, 6, 3.14]</span>
</pre></div>
</div>
<p>Note the ways of writing the different operations here. Using
<code class="docutils literal"><span class="pre">append()</span></code> will always increase the list at the end. If you like, you
may create an empty list as <code class="docutils literal"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">[]</span></code> before you enter a loop which
appends element by element. If you need to know the length of the
list, you get the number of elements from <code class="docutils literal"><span class="pre">len(x)</span></code>, which in our case
is 5, after appending <code class="docutils literal"><span class="pre">3.14</span></code> above. This function is handy if you want
to traverse all list elements by index, since <code class="docutils literal"><span class="pre">range(len(x))</span></code> gives
you all legal indices. Note that there are many more operations on
lists possible than shown here.</p>
<p>Previously, we saw how a <code class="docutils literal"><span class="pre">for</span></code> loop may run over array elements. When
we want to do the same with a list in Python, we may do it as this
little example shows,</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;hello&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
    <span class="k">print</span> <span class="s">&#39;x element: &#39;</span><span class="p">,</span> <span class="n">e</span>
<span class="k">print</span> <span class="s">&#39;This was all the elements in the list x&#39;</span>
</pre></div>
</div>
<p>This is how it usually is done in Python, and we see that <code class="docutils literal"><span class="pre">e</span></code> runs
over the elements of <code class="docutils literal"><span class="pre">x</span></code> directly, avoiding the need for indexing. Be
aware, however, that when loops are written like this, you can not
change any element in <code class="docutils literal"><span class="pre">x</span></code> by &#8220;changing&#8221; e. That is, writing <code class="docutils literal"><span class="pre">e</span> <span class="pre">+=</span> <span class="pre">2</span></code>
will not change anything in <code class="docutils literal"><span class="pre">x</span></code>, since <code class="docutils literal"><span class="pre">e</span></code> can only be used to read
(as opposed to overwrite) the list elements.</p>
<p id="index-52">There is a special construct in Python that allows you to run through
all elements of a list, do the same operation on each, and store the
new elements in another list. It is referred to as <em>list
comprehension</em> and may be demonstrated as follows.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">List_1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">List_2</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="o">*</span><span class="mi">10</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">List_1</span><span class="p">]</span>
</pre></div>
</div>
<p>This will produce a new list by the name <code class="docutils literal"><span class="pre">List_2</span></code>, containing the
elements <code class="docutils literal"><span class="pre">10</span></code>, <code class="docutils literal"><span class="pre">20</span></code>, <code class="docutils literal"><span class="pre">30</span></code> and <code class="docutils literal"><span class="pre">40</span></code>, in that order. Notice the
syntax within the brackets for <code class="docutils literal"><span class="pre">List_2</span></code>, <code class="docutils literal"><span class="pre">for</span> <span class="pre">e</span> <span class="pre">in</span> <span class="pre">List_1</span></code> signals
that <code class="docutils literal"><span class="pre">e</span></code> is to successively be each of the list elements in <code class="docutils literal"><span class="pre">List_1</span></code>,
and for each <code class="docutils literal"><span class="pre">e</span></code>, create the next element in <code class="docutils literal"><span class="pre">List_2</span></code> by doing
<code class="docutils literal"><span class="pre">e*10</span></code>. More generally, the syntax may be written as</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">List_2</span> <span class="o">=</span> <span class="p">[</span><span class="n">E</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">List_1</span><span class="p">]</span>
</pre></div>
</div>
<p>where <code class="docutils literal"><span class="pre">E(e)</span></code> means some expression involving <code class="docutils literal"><span class="pre">e</span></code>.</p>
<p>In some cases, it is required to run through 2 (or more) lists at the same time.
Python has a handy function called <code class="docutils literal"><span class="pre">zip</span></code> for this purpose. An example of how to use
<code class="docutils literal"><span class="pre">zip</span></code> is provided in the code <code class="docutils literal"><span class="pre">file_handling.py</span></code> below.</p>
<p>We should also briefly mention about <em>tuples</em>, which are very much like lists,
the main difference being that tuples cannot be changed. To a freshman, it may
seem strange that such &#8220;constant lists&#8221; could ever be preferable over lists.
However, the property of being constant is a good safeguard against unintentional
changes. Also, it is quicker for Python to handle data in a tuple than in a list, which
contributes to faster code. With the data from above, we may create a tuple and
print the content by writing</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;hello&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
    <span class="k">print</span> <span class="s">&#39;x element: &#39;</span><span class="p">,</span> <span class="n">e</span>
<span class="k">print</span> <span class="s">&#39;This was all the elements in the tuple x&#39;</span>
</pre></div>
</div>
<p>Trying <code class="docutils literal"><span class="pre">insert</span></code> or <code class="docutils literal"><span class="pre">append</span></code> for the tuple gives an error message (because it cannot
be changed), stating that the tuple object has no such attribute.</p>
</div>
<div class="section" id="reading-from-and-writing-to-files">
<span id="sec-file-reading-writing"></span><h2>Reading from and writing to files<a class="headerlink" href="#reading-from-and-writing-to-files" title="Permalink to this headline">¶</a></h2>
<p>Input data for a program often come from files and the results of the
computations are often written to file. To illustrate basic file
handling, we consider an example where we read <span class="math">\(x\)</span> and <span class="math">\(y\)</span> coordinates
from two columns in a file, apply a function <span class="math">\(f\)</span> to the <span class="math">\(y\)</span> coordinates,
and write the results to a new two-column data file. The first line of
the input file is a heading that we can just skip:</p>
<div class="highlight-text"><div class="highlight"><pre># x and y coordinates
1.0  3.44
2.0  4.8
3.5  6.61
4.0  5.0
</pre></div>
</div>
<p>The relevant Python lines for reading the numbers and writing out
a similar file are given in the file
<a class="reference external" href="https://github.com/hplgit/prog4comp/src/py/file_handling.py">file_handling.py</a></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">filename</span> <span class="o">=</span> <span class="s">&#39;tmp.dat&#39;</span>
<span class="n">infile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">)</span>  <span class="c"># Open file for reading</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>      <span class="c"># Read first line</span>
<span class="c"># Read x and y coordinates from the file and store in lists</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">infile</span><span class="p">:</span>
    <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>      <span class="c"># Split line into words</span>
    <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">infile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c"># Transform y coordinates</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">log</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="c"># Write out x and y to a two-column file</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s">&#39;tmp_out.dat&#39;</span>
<span class="n">outfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>  <span class="c"># Open file for writing</span>
<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;# x and y coordinates</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%10.5f</span><span class="s"> </span><span class="si">%10.5f</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">))</span>
<span class="n">outfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Such a file with a comment line and numbers in tabular format is very
common so <code class="docutils literal"><span class="pre">numpy</span></code> has functionality to ease reading and writing.
Here is the same example using the <code class="docutils literal"><span class="pre">loadtxt</span></code> and <code class="docutils literal"><span class="pre">savetxt</span></code> functions
in <code class="docutils literal"><span class="pre">numpy</span></code> for tabular data (file
<a class="reference external" href="https://github.com/hplgit/prog4comp/src/py/file_handling_numpy.py">file_handling_numpy.py</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">filename</span> <span class="o">=</span> <span class="s">&#39;tmp.dat&#39;</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">comments</span><span class="o">=</span><span class="s">&#39;#&#39;</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>  <span class="c"># insert transformed y back in array</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s">&#39;tmp_out.dat&#39;</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s">&#39;tmp_out.dat&#39;</span>
<span class="n">outfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>  <span class="c"># open file for writing</span>
<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;# x and y coordinates</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
<span class="n">numpy</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s">&#39;</span><span class="si">%10.5f</span><span class="s">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="exercises-2">
<h2>Exercises  (2)<a class="headerlink" href="#exercises-2" title="Permalink to this headline">¶</a></h2>
<div class="section" id="exercise-11-errors-with-colon-indent-etc">
<span id="nd-exer-errorscolonindent"></span><h3>Exercise 11: Errors with colon, indent, etc.<a class="headerlink" href="#exercise-11-errors-with-colon-indent-etc" title="Permalink to this headline">¶</a></h3>
<p>Write the program <code class="docutils literal"><span class="pre">ball_function.py</span></code> as given in the text and
confirm that the program runs correctly. Then save a copy of the
program and use that program during the following error testing.</p>
<p>You are supposed to introduce errors in the code, one by one. For each
error introduced, save and run the program, and comment how well
Python&#8217;s response corresponds to the actual error. When you are
finished with one error, re-set the program to correct behavior (and
check that it works!) before moving on to the next error.</p>
<p><strong>a)</strong>
Change the first line from <code class="docutils literal"><span class="pre">def</span> <span class="pre">y(t):</span></code> to <code class="docutils literal"><span class="pre">def</span> <span class="pre">y(t)</span></code>, i.e., remove the colon.</p>
<p><strong>Solution.</strong>
Running the program gives a syntax error:</p>
<div class="highlight-text"><div class="highlight"><pre>    def y(t)
            ^
SyntaxError: invalid syntax
</pre></div>
</div>
<p>Python repeats the line where it found a problem and then tells us that
the line has a syntax error. It is up to the programmer to find the error,
although a little &#8220;hat&#8221; is used to show were in the line Python thinks the
problem is. In this case, that &#8220;hat&#8221; is placed underneath where the colon
should have been placed.</p>
<p><strong>b)</strong>
Remove the indent in front of the statement <code class="docutils literal"><span class="pre">v0</span> <span class="pre">=</span> <span class="pre">5</span></code> inside the
function <code class="docutils literal"><span class="pre">y</span></code>, i.e., shift the text four spaces to the left.</p>
<p><strong>Solution.</strong>
Running the program gives an indentation error:</p>
<div class="highlight-text"><div class="highlight"><pre>    v0 = 5
     ^
IndentationError: expected an indented block
</pre></div>
</div>
<p>Python repeats the line where it suspects a missing indentation. In the
error message, Python refers to a &#8220;block&#8221;, meaning that all of <code class="docutils literal"><span class="pre">v0</span> <span class="pre">=</span> <span class="pre">5</span></code>
should be shifted to the right (indented).</p>
<p><strong>c)</strong>
Now let the statement <code class="docutils literal"><span class="pre">v0</span> <span class="pre">=</span> <span class="pre">5</span></code> inside the function <code class="docutils literal"><span class="pre">y</span></code> have an
indent of three spaces (while the remaining two lines of the
function have four).</p>
<p><strong>Solution.</strong>
Running the program gives an indentation error, differing slightly from
the one we just experienced above:</p>
<div class="highlight-text"><div class="highlight"><pre>    g = 9.81
    ^
IndentationError: unexpected indent
</pre></div>
</div>
<p>Python repeats the line where it found an unexpected indentation. The thing
is that the first line (here <code class="docutils literal"><span class="pre">v0</span> <span class="pre">=</span> <span class="pre">5</span></code>) sets the minimum indentation for the
function. If larger indents are to be used for succeeding lines (within the
function), it must be done according to syntax rules (see the text). In the
present case, indenting <code class="docutils literal"><span class="pre">g</span> <span class="pre">=</span> <span class="pre">9.81</span></code> violates the rules. Larger indents would
be relevant, e.g., for the statements within a <code class="docutils literal"><span class="pre">for</span></code> loop.</p>
<p><strong>d)</strong>
Remove the left parenthesis in the first statement <code class="docutils literal"><span class="pre">def</span> <span class="pre">y(t):</span></code></p>
<p><strong>Solution.</strong>
Running the program gives a syntax error:</p>
<div class="highlight-text"><div class="highlight"><pre>    def yt):
          ^
SyntaxError: invalid syntax
</pre></div>
</div>
<p>Python repeats the line where it found the syntax problem and states that
(somewhere in this line) there is a syntax error.</p>
<p><strong>e)</strong>
Change the first line of the function definition from <code class="docutils literal"><span class="pre">def</span> <span class="pre">y(t):</span></code>
to <code class="docutils literal"><span class="pre">def</span> <span class="pre">y():</span></code>, i.e., remove the parameter <code class="docutils literal"><span class="pre">t</span></code>.</p>
<p><strong>Solution.</strong>
Running the program gives a type error:</p>
<div class="highlight-text"><div class="highlight"><pre>    print y(time)

TypeError: y() takes no arguments (1 given)
</pre></div>
</div>
<p>Python repeats the line where it found a syntax problem and tells us that
the function <code class="docutils literal"><span class="pre">y</span></code> is used in the wrong way, since one argument is used when
calling it. To Python, this is the logical way of responding, since Python
assumes our definition of the function was correct. This definition (which
actually is what is wrong!) states that the function takes no parameters.
By comparing with the function definition, it is up to the programmer to
understand whether such an error is in the function definition (as here) or in
the function call.</p>
<p><strong>f)</strong>
Change the first occurrence of the statement <code class="docutils literal"><span class="pre">print</span> <span class="pre">y(time)</span></code> to <code class="docutils literal"><span class="pre">print</span> <span class="pre">y()</span></code>.</p>
<p><strong>Solution.</strong>
Running the program gives a type error:</p>
<div class="highlight-text"><div class="highlight"><pre>    print y()

TypeError: y() takes exactly 1 argument (0 given)
</pre></div>
</div>
<p>Python repeats the line where it found a syntax problem and tells us that
the function <code class="docutils literal"><span class="pre">y</span></code> is used in the wrong way, since no argument is used in
the call. Again, Python discovered a mismatch between function definition and
use of the function. Now, the definition specifies one parameter, whereas the
call uses none.</p>
<p>Filename: <code class="docutils literal"><span class="pre">errors_colon_indent_etc.py</span></code>.</p>
</div>
<div class="section" id="exercise-12-compare-integers-a-and-b">
<span id="nd-exer-compint"></span><h3>Exercise 12: Compare integers a and b<a class="headerlink" href="#exercise-12-compare-integers-a-and-b" title="Permalink to this headline">¶</a></h3>
<p>Explain briefly, in your own words, what the following program
does.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">a</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">&#39;Give an integer a: &#39;</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">&#39;Give an integer b: &#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">:</span>
    <span class="k">print</span> <span class="s">&quot;a is the smallest of the two numbers&quot;</span>
<span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="n">b</span><span class="p">:</span>
    <span class="k">print</span> <span class="s">&quot;a and b are equal&quot;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span> <span class="s">&quot;a is the largest of the two numbers&quot;</span>
</pre></div>
</div>
<p>Proceed by writing the program, and then run it a few times with
different values for <code class="docutils literal"><span class="pre">a</span></code> and <code class="docutils literal"><span class="pre">b</span></code> to confirm that it works as
intended. In particular, choose combinations for <code class="docutils literal"><span class="pre">a</span></code> and <code class="docutils literal"><span class="pre">b</span></code> so that
all three branches of the <code class="docutils literal"><span class="pre">if</span></code> construction get tested.</p>
<p><strong>Solution.</strong>
The program takes two integers as input and checks if the number <code class="docutils literal"><span class="pre">a</span></code> is
smaller than <code class="docutils literal"><span class="pre">b</span></code>, equal to <code class="docutils literal"><span class="pre">b</span></code>, or larger than <code class="docutils literal"><span class="pre">b</span></code>. A message is printed
to the screen in each case.</p>
<p>Filename: <code class="docutils literal"><span class="pre">compare_a_and_b.py</span></code>.</p>
</div>
<div class="section" id="exercise-13-functions-for-circumference-and-area-of-a-circle">
<span id="nd-exer-funccircarea"></span><h3>Exercise 13: Functions for circumference and area of a circle<a class="headerlink" href="#exercise-13-functions-for-circumference-and-area-of-a-circle" title="Permalink to this headline">¶</a></h3>
<p>Write a program that takes a circle radius <code class="docutils literal"><span class="pre">r</span></code> as input from the user
and then computes the circumference <code class="docutils literal"><span class="pre">C</span></code> and area <code class="docutils literal"><span class="pre">A</span></code> of the
circle. Implement the computations of <code class="docutils literal"><span class="pre">C</span></code> and <code class="docutils literal"><span class="pre">A</span></code> as two separate
functions that each takes <code class="docutils literal"><span class="pre">r</span></code> as input parameter. Print <code class="docutils literal"><span class="pre">C</span></code> and <code class="docutils literal"><span class="pre">A</span></code> to
the screen along with an appropriate text. Run the program with <span class="math">\(r =
1\)</span> and confirm that you get the right answer.</p>
<p><strong>Solution.</strong>
The code reads:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">circumference</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">r</span>
<span class="k">def</span> <span class="nf">area</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">pi</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span>

<span class="n">r</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">&#39;Give the radius of a circle: &#39;</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">circumference</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">area</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;Circumference: </span><span class="si">%g</span><span class="s"> , Area: </span><span class="si">%g</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
<p>Running the program, choosing <code class="docutils literal"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">1</span></code>, gives the following dialog:</p>
<div class="highlight-text"><div class="highlight"><pre>Give the radius of a circle: 1
Circumference: 6.28319 , Area: 3.14159
</pre></div>
</div>
<p>Filename: <code class="docutils literal"><span class="pre">functions_circumference_area.py</span></code>.</p>
</div>
<div class="section" id="exercise-14-function-for-area-of-a-rectangle">
<span id="nd-exer-funcarearectangle"></span><h3>Exercise 14: Function for area of a rectangle<a class="headerlink" href="#exercise-14-function-for-area-of-a-rectangle" title="Permalink to this headline">¶</a></h3>
<p>Write a program that computes the area <span class="math">\(A = b c\)</span> of a rectangle. The
values of <span class="math">\(b\)</span> and <span class="math">\(c\)</span> should be user input to the program. Also, write
the area computation as a function that takes <span class="math">\(b\)</span> and <span class="math">\(c\)</span> as input
parameters and returns the computed area. Let the program print the
result to screen along with an appropriate text. Run the program with
<span class="math">\(b = 2\)</span> and <span class="math">\(c = 3\)</span> to confirm correct program behavior.</p>
<p><strong>Solution.</strong>
The code reads:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">area</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">s1</span><span class="o">*</span><span class="n">s2</span>

<span class="n">b</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">&#39;Give the one side of the rectangle: &#39;</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">&#39;Give the other side of the rectangle: &#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;Area: &quot;</span><span class="p">,</span> <span class="n">area</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
<p>Running the program, gives the following dialog:</p>
<div class="highlight-text"><div class="highlight"><pre>Give the one side of the rectangle: 2
Give the other side of the rectangle: 3
Area: 6
</pre></div>
</div>
<p>Filename: <code class="docutils literal"><span class="pre">function_area_rectangle.py</span></code>.</p>
</div>
<div class="section" id="exercise-15-area-of-a-polygon">
<span id="nd-exer-area-polygon"></span><h3>Exercise 15: Area of a polygon<a class="headerlink" href="#exercise-15-area-of-a-polygon" title="Permalink to this headline">¶</a></h3>
<p>One of the most important mathematical problems through all times has been
to find the area of a polygon, especially because real estate areas often
had the shape of polygons, and it was necessary to pay tax for the area.
We have a polygon as depicted below.</p>
<div class="figure">
<a class="reference internal image-reference" href="_images/polygon.png"><img alt="_images/polygon.png" src="_images/polygon.png" style="width: 500px;" /></a>
</div>
<p>The vertices (&#8220;corners&#8221;)
of the polygon have coordinates <span class="math">\((x_1,y_1)\)</span>, <span class="math">\((x_2,y_2)\)</span>,
<span class="math">\(\ldots\)</span>, <span class="math">\((x_n, y_n)\)</span>, numbered either in a clockwise or
counter clockwise fashion.
The area <span class="math">\(A\)</span> of the polygon can amazingly be computed by just knowing the
boundary coordinates:</p>
<div class="math">
\[A = \frac{1}{2}\left| (x_1y_2+x_2y_3 + \cdots + x_{n-1}y_n + x_ny_1)
- (y_1x_2 + y_2x_3 + \cdots + y_{n-1}x_n + y_nx_1)\right|\thinspace .\]</div>
<p>Write a function <code class="docutils literal"><span class="pre">polyarea(x,</span> <span class="pre">y)</span></code> that takes two coordinate arrays
with the vertices as arguments and returns the area.
Assume that <code class="docutils literal"><span class="pre">x</span></code> and <code class="docutils literal"><span class="pre">y</span></code> are either lists or arrays.</p>
<p>Test the function on a triangle, a quadrilateral, and a pentagon where
you can calculate the area by alternative methods for comparison.</p>
<p><strong>Hint.</strong>
Since Python lists and arrays has 0 as their first index, it is wise to
rewrite the mathematical formula in terms of vertex coordinates numbered
as <span class="math">\(x_0,x_1,\ldots,x_{n-1}\)</span> and <span class="math">\(y_0, y_1,\ldots,y_{n-1}\)</span>.</p>
<p><strong>Solution.</strong>
Code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Computes the area of a polygon from vertex</span>
<span class="sd">coordinates only.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="k">def</span> <span class="nf">polyarea</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="c"># next we may initialize area with those terms in the</span>
    <span class="c"># sum that does not follow the &quot;increasing index pattern&quot;</span>
    <span class="n">area</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">area</span> <span class="o">+=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="mf">0.5</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">area</span><span class="p">)</span>
</pre></div>
</div>
<p>The function can be tested, e.g., by the lines</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># pentagon</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="k">print</span> <span class="s">&#39;Area pentagon (true value = 5): &#39;</span><span class="p">,</span> <span class="n">polyarea</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="c"># quadrilateral</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="k">print</span> <span class="s">&#39;Area quadrilateral (true value = 4): &#39;</span><span class="p">,</span> <span class="n">polyarea</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="c"># triangle</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="k">print</span> <span class="s">&#39;Area triangle (true value = 2): &#39;</span><span class="p">,</span> <span class="n">polyarea</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>which may be added after the function definition.</p>
<p>Filename: <code class="docutils literal"><span class="pre">polyarea.py</span></code>.</p>
</div>
<div class="section" id="exercise-16-average-of-integers">
<span id="nd-exer-avnint"></span><h3>Exercise 16: Average of integers<a class="headerlink" href="#exercise-16-average-of-integers" title="Permalink to this headline">¶</a></h3>
<p>Write a program that gets an integer <span class="math">\(N &gt; 1\)</span> from the user and
computes the average of all integers <span class="math">\(i = 1,\ldots,N\)</span>. The
computation should be done in a function that takes <span class="math">\(N\)</span> as input
parameter. Print the result to the screen with an appropriate text. Run
the program with <span class="math">\(N = 5\)</span> and confirm that you get the correct answer.</p>
<p><strong>Solution.</strong>
The code reads:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">average</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="nb">sum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>    <span class="c"># Note: Must use `N+1` to get `N`</span>
        <span class="nb">sum</span> <span class="o">+=</span> <span class="n">i</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="n">N</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">&#39;Give an integer &gt; 1: &#39;</span><span class="p">)</span>
<span class="n">average_1_to_N</span> <span class="o">=</span> <span class="n">average</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;The average of 1,..., </span><span class="si">%d</span><span class="s"> is: </span><span class="si">%g</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">average_1_to_N</span><span class="p">)</span>
</pre></div>
</div>
<p>Running the program, using <code class="docutils literal"><span class="pre">N</span> <span class="pre">=</span> <span class="pre">5</span></code>, gives the following dialog:</p>
<div class="highlight-text"><div class="highlight"><pre>Give an integer &gt; 1: 5
The average of 1,..., 5 is: 3
</pre></div>
</div>
<p>Filename: <code class="docutils literal"><span class="pre">average_1_to_N.py</span></code>.</p>
</div>
<div class="section" id="exercise-17-while-loop-with-errors">
<span id="nd-exer-whilelooperrors"></span><h3>Exercise 17: While loop with errors<a class="headerlink" href="#exercise-17-while-loop-with-errors" title="Permalink to this headline">¶</a></h3>
<p>Assume some program has been written for the task of adding all
integers <span class="math">\(i = 1,2,\ldots,10\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">some_number</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">11</span>
    <span class="n">some_number</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="k">print</span> <span class="n">some_number</span>
</pre></div>
</div>
<p><strong>a)</strong>
Identify the errors in the program by just reading the code and
simulating the program by hand.</p>
<p><strong>Solution.</strong>
There is a missing colon at the end of the while loop header.
Within the loop, <code class="docutils literal"><span class="pre">some_number</span></code> is updated by adding 1 instead of <code class="docutils literal"><span class="pre">i</span></code>.
Finally, there is no update of the loop index <code class="docutils literal"><span class="pre">i</span></code>.</p>
<p><strong>b)</strong>
Write a new version of the program with errors corrected.
Run this program and confirm that it gives the correct output.</p>
<p><strong>Solution.</strong>
The code reads:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">some_number</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">11</span><span class="p">:</span>
    <span class="n">some_number</span> <span class="o">+=</span> <span class="n">i</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="k">print</span> <span class="n">some_number</span>
</pre></div>
</div>
<p>Running the program gives 55 as the answer.</p>
<p>Filename: <code class="docutils literal"><span class="pre">while_loop_errors.py</span></code>.</p>
</div>
<div class="section" id="exercise-18-area-of-rectangle-versus-circle">
<span id="nd-exer-arearectcircle"></span><h3>Exercise 18: Area of rectangle versus circle<a class="headerlink" href="#exercise-18-area-of-rectangle-versus-circle" title="Permalink to this headline">¶</a></h3>
<p>Consider one circle and one rectangle. The circle has a radius <span class="math">\(r =
10.6\)</span>. The rectangle has sides <span class="math">\(a\)</span> and <span class="math">\(b\)</span>, but only <span class="math">\(a\)</span> is known from
the outset. Let <span class="math">\(a = 1.3\)</span> and write a program that uses a <code class="docutils literal"><span class="pre">while</span></code> loop
to find the largest possible integer <span class="math">\(b\)</span> that gives a rectangle area
smaller than, but as close as possible to, the area of the circle. Run
the program and confirm that it gives the right answer (which is <span class="math">\(b =
271\)</span>).</p>
<p><strong>Solution.</strong>
The code reads:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">r</span> <span class="o">=</span> <span class="mf">10.6</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">1.3</span>    <span class="c"># one side of rectangle</span>
<span class="n">circle_area</span> <span class="o">=</span> <span class="n">pi</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span>

<span class="n">b</span> <span class="o">=</span> <span class="mi">0</span>      <span class="c"># chosen starting value for other side of rectangle</span>
<span class="k">while</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span> <span class="o">&lt;</span> <span class="n">circle_area</span><span class="p">:</span>
    <span class="n">b</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="n">b</span> <span class="o">-=</span> <span class="mi">1</span>     <span class="c"># must reverse the last update to get the right value</span>
<span class="k">print</span> <span class="s">&quot;The largest possible value of b: &quot;</span><span class="p">,</span> <span class="n">b</span>
</pre></div>
</div>
<p>Running the program gives 271 as output for b.</p>
<p>Filename: <code class="docutils literal"><span class="pre">area_rectangle_vs_circle.py</span></code>.</p>
</div>
<div class="section" id="exercise-19-find-crossing-points-of-two-graphs">
<span id="nd-exer-cross2graphs"></span><h3>Exercise 19: Find crossing points of two graphs<a class="headerlink" href="#exercise-19-find-crossing-points-of-two-graphs" title="Permalink to this headline">¶</a></h3>
<p>Consider two functions <span class="math">\(f(x) = x\)</span> and <span class="math">\(g(x) = x^2\)</span> on the interval <span class="math">\([-4,4]\)</span>.</p>
<p>Write a program that, by trial and error, finds approximately for
which values of <span class="math">\(x\)</span> the two graphs cross, i.e., <span class="math">\(f(x) = g(x)\)</span>. Do this
by considering <span class="math">\(N\)</span> equally distributed points on the interval, at each
point checking whether <span class="math">\(|f(x) - g(x)| &lt; \epsilon\)</span>, where <span class="math">\(\epsilon\)</span> is some
small number. Let <span class="math">\(N\)</span> and <span class="math">\(\epsilon\)</span> be user input to the program and let
the result be printed to screen. Run your program with <span class="math">\(N = 400\)</span> and
<span class="math">\(\epsilon = 0.01\)</span>. Explain the output from the program. Finally, try also
other values of <span class="math">\(N\)</span>, keeping the value of <span class="math">\(\epsilon\)</span> fixed.
Explain your observations.</p>
<p><strong>Solution.</strong>
The code reads:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>

<span class="n">N</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">&#39;Give the number of check points N: &#39;</span><span class="p">)</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">&#39;Give the error tolerance: &#39;</span><span class="p">)</span>
<span class="n">x_values</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>

<span class="c"># Next, we run over all indices in the array `x_values` and</span>
<span class="c"># check if the difference between function values is smaller than</span>
<span class="c"># the chosen limit</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x_values</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="n">g</span><span class="p">(</span><span class="n">x_values</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">x_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
<p>Running the program with 400 check-points (i.e. <code class="docutils literal"><span class="pre">N</span> <span class="pre">=</span> <span class="pre">400</span></code>) and
an error tolerance of 0.01 (i.e. <code class="docutils literal"><span class="pre">epsilon</span> <span class="pre">=</span> <span class="pre">0.01</span></code>) gives the following dialog:</p>
<div class="highlight-text"><div class="highlight"><pre>Give the number of check-points N: 400

Give the error tolerance: 0.01
0.0100250626566
0.992481203008
</pre></div>
</div>
<p>We note that we do not get exactly 0 and 1 (which we know are the answers). This
owes to the chosen distribution of <span class="math">\(x\)</span>-values. This distribution is decided by <code class="docutils literal"><span class="pre">N</span></code>.
Trying other combinations of <code class="docutils literal"><span class="pre">N</span></code> and <code class="docutils literal"><span class="pre">epsilon</span></code> might give more than 2 &#8220;solutions&#8221;,
or fewer, maybe even none. All of this boils down to whether the <code class="docutils literal"><span class="pre">if</span></code> test becomes
true or not. For example, if you let <code class="docutils literal"><span class="pre">epsilon</span></code> stay constant while increasing <code class="docutils literal"><span class="pre">N</span></code>,
you realize that the difference between <span class="math">\(f(x)\)</span> and <span class="math">\(g(x)\)</span> will be small for several
values of <span class="math">\(x\)</span>, allowing more than one <span class="math">\(x\)</span> value to &#8220;be a solution&#8221;. Decreasing <code class="docutils literal"><span class="pre">N</span></code> while
<code class="docutils literal"><span class="pre">epsilon</span></code> is constant will eventually give no solutions, since the difference between
<span class="math">\(f(x)\)</span> and <span class="math">\(g(x)\)</span> at the tested <span class="math">\(x\)</span>-values gets too large.</p>
<p>Is is important here to realize the difference between the numerical test we do and the
exact solution. The numerical test just gives us an approximation which we may get as
&#8220;good as we want&#8221; by the right choices of <code class="docutils literal"><span class="pre">N</span></code> and <code class="docutils literal"><span class="pre">epsilon</span></code>.</p>
<p>Filename: <code class="docutils literal"><span class="pre">crossing_2_graphs.py</span></code>.</p>
</div>
<div class="section" id="exercise-20-sort-array-with-numbers">
<span id="nd-exer-sortnumbers"></span><h3>Exercise 20: Sort array with numbers<a class="headerlink" href="#exercise-20-sort-array-with-numbers" title="Permalink to this headline">¶</a></h3>
<p id="index-53">The import statement <code class="docutils literal"><span class="pre">from</span> <span class="pre">random</span> <span class="pre">import</span> <span class="pre">*</span></code> will give access to a
function <code class="docutils literal"><span class="pre">uniform</span></code> that may be used to draw (pseudo-)random numbers
from a uniform distribution between two numbers <span class="math">\(a\)</span> (inclusive) and
<span class="math">\(b\)</span> (inclusive). For example, writing <code class="docutils literal"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">uniform(0,10)</span></code> makes <code class="docutils literal"><span class="pre">x</span></code> a
float value larger than, or equal to, <span class="math">\(0\)</span>, and smaller than, or equal
to, <span class="math">\(10\)</span>.</p>
<p>Write a script that generates an array of <span class="math">\(6\)</span> random numbers between
<span class="math">\(0\)</span> and <span class="math">\(10\)</span>. The program should then sort the array so that numbers
appear in increasing order. Let the program make a formatted print of
the array to the screen both before and after sorting. The printouts
should appear on the screen so that comparison is made easy. Confirm
that the array has been sorted correctly.</p>
<p><strong>Solution.</strong>
The code may be written as follows</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">zeros</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">uniform</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">numbers</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="c"># Draw random numbers</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">numbers</span><span class="p">)):</span>
    <span class="n">numbers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;Unsorted: </span><span class="si">%5.3f</span><span class="s">  </span><span class="si">%5.3f</span><span class="s"> </span><span class="si">%5.3f</span><span class="s"> </span><span class="si">%5.3f</span><span class="s">  </span><span class="si">%5.3f</span><span class="s"> </span><span class="si">%5.3f</span><span class="s">&quot;</span> <span class="o">%</span> \
        <span class="p">(</span><span class="n">numbers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">numbers</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">numbers</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>\
         <span class="n">numbers</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">numbers</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">numbers</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>

<span class="k">for</span> <span class="n">reference</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">smallest</span> <span class="o">=</span> <span class="n">numbers</span><span class="p">[</span><span class="n">reference</span><span class="p">]</span>
    <span class="n">i_smallest</span> <span class="o">=</span> <span class="n">reference</span>
    <span class="c"># Find the smallest number in remaining unprinted array</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">reference</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">numbers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">smallest</span><span class="p">:</span>
            <span class="n">smallest</span> <span class="o">=</span> <span class="n">numbers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">i_smallest</span> <span class="o">=</span> <span class="n">i</span>
    <span class="c"># Switch numbers, and use an extra variable for that</span>
    <span class="n">switch</span> <span class="o">=</span> <span class="n">numbers</span><span class="p">[</span><span class="n">reference</span><span class="p">]</span>
    <span class="n">numbers</span><span class="p">[</span><span class="n">reference</span><span class="p">]</span> <span class="o">=</span> <span class="n">numbers</span><span class="p">[</span><span class="n">i_smallest</span><span class="p">]</span>
    <span class="n">numbers</span><span class="p">[</span><span class="n">i_smallest</span><span class="p">]</span> <span class="o">=</span> <span class="n">switch</span>

<span class="k">print</span> <span class="s">&quot;Sorted  : </span><span class="si">%5.3f</span><span class="s">  </span><span class="si">%5.3f</span><span class="s"> </span><span class="si">%5.3f</span><span class="s"> </span><span class="si">%5.3f</span><span class="s">  </span><span class="si">%5.3f</span><span class="s"> </span><span class="si">%5.3f</span><span class="s">&quot;</span> <span class="o">%</span> \
        <span class="p">(</span><span class="n">numbers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">numbers</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">numbers</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>\
         <span class="n">numbers</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">numbers</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">numbers</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
<p>Filename: <code class="docutils literal"><span class="pre">sort_numbers.py</span></code>.</p>
</div>
<div class="section" id="exercise-21-compute">
<span id="nd-exer-computingpi"></span><h3>Exercise 21: Compute <span class="math">\(\pi\)</span><a class="headerlink" href="#exercise-21-compute" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-54"></span><p id="index-55">Up through history, great minds have developed different computational
schemes for the number <span class="math">\(\pi\)</span>. We will here consider two such schemes,
one by Leibniz (<span class="math">\(1646-1716\)</span>), and one by Euler (<span class="math">\(1707-1783\)</span>).</p>
<p>The scheme by Leibniz may be written</p>
<div class="math">
\[\pi = 8\sum_{k=0}^{\infty}\frac{1}{(4k + 1)(4k + 3)} , \nonumber\]</div>
<p>while one form of the Euler scheme may appear as</p>
<div class="math">
\[\pi = \sqrt[]{6\sum_{k=1}^{\infty}\frac{1}{k^2}} . \nonumber\]</div>
<p>If only the first <span class="math">\(N\)</span> terms of each sum are used as an approximation to
<span class="math">\(\pi\)</span>, each modified scheme will have computed <span class="math">\(\pi\)</span> with some error.</p>
<p>Write a program that takes <span class="math">\(N\)</span> as input from the user, and plots the
error development with both schemes as the number of iterations
approaches <span class="math">\(N\)</span>. Your program should also print out the final error
achieved with both schemes, i.e. when the number of terms is <code class="docutils literal"><span class="pre">N</span></code>.
Run the program with <span class="math">\(N = 100\)</span> and explain briefly what the graphs show.</p>
<p><strong>Solution.</strong>
The code may be written as follows</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">pi</span><span class="p">,</span> <span class="n">zeros</span><span class="p">,</span> <span class="n">sqrt</span>

<span class="n">no_of_terms</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">&#39;Give number of terms in sum for pi: &#39;</span><span class="p">)</span>
<span class="n">Leibniz_error</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">no_of_terms</span><span class="p">)</span>
<span class="n">Euler_error</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">no_of_terms</span><span class="p">)</span>

<span class="c">#Leibniz</span>
<span class="n">sum1</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">no_of_terms</span><span class="p">):</span>
    <span class="n">sum1</span> <span class="o">+=</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">((</span><span class="mi">4</span><span class="o">*</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">k</span> <span class="o">+</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">Leibniz_error</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">pi</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="n">sum1</span>
<span class="n">sum1</span> <span class="o">*=</span> <span class="mi">8</span>
<span class="n">final_Leibniz_error</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">pi</span> <span class="o">-</span> <span class="n">sum1</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;Leibniz: &quot;</span><span class="p">,</span> <span class="n">final_Leibniz_error</span>

<span class="c"># Euler</span>
<span class="n">sum2</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">no_of_terms</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>  <span class="c"># Note index range</span>
    <span class="n">sum2</span> <span class="o">+=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">k</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">Euler_error</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pi</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">sum2</span><span class="p">)</span>
<span class="n">sum2</span> <span class="o">*=</span> <span class="mi">6</span>
<span class="n">sum2</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">sum2</span><span class="p">)</span>
<span class="n">final_Euler_error</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">pi</span> <span class="o">-</span> <span class="n">sum2</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;Euler: &quot;</span><span class="p">,</span> <span class="n">final_Euler_error</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">no_of_terms</span><span class="p">),</span> <span class="n">Leibniz_error</span><span class="p">,</span> <span class="s">&#39;b-&#39;</span><span class="p">,</span>\
         <span class="nb">range</span><span class="p">(</span><span class="n">no_of_terms</span><span class="p">),</span> <span class="n">Euler_error</span><span class="p">,</span> <span class="s">&#39;r-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;No of terms&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Error with Leibniz (blue) and Euler (red)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Running the program as told produces the dialog</p>
<div class="highlight-text"><div class="highlight"><pre>Give number of terms in sum for pi: 100
Leibniz: 0.00499996875098
Euler: 0.00951612178069
</pre></div>
</div>
<p>and the plot in Figure <a class="reference internal" href="#fig-pi-comp"><span>Error as a function of number of terms</span></a></p>
<div class="figure" id="id1">
<span id="fig-pi-comp"></span><a class="reference internal image-reference" href="_images/pi_Leibniz_Euler.png"><img alt="_images/pi_Leibniz_Euler.png" src="_images/pi_Leibniz_Euler.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-text"><em>Error as a function of number of terms</em></span></p>
</div>
<p>We see that the scheme of Leibniz gives the least error all over the interval. However,
the difference in the error with the two schemes becomes smaller as the number of terms increases.</p>
<p>Filename: <code class="docutils literal"><span class="pre">compute_pi.py</span></code>.</p>
</div>
<div class="section" id="exercise-22-compute-combinations-of-sets">
<span id="nd-exer-combinatorics1"></span><h3>Exercise 22: Compute combinations of sets<a class="headerlink" href="#exercise-22-compute-combinations-of-sets" title="Permalink to this headline">¶</a></h3>
<p>Consider an ID number consisting of two letters and three digits, e.g.,
RE198. How many different numbers can we have, and how can a program
generate all these combinations?</p>
<p>If a collection of <span class="math">\(n\)</span> things can have <span class="math">\(m_1\)</span> variations of the first thing,
<span class="math">\(m_2\)</span> of the second and so on, the total number of variations of
the collection equals <span class="math">\(m_1m_2\cdots m_n\)</span>. In particular, the ID number
exemplified above can have <span class="math">\(26\cdot 26\cdot 10\cdot 10\cdot 10 =676,000\)</span>
variations. To generate all the combinations, we must have five
nested for loops. The first two run over all letters A, B, and so on to Z,
while the next three run over all digits <span class="math">\(0,1,\ldots,9\)</span>.</p>
<p>To convince yourself about this result, start out with an ID number on the
form A3 where the first part can vary among A, B, and C, and the
digit can be among 1, 2, or 3. We must start with A and combine
it with 1, 2, and 3, then continue with B, combined with 1, 2, and 3,
and finally combine C with 1, 2, and 3. A double for loop does the work.</p>
<p><strong>a)</strong>
In a deck of cards, each card is a combination of a rank and a suit.
There are 13 ranks: ace (A), 2, 3, 4, 5, 6, 7, 8, 9, 10, jack (J),
queen (Q), king (K), and
four suits: clubs (C), diamonds (D), hearts (H), and spades (S).
A typical card may be D3. Write statements that generate a
deck of cards, i.e., all the combinations <code class="docutils literal"><span class="pre">CA</span></code>, <code class="docutils literal"><span class="pre">C2</span></code>, <code class="docutils literal"><span class="pre">C3</span></code>, and so on
to <code class="docutils literal"><span class="pre">SK</span></code>.</p>
<p><strong>Solution.</strong>
Program:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ranks</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;A&#39;</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">,</span> <span class="s">&#39;3&#39;</span><span class="p">,</span> <span class="s">&#39;4&#39;</span><span class="p">,</span> <span class="s">&#39;5&#39;</span><span class="p">,</span> <span class="s">&#39;6&#39;</span><span class="p">,</span> <span class="s">&#39;7&#39;</span><span class="p">,</span>
         <span class="s">&#39;8&#39;</span><span class="p">,</span> <span class="s">&#39;9&#39;</span><span class="p">,</span> <span class="s">&#39;10&#39;</span><span class="p">,</span> <span class="s">&#39;J&#39;</span><span class="p">,</span> <span class="s">&#39;Q&#39;</span><span class="p">,</span> <span class="s">&#39;K&#39;</span><span class="p">]</span>
<span class="n">suits</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="s">&#39;D&#39;</span><span class="p">,</span> <span class="s">&#39;H&#39;</span><span class="p">,</span> <span class="s">&#39;S&#39;</span><span class="p">]</span>
<span class="n">deck</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">suits</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">ranks</span><span class="p">:</span>
        <span class="n">deck</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span> <span class="o">+</span> <span class="n">r</span><span class="p">)</span>
<span class="k">print</span> <span class="n">deck</span>
</pre></div>
</div>
<p><strong>b)</strong>
A vehicle registration number is on the form <code class="docutils literal"><span class="pre">DE562</span></code>, where the letters
vary from A to Z and the digits from 0 to 9. Write statements that compute
all the possible registration numbers and stores them in a list.</p>
<p><strong>Solution.</strong>
Program:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">string</span>
<span class="n">letters</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span>
<span class="n">digits</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">registration_numbers</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">place1</span> <span class="ow">in</span> <span class="n">letters</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">place2</span> <span class="ow">in</span> <span class="n">letters</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">place3</span> <span class="ow">in</span> <span class="n">digits</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">place4</span> <span class="ow">in</span> <span class="n">digits</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">place5</span> <span class="ow">in</span> <span class="n">digits</span><span class="p">:</span>
                    <span class="n">registration_numbers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="s">&#39;</span><span class="si">%s%s%s%s%s</span><span class="s">&#39;</span> <span class="o">%</span>
                        <span class="p">(</span><span class="n">place1</span><span class="p">,</span> <span class="n">place2</span><span class="p">,</span> <span class="n">place3</span><span class="p">,</span> <span class="n">place4</span><span class="p">,</span> <span class="n">place5</span><span class="p">))</span>
<span class="k">print</span> <span class="n">registration_numbers</span>
</pre></div>
</div>
<p><strong>c)</strong>
Generate all the combinations of throwing two dice (the number of eyes
can vary from 1 to 6). Count how many combinations where the sum of
the eyes equals 7.</p>
<p><strong>Answer.</strong>
6</p>
<p><strong>Solution.</strong>
Program:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">dice</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">d1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">d2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">):</span>
        <span class="n">dice</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">))</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">d1</span><span class="p">,</span> <span class="n">d2</span> <span class="ow">in</span> <span class="n">dice</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">d1</span> <span class="o">+</span> <span class="n">d2</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="k">print</span> <span class="s">&#39;</span><span class="si">%d</span><span class="s"> combinations results in the sum 7&#39;</span> <span class="o">%</span> <span class="n">n</span>
</pre></div>
</div>
<p>Filename: <code class="docutils literal"><span class="pre">combine_sets.py</span></code>.</p>
</div>
<div class="section" id="exercise-23-frequency-of-random-numbers">
<span id="nd-exer-numberoccurrence"></span><h3>Exercise 23: Frequency of random numbers<a class="headerlink" href="#exercise-23-frequency-of-random-numbers" title="Permalink to this headline">¶</a></h3>
<p>Write a program that takes a positive integer <span class="math">\(N\)</span> as input and then draws
<span class="math">\(N\)</span> random integers in the interval <span class="math">\([1,6]\)</span> (both ends inclusive). In the program,
count how many of the numbers, <span class="math">\(M\)</span>, that equal 6 and write out
the fraction <span class="math">\(M/N\)</span>. Also, print all the random numbers to the screen so that
you can check for yourself that the counting is correct. Run the program with
a small value for <code class="docutils literal"><span class="pre">N</span></code> (e.g., <code class="docutils literal"><span class="pre">N</span> <span class="pre">=</span> <span class="pre">10</span></code>) to confirm that it works as intended.</p>
<p><strong>Hint.</strong>
Use <code class="docutils literal"><span class="pre">random.randint(1,6)</span></code> to draw
a random integer between 1 and 6.</p>
<p><strong>Solution.</strong>
The code may be written as follows</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randint</span>

<span class="n">N</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">&#39;How many random numbers should be drawn? &#39;</span><span class="p">)</span>

<span class="c"># Draw random numbers</span>
<span class="n">M</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c"># Counter for the occurences of 6</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">drawn_number</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
    <span class="k">print</span> <span class="s">&#39;Draw number </span><span class="si">%d</span><span class="s"> gave: </span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">drawn_number</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">drawn_number</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
        <span class="n">M</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="k">print</span> <span class="s">&#39;The fraction M/N became: </span><span class="si">%g</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">M</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
</pre></div>
</div>
<p>Running the program produces the dialog</p>
<div class="highlight-text"><div class="highlight"><pre>How many random numbers should be drawn? 10
Draw number 1 gave: 2
Draw number 2 gave: 4
Draw number 3 gave: 3
Draw number 4 gave: 2
Draw number 5 gave: 2
Draw number 6 gave: 1
Draw number 7 gave: 2
Draw number 8 gave: 6
Draw number 9 gave: 2
Draw number 10 gave: 3
The fraction M/N became: 0.1
</pre></div>
</div>
<p>We see that, in this case, 6 was drawn just a
single time, so one out of ten gives a fraction
<code class="docutils literal"><span class="pre">M/N</span></code> of <span class="math">\(0.1\)</span>.</p>
<p>Filename: <code class="docutils literal"><span class="pre">count_random_numbers.py</span></code>.</p>
<div class="section" id="remarks-1">
<h4>Remarks  (1)<a class="headerlink" href="#remarks-1" title="Permalink to this headline">¶</a></h4>
<p>For large <span class="math">\(N\)</span>, this program computes the probability <span class="math">\(M/N\)</span>
of getting six eyes when throwing a die.</p>
</div>
</div>
<div class="section" id="exercise-24-game-21">
<span id="nd-exer-game21"></span><h3>Exercise 24: Game 21<a class="headerlink" href="#exercise-24-game-21" title="Permalink to this headline">¶</a></h3>
<p id="index-56">Consider some game where each participant draws a series of random
integers evenly distributed from <span class="math">\(0\)</span> and <span class="math">\(10\)</span>, with the aim of getting
the sum as close as possible to <span class="math">\(21\)</span>, but <em>not larger</em> than <span class="math">\(21\)</span>.  You
are out of the game if the sum passes <span class="math">\(21\)</span>.  After each draw, you are
told the number and your total sum, and is asked whether you want
another draw or not. The one coming closest to <span class="math">\(21\)</span> is the winner.</p>
<p>Implement this game in a program.</p>
<p><strong>Hint.</strong>
Use <code class="docutils literal"><span class="pre">random.randint(0,10)</span></code> to draw
random integers in <span class="math">\([0,10]\)</span>.</p>
<p><strong>Solution.</strong>
The code may be written as follows</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randint</span>

<span class="n">upper_limit</span> <span class="o">=</span> <span class="mi">21</span>
<span class="n">not_finished</span> <span class="o">=</span> <span class="bp">True</span>
<span class="nb">sum</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">not_finished</span><span class="p">:</span>
    <span class="n">next_number</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="k">print</span> <span class="s">&quot;You got: &quot;</span><span class="p">,</span> <span class="n">next_number</span>
    <span class="nb">sum</span> <span class="o">+=</span> <span class="n">next_number</span>
    <span class="k">if</span> <span class="nb">sum</span> <span class="o">&gt;</span> <span class="n">upper_limit</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&quot;Game over, you passed 21 (with your </span><span class="si">%d</span><span class="s"> points)!&quot;</span>\
                <span class="o">%</span> <span class="nb">sum</span>
        <span class="n">not_finished</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&quot;Your score is now: </span><span class="si">%d</span><span class="s"> points!&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">sum</span><span class="p">)</span>
        <span class="n">answer</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s">&#39;Another draw (y/n)? &#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">answer</span> <span class="o">!=</span> <span class="s">&#39;y&#39;</span><span class="p">:</span>
            <span class="n">not_finished</span> <span class="o">=</span> <span class="bp">False</span>
<span class="k">print</span> <span class="s">&quot;Finished!&quot;</span>
</pre></div>
</div>
<p>Running the program may produce this dialog</p>
<div class="highlight-text"><div class="highlight"><pre>You got: 8
Your score is now: 8 points!

Another draw (y/n)? y
You got: 6
Your score is now: 14 points!

Another draw (y/n)? y
You got: 8
Game over, you passed 21 (with your 22 points)!
</pre></div>
</div>
<p>Filename: <code class="docutils literal"><span class="pre">game_21.py</span></code>.</p>
</div>
<div class="section" id="exercise-25-linear-interpolation">
<span id="nd-exer-linearinterpol"></span><h3>Exercise 25: Linear interpolation<a class="headerlink" href="#exercise-25-linear-interpolation" title="Permalink to this headline">¶</a></h3>
<p id="index-57">Some measurements <span class="math">\(y_i\)</span>, <span class="math">\(i = 1,2,\ldots,N\)</span> (given below), of a
quantity <span class="math">\(y\)</span> have been collected regularly, once every minute, at
times <span class="math">\(t_i=i\)</span>, <span class="math">\(i=0,1,\ldots,N\)</span>.  We want to find the value <span class="math">\(y\)</span>
<em>in between</em> the measurements, e.g., at <span class="math">\(t=3.2\)</span> min. Computing such
<span class="math">\(y\)</span> values is called <em>interpolation</em>.</p>
<p>Let your program use <em>linear interpolation</em> to compute <span class="math">\(y\)</span>
between two consecutive measurements:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Find <span class="math">\(i\)</span> such that <span class="math">\(t_i\leq t \leq t_{i+1}\)</span>.</li>
<li>Find a mathematical expression for the straight line that goes through the
points <span class="math">\((i,y_i)\)</span> and <span class="math">\((i+1,y_{i+1})\)</span>.</li>
<li>Compute the <span class="math">\(y\)</span> value by inserting the user&#8217;s time value in
the expression for the straight line.</li>
</ol>
</div></blockquote>
<p><strong>a)</strong>
Implement the linear interpolation technique in a function that
takes an array with the <span class="math">\(y_i\)</span> measurements as input, together with
some time <span class="math">\(t\)</span>, and returns the interpolated <span class="math">\(y\)</span> value at time <span class="math">\(t\)</span>.</p>
<p><strong>Solution.</strong>
See the function <code class="docutils literal"><span class="pre">interpolate</span></code> in the script below</p>
<p><strong>b)</strong>
Write another function with in a loop where the user is asked
for a
time on the interval <span class="math">\([0,N]\)</span> and the corresponding (interpolated)
<span class="math">\(y\)</span> value is written to the screen.
The loop is terminated when the user gives a negative time.</p>
<p><strong>Solution.</strong>
See the function <code class="docutils literal"><span class="pre">find_y</span></code> in the script below</p>
<p><strong>c)</strong>
Use the following measurements: <span class="math">\(4.4, 2.0, 11.0, 21.5, 7.5\)</span>, corresponding
to times <span class="math">\(0,1,\ldots,4\)</span> (min), and compute interpolated values at
<span class="math">\(t=2.5\)</span> and <span class="math">\(t=3.1\)</span> min.
Perform separate hand calculations to check that the output from the
program is correct.</p>
<p><strong>Solution.</strong>
The code may be written as follows</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">zeros</span>

<span class="k">def</span> <span class="nf">interpolate</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Uses linear interpolation to find intermediate y&quot;&quot;&quot;</span>
    <span class="n">i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="c"># Scheme: y(t) = y_i + delta-y/delta-t * dt</span>
    <span class="k">return</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">((</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">delta_t</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">i</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">find_y</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Repeatedly finds y at t by interpolation&quot;&quot;&quot;</span>
    <span class="k">print</span> <span class="s">&#39;For time t on the interval [0,</span><span class="si">%d</span><span class="s">]...&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">&#39;Give your desired t &gt; 0: &#39;</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">t</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&#39;y(t) = </span><span class="si">%g</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">interpolate</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>
        <span class="n">t</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">&#39;Give new time t (to stop, enter t &lt; 0): &#39;</span><span class="p">)</span>

<span class="c"># Note: do not need to store the sequence of times</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">4</span>            <span class="c"># Total number of measurements</span>
<span class="n">delta_t</span> <span class="o">=</span> <span class="mf">1.0</span>    <span class="c"># Time difference between measurements</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.4</span><span class="p">;</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">;</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">11.0</span><span class="p">;</span>
<span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mf">21.5</span><span class="p">;</span> <span class="n">y</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mf">7.5</span>

<span class="n">find_y</span><span class="p">()</span>
</pre></div>
</div>
<p>Running the program may produce this dialog</p>
<div class="highlight-text"><div class="highlight"><pre>For time t on the interval [0,4]...
Give your desired t: 2.5
y(t) = 16.25

Give new time t: 0.5
y(t) = 3.2

Give new time t: -1
</pre></div>
</div>
<p>Filename: <code class="docutils literal"><span class="pre">linear_interpolation.py</span></code>.</p>
</div>
<div class="section" id="exercise-26-test-straight-line-requirement">
<span id="nd-exer-teststraightline"></span><h3>Exercise 26: Test straight line requirement<a class="headerlink" href="#exercise-26-test-straight-line-requirement" title="Permalink to this headline">¶</a></h3>
<p>Assume the straight line function <span class="math">\(f(x) = 4x + 1\)</span>. Write a script that
tests the &#8220;point-slope&#8221; form for this line as follows. Within a chosen
interval on the <span class="math">\(x\)</span>-axis (for example, for <span class="math">\(x\)</span> between 0 and 10), randomly
pick <span class="math">\(100\)</span> points on the line and check
if the following requirement is fulfilled for each point:</p>
<div class="math">
\[\frac{f(x_i) - f(c)}{x_i - c} = a,\hspace{.3in}  i = 1,2,\ldots,100\thinspace ,\]</div>
<p>where <span class="math">\(a\)</span> is the slope of the line and <span class="math">\(c\)</span> defines a fixed point <span class="math">\((c,f(c))\)</span>
on the line. Let <span class="math">\(c = 2\)</span> here.</p>
<p><strong>Solution.</strong>
The code may be written as follows</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">For a straight line f(x) = ax + b, and the fixed point (2,f(2)) on</span>
<span class="sd">the line, the script tests whether (f(x_i) - f(2)) / (x_i - 2) = a</span>
<span class="sd">for randomly chosen x_i, i = 1,...,100.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">random</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">b</span>

<span class="n">a</span> <span class="o">=</span> <span class="mf">4.0</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">c</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">f_c</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>  <span class="c"># Fixed point on the line</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-6</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">random</span><span class="p">()</span>   <span class="c"># random() returns number between 0 and 1</span>
    <span class="n">numerator</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">f_c</span>
    <span class="n">denominator</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">c</span>
    <span class="k">if</span> <span class="n">denominator</span> <span class="o">&gt;</span> <span class="n">epsilon</span><span class="p">:</span>   <span class="c"># To avoid zero division</span>
        <span class="n">fraction</span> <span class="o">=</span> <span class="n">numerator</span><span class="o">/</span><span class="n">denominator</span>
        <span class="c"># The following printout should be very close to zero in</span>
        <span class="c"># each case if the points are on the line</span>
        <span class="k">print</span> <span class="s">&#39;For x = </span><span class="si">%g</span><span class="s"> : </span><span class="si">%g</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">fraction</span> <span class="o">-</span> <span class="n">a</span><span class="p">))</span>
</pre></div>
</div>
<p>The potential problem of zero division is here simply handled by the <code class="docutils literal"><span class="pre">if</span></code> test, meaning
that if the denominator is too close to zero, that particular <span class="math">\(x\)</span> is skipped.
A more elegant procedure would be to use a <code class="docutils literal"><span class="pre">try-except</span></code> construction.</p>
<p>Running the program generates a printout of <span class="math">\(100\)</span> lines that for each <span class="math">\(x\)</span> drawn
gives 0 as result from the test. The two last lines of the printout read:</p>
<div class="highlight-text"><div class="highlight"><pre>For x = 2.67588 : 0
For x = 9.75893 : 0
</pre></div>
</div>
<p>Note that since the <span class="math">\(x\)</span> values are (pseudo-)random in nature, a second run gives
different values for <span class="math">\(x\)</span> (but still 0 for each test!).</p>
<p>Filename: <code class="docutils literal"><span class="pre">test_straight_line.py</span></code>.</p>
</div>
<div class="section" id="exercise-27-fit-straight-line-to-data">
<span id="nd-exer-fitline"></span><h3>Exercise 27: Fit straight line to data<a class="headerlink" href="#exercise-27-fit-straight-line-to-data" title="Permalink to this headline">¶</a></h3>
<p id="index-58">Assume some measurements <span class="math">\(y_i, i = 1,2,\ldots,5\)</span> have been collected,
once every second. Your task is to write a program that
fits a straight line to those data.</p>
<p><strong>Hint.</strong>
To make your program work, you may have to insert
<code class="docutils literal"><span class="pre">from</span> <span class="pre">matplotlib.pylab</span> <span class="pre">import</span> <span class="pre">*</span></code> at the top and also add
<code class="docutils literal"><span class="pre">show()</span></code> after the plot command in the loop.</p>
<p><strong>a)</strong>
Make a function that computes the error between the straight line
<span class="math">\(f(x)=ax+b\)</span> and the measurements:</p>
<div class="math">
\[e = \sum_{i=1}^{5} \left(ax_i+b - y_i\right)^2\thinspace .\]</div>
<p><strong>Solution.</strong>
See the function <code class="docutils literal"><span class="pre">find_error</span></code> in the script below.</p>
<p><strong>b)</strong>
Make a function with a loop where you give <span class="math">\(a\)</span> and <span class="math">\(b\)</span>, the
corresponding value of <span class="math">\(e\)</span> is written to the screen, and
a plot of the straight line <span class="math">\(f(x)=ax+b\)</span> together with the
discrete measurements is shown.</p>
<p><strong>Hint.</strong>
To make the plotting from the loop to work, you may have to insert
<code class="docutils literal"><span class="pre">from</span> <span class="pre">matplotlib.pylab</span> <span class="pre">import</span> <span class="pre">*</span></code> at the top of the script and also add
<code class="docutils literal"><span class="pre">show()</span></code> after the plot command in the loop.</p>
<p><strong>Solution.</strong>
See the function <code class="docutils literal"><span class="pre">interactive_line_fit</span></code> in the script below.</p>
<p><strong>c)</strong>
Given the measurements <span class="math">\(0.5, 2.0, 1.0, 1.5, 7.5\)</span>, at times
<span class="math">\(0, 1, 2, 3, 4\)</span>, use the function in b) to interactively search
for <span class="math">\(a\)</span> and <span class="math">\(b\)</span> such that <span class="math">\(e\)</span> is minimized.</p>
<p><strong>Solution.</strong>
The code may be written as follows</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">array</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">b</span>

<span class="k">def</span> <span class="nf">find_error</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)):</span>
        <span class="n">E</span> <span class="o">+=</span> <span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">E</span>

<span class="k">def</span> <span class="nf">interactive_line_fit</span><span class="p">():</span>
    <span class="n">one_more</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">while</span> <span class="n">one_more</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">&#39;Give a: &#39;</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">&#39;Give b: &#39;</span><span class="p">)</span>
        <span class="k">print</span> <span class="s">&#39;The error is: </span><span class="si">%g</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">find_error</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="s">&#39;*&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Time (s)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;y (stars) and straight line f(t)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="n">answer</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s">&#39;Do you want another fit (y/n)? &#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">answer</span> <span class="o">==</span> <span class="s">&quot;n&quot;</span><span class="p">:</span>
            <span class="n">one_more</span> <span class="o">=</span> <span class="bp">False</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">])</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>

<span class="n">interactive_line_fit</span><span class="p">()</span>
</pre></div>
</div>
<p>Running the program may produce this dialog</p>
<div class="highlight-text"><div class="highlight"><pre>Give a: 1
Give b: 0
The error is: 16.75
</pre></div>
</div>
<p>(followed by the plot seen in Figure <a class="reference internal" href="#fig-fit-line-1"><span>Straight line fitted to data with first choice of line parameters (a and b)</span></a>)</p>
<div class="figure" id="id2">
<span id="fig-fit-line-1"></span><a class="reference internal image-reference" href="_images/fit_straight_line_1.png"><img alt="_images/fit_straight_line_1.png" src="_images/fit_straight_line_1.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-text"><em>Straight line fitted to data with first choice of line parameters (a and b)</em></span></p>
</div>
<div class="highlight-text"><div class="highlight"><pre>Do you want another fit (y/n)? y
Give a: 0.5
Give b: 1
The error is: 22.75
</pre></div>
</div>
<p>(followed by the plot seen in Figure <a class="reference internal" href="#fig-fit-line-2"><span>Straight line fitted to data with second choice of line parameters (a and b)</span></a>)</p>
<div class="figure" id="id3">
<span id="fig-fit-line-2"></span><a class="reference internal image-reference" href="_images/fit_straight_line_2.png"><img alt="_images/fit_straight_line_2.png" src="_images/fit_straight_line_2.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-text"><em>Straight line fitted to data with second choice of line parameters (a and b)</em></span></p>
</div>
<div class="highlight-text"><div class="highlight"><pre>Do you want another fit (y/n)? n
</pre></div>
</div>
<p>Filename: <code class="docutils literal"><span class="pre">fit_straight_line.py</span></code>.</p>
<div class="section" id="remarks-2">
<h4>Remarks  (2)<a class="headerlink" href="#remarks-2" title="Permalink to this headline">¶</a></h4>
<p>Fitting a straight line to measured data points is a very common
task. The manual search procedure in c) can be automated by using a
mathematical method called the <em>method of least squares</em>.</p>
</div>
</div>
<div class="section" id="exercise-28-fit-sines-to-straight-line">
<span id="nd-exer-fitsines"></span><h3>Exercise 28: Fit sines to straight line<a class="headerlink" href="#exercise-28-fit-sines-to-straight-line" title="Permalink to this headline">¶</a></h3>
<p id="index-59">A lot of technology, especially most types of digital audio devices
for processing sound, is based on representing a signal of time
as a sum of sine functions. Say the signal is some function <span class="math">\(f(t)\)</span>
on the interval <span class="math">\([-\pi,\pi]\)</span> (a more general interval <span class="math">\([a,b]\)</span>
can easily be treated, but leads to slightly more complicated
formulas). Instead of working with <span class="math">\(f(t)\)</span> directly,
we approximate <span class="math">\(f\)</span> by the sum</p>
<div class="math">
\[S_N(t) = \sum_{n=1}^{N} b_n \sin(nt),\]</div>
<p>where the coefficients <span class="math">\(b_n\)</span> must be adjusted such that <span class="math">\(S_N(t)\)</span> is
a good approximation to <span class="math">\(f(t)\)</span>. We shall in this exercise adjust
<span class="math">\(b_n\)</span> by a trial-and-error process.</p>
<p><strong>a)</strong>
Make a function <code class="docutils literal"><span class="pre">sinesum(t,</span> <span class="pre">b)</span></code> that returns <span class="math">\(S_N(t)\)</span>, given the
coefficients <span class="math">\(b_n\)</span> in an array <code class="docutils literal"><span class="pre">b</span></code> and time coordinates in an
array <code class="docutils literal"><span class="pre">t</span></code>. Note that if <code class="docutils literal"><span class="pre">t</span></code> is an array, the return value is also
an array.</p>
<p><strong>Solution.</strong>
See the script below.</p>
<p><strong>b)</strong>
Write a function <code class="docutils literal"><span class="pre">test_sinesum()</span></code> that calls <code class="docutils literal"><span class="pre">sinesum(t,</span> <span class="pre">b)</span></code> in a)
and determines if the function computes a test case correctly.
As test case, let <code class="docutils literal"><span class="pre">t</span></code> be an array with values <span class="math">\(-\pi/2\)</span> and <span class="math">\(\pi/4\)</span>,
choose <span class="math">\(N=2\)</span>, and <span class="math">\(b_1=4\)</span> and <span class="math">\(b_2=-3\)</span>. Compute <span class="math">\(S_N(t)\)</span> by hand
to get reference values.</p>
<p><strong>Solution.</strong>
See the script below. Note that the call to <code class="docutils literal"><span class="pre">test_sinesum</span></code> is
commented out, but the function will step into action if the
leading <code class="docutils literal"><span class="pre">#</span></code> is removed.</p>
<p><strong>c)</strong>
Make a function <code class="docutils literal"><span class="pre">plot_compare(f,</span> <span class="pre">N,</span> <span class="pre">M)</span></code> that plots the original
function <span class="math">\(f(t)\)</span> together with the sum of sines <span class="math">\(S_N(t)\)</span>, so that
the quality of the approximation <span class="math">\(S_N(t)\)</span> can be examined visually.
The argument <code class="docutils literal"><span class="pre">f</span></code> is a Python function implementing <span class="math">\(f(t)\)</span>, <code class="docutils literal"><span class="pre">N</span></code>
is the number of terms in the sum <span class="math">\(S_N(t)\)</span>, and <code class="docutils literal"><span class="pre">M</span></code> is the number
of uniformly distributed <span class="math">\(t\)</span> coordinates used to plot <span class="math">\(f\)</span> and <span class="math">\(S_N\)</span>.</p>
<p><strong>Solution.</strong>
See the script below.</p>
<p><strong>d)</strong>
Write a function <code class="docutils literal"><span class="pre">error(b,</span> <span class="pre">f,</span> <span class="pre">M)</span></code> that returns a mathematical measure
of the error in <span class="math">\(S_N(t)\)</span> as an approximation to <span class="math">\(f(t)\)</span>:</p>
<div class="math">
\[E = \sqrt{\sum_{i} \left(f(t_i) - S_N(t_i)\right)^2},\]</div>
<p>where the <span class="math">\(t_i\)</span> values are <span class="math">\(M\)</span> uniformly distributed coordinates on
<span class="math">\([-\pi, \pi]\)</span>.
The array <code class="docutils literal"><span class="pre">b</span></code> holds the coefficients in <span class="math">\(S_N\)</span> and <code class="docutils literal"><span class="pre">f</span></code> is a Python
function implementing the mathematical function <span class="math">\(f(t)\)</span>.</p>
<p><strong>Solution.</strong>
See the script below.</p>
<p><strong>e)</strong>
Make a function <code class="docutils literal"><span class="pre">trial(f,</span> <span class="pre">N)</span></code> for interactively giving <span class="math">\(b_n\)</span>
values and getting a plot on the screen where the resulting
<span class="math">\(S_N(t)\)</span> is plotted together with <span class="math">\(f(t)\)</span>. The error in the
approximation should also be computed as indicated in d).
The argument <code class="docutils literal"><span class="pre">f</span></code>
is a Python function for <span class="math">\(f(t)\)</span> and <code class="docutils literal"><span class="pre">N</span></code> is the number of terms <span class="math">\(N\)</span> in
the sum <span class="math">\(S_N(t)\)</span>. The <code class="docutils literal"><span class="pre">trial</span></code> function can run a loop where
the user is asked for the <span class="math">\(b_n\)</span> values in each pass of the
loop and the corresponding plot is shown.
You must find a way to terminate the loop when the
experiments are over. Use <code class="docutils literal"><span class="pre">M=500</span></code> in the calls to <code class="docutils literal"><span class="pre">plot_compare</span></code>
and <code class="docutils literal"><span class="pre">error</span></code>.</p>
<p><strong>Hint.</strong>
To make this part of your program work, you may have to insert
<code class="docutils literal"><span class="pre">from</span> <span class="pre">matplotlib.pylab</span> <span class="pre">import</span> <span class="pre">*</span></code> at the top and also add
<code class="docutils literal"><span class="pre">show()</span></code> after the plot command in the loop.</p>
<p><strong>Solution.</strong>
See the script below. Note that the call to <code class="docutils literal"><span class="pre">trial</span></code> is
commented out, but the function will run if the leading <code class="docutils literal"><span class="pre">#</span></code> is removed.</p>
<p><strong>f)</strong>
Choose <span class="math">\(f(t)\)</span> to be a straight line
<span class="math">\(f(t) = \frac{1}{\pi}t\)</span> on <span class="math">\([-\pi,\pi]\)</span>. Call <code class="docutils literal"><span class="pre">trial(f,</span> <span class="pre">3)</span></code>
and try to find through experimentation
some values <span class="math">\(b_1\)</span>, <span class="math">\(b_2\)</span>, and <span class="math">\(b_3\)</span> such that
the sum of sines <span class="math">\(S_N(t)\)</span> is a good approximation to the straight line.</p>
<p><strong>Solution.</strong>
See the function <code class="docutils literal"><span class="pre">trial</span></code> in the script below.</p>
<p><strong>g)</strong>
Now we shall try to automate the procedure in f). Write a function
that has three nested loops over values of <span class="math">\(b_1\)</span>, <span class="math">\(b_2\)</span>, and <span class="math">\(b_3\)</span>.
Let each loop cover the interval <span class="math">\([-1,1]\)</span> in steps of <span class="math">\(0.1\)</span>. For each
combination of <span class="math">\(b_1\)</span>, <span class="math">\(b_2\)</span>, and <span class="math">\(b_3\)</span>, the error in the approximation <span class="math">\(S_N\)</span>
should be computed. Use this to find, and print, the smallest error and the
corresponding values of <span class="math">\(b_1\)</span>, <span class="math">\(b_2\)</span>, and <span class="math">\(b_3\)</span>. Let the program also plot
<span class="math">\(f\)</span> and the approximation <span class="math">\(S_N\)</span> corresponding to the smallest error.</p>
<p><strong>Solution.</strong>
The code may be written as follows</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">zeros</span><span class="p">,</span> <span class="n">linspace</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">copy</span><span class="p">,</span> <span class="n">arange</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">sinesum</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes S as the sum over n of b_n * sin(n*t).</span>
<span class="sd">    For each point in time (M) we loop over all b_n to</span>
<span class="sd">    produce one element S[M], i.e. one element in</span>
<span class="sd">    S corresponds to one point in time.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">M</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">S</span><span class="p">[</span><span class="n">M</span><span class="p">]</span> <span class="o">+=</span> <span class="n">b</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="n">M</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">S</span>

<span class="k">def</span> <span class="nf">test_sinesum</span><span class="p">():</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>  <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.0</span><span class="p">;</span>  <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>
    <span class="k">print</span> <span class="n">sinesum</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_compare</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">M</span><span class="p">):</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="n">left_end</span><span class="p">,</span> <span class="n">right_end</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">sinesum</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&#39;b-&#39;</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="s">&#39;r--&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Time&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;f (blue) and S (red)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">error</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">M</span><span class="p">):</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="n">left_end</span><span class="p">,</span> <span class="n">right_end</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">sinesum</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)):</span>
        <span class="n">E</span> <span class="o">+=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">E</span>

<span class="k">def</span> <span class="nf">trial</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="n">M</span> <span class="o">=</span> <span class="mi">500</span>
    <span class="n">new_trial</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">while</span> <span class="n">new_trial</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="n">text</span> <span class="o">=</span> <span class="s">&#39;Give b&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39; : &#39;</span>
            <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="n">plot_compare</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
        <span class="k">print</span> <span class="s">&#39;The error is: &#39;</span><span class="p">,</span> <span class="n">error</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
        <span class="n">answer</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s">&#39;Another trial (y/n)? &#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">answer</span> <span class="o">==</span> <span class="s">&#39;n&#39;</span><span class="p">:</span>
            <span class="n">new_trial</span> <span class="o">=</span> <span class="bp">False</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">t</span>

<span class="k">def</span> <span class="nf">automatic_fit</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Search for b-values, - just pick limits and step&quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">b</span>
    <span class="n">M</span> <span class="o">=</span> <span class="mi">500</span>
    <span class="c"># Produce and store an initially &quot;smallest&quot; error</span>
    <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">test_b</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">smallest_E</span> <span class="o">=</span> <span class="n">error</span><span class="p">(</span><span class="n">test_b</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
    <span class="n">db</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="k">for</span> <span class="n">b1</span> <span class="ow">in</span> <span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="n">db</span><span class="p">,</span> <span class="n">db</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">b2</span> <span class="ow">in</span> <span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="n">db</span><span class="p">,</span> <span class="n">db</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">b3</span> <span class="ow">in</span> <span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="n">db</span><span class="p">,</span> <span class="n">db</span><span class="p">):</span>
                <span class="n">test_b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">b1</span><span class="p">;</span> <span class="n">test_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">b2</span><span class="p">;</span>
                <span class="n">test_b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">b3</span>
                <span class="n">E</span> <span class="o">=</span> <span class="n">error</span><span class="p">(</span><span class="n">test_b</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">E</span> <span class="o">&lt;</span> <span class="n">smallest_E</span><span class="p">:</span>
                    <span class="n">b</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">test_b</span><span class="p">)</span>
                    <span class="n">smallest_E</span> <span class="o">=</span> <span class="n">E</span>
    <span class="n">plot_compare</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
    <span class="k">print</span> <span class="s">&#39;The b coeffiecients: &#39;</span><span class="p">,</span> <span class="n">b</span>
    <span class="k">print</span> <span class="s">&#39;The smallest error found: &#39;</span><span class="p">,</span> <span class="n">smallest_E</span>

<span class="n">left_end</span> <span class="o">=</span> <span class="o">-</span><span class="n">pi</span><span class="p">;</span>  <span class="n">right_end</span> <span class="o">=</span> <span class="n">pi</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="c">#test_sinesum()</span>
<span class="c">#trial(f, N)</span>
<span class="n">automatic_fit</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
<p>Running the program may produce this dialog</p>
<div class="highlight-text"><div class="highlight"><pre>The b coefficients: [ 0.6 -0.2 0.1 ]
The smallest error found: 67.1213886326
</pre></div>
</div>
<p>and the plot seen in Figure <a class="reference internal" href="#fig-fit-sines"><span>Straight line fitted to data with first choice of line parameters (a and b)</span></a></p>
<div class="figure" id="id4">
<span id="fig-fit-sines"></span><a class="reference internal image-reference" href="_images/fit_sines.png"><img alt="_images/fit_sines.png" src="_images/fit_sines.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-text"><em>Straight line fitted to data with first choice of line parameters (a and b)</em></span></p>
</div>
<p>Filename: <code class="docutils literal"><span class="pre">fit_sines.py</span></code>.</p>
<div class="section" id="remarks-3">
<h4>Remarks  (3)<a class="headerlink" href="#remarks-3" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li>The function <span class="math">\(S_N(x)\)</span> is a special case of what is called a <em>Fourier series</em>. At the beginning of the 19th century, Joseph Fourier (1768-1830) showed that any function can be approximated analytically by a sum of cosines and sines. The approximation improves as the number of terms (<span class="math">\(N\)</span>) is increased. Fourier series are very important throughout science and engineering today.</li>
</ol>
<ol class="arabic simple">
<li>Finding the coefficients <span class="math">\(b_n\)</span> is solved much more accurately in <a class="reference internal" href="._pylight004.html#sec-exer-revisitfitsines"><span>Exercise 41: Revisit fit of sines to a function</span></a>, by a procedure that also requires much less human and computer work!</li>
<li>In real applications, <span class="math">\(f(t)\)</span> is not known as a continuous function, but function values of <span class="math">\(f(t)\)</span> are provided. For example, in digital sound applications, music in a CD-quality WAV file is a signal with 44100 samples of the corresponding analog signal <span class="math">\(f(t)\)</span> per second.</li>
</ol>
</div>
</div>
<div class="section" id="exercise-29-count-occurrences-of-a-string-in-a-string">
<span id="nd-exer-counttextstring"></span><h3>Exercise 29: Count occurrences of a string in a string<a class="headerlink" href="#exercise-29-count-occurrences-of-a-string-in-a-string" title="Permalink to this headline">¶</a></h3>
<p>In the analysis of genes one encounters many problem settings
involving searching for certain combinations of letters in a long
string. For example, we may have a string like</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">gene</span> <span class="o">=</span> <span class="s">&#39;AGTCAATGGAATAGGCCAAGCGAATATTTGGGCTACCA&#39;</span>
</pre></div>
</div>
<p>We may traverse this string, letter by letter,
by the for loop <code class="docutils literal"><span class="pre">for</span> <span class="pre">letter</span> <span class="pre">in</span> <span class="pre">gene</span></code>. The length of the string
is given by <code class="docutils literal"><span class="pre">len(gene)</span></code>, so an alternative traversal over an index <code class="docutils literal"><span class="pre">i</span></code> is
<code class="docutils literal"><span class="pre">for</span> <span class="pre">i</span> <span class="pre">in</span> <span class="pre">range(len(gene))</span></code>. Letter number <code class="docutils literal"><span class="pre">i</span></code> is reached through
<code class="docutils literal"><span class="pre">gene[i]</span></code>, and a substring from index <code class="docutils literal"><span class="pre">i</span></code> up to, but not including <code class="docutils literal"><span class="pre">j</span></code>,
is created by <code class="docutils literal"><span class="pre">gene[i:j]</span></code>.</p>
<p><strong>a)</strong>
Write a function <code class="docutils literal"><span class="pre">freq(letter,</span> <span class="pre">text)</span></code> that returns the frequency of the
letter <code class="docutils literal"><span class="pre">letter</span></code> in the string <code class="docutils literal"><span class="pre">text</span></code>, i.e., the number of occurrences of
<code class="docutils literal"><span class="pre">letter</span></code> divided by the length of <code class="docutils literal"><span class="pre">text</span></code>.
Call the function to determine the frequency of <code class="docutils literal"><span class="pre">C</span></code> and <code class="docutils literal"><span class="pre">G</span></code> in the
<code class="docutils literal"><span class="pre">gene</span></code> string above. Compute the frequency by hand too.</p>
<p><strong>b)</strong>
Write a function <code class="docutils literal"><span class="pre">pairs(letter,</span> <span class="pre">text)</span></code>
that counts how many times a pair of the letter <code class="docutils literal"><span class="pre">letter</span></code> (e.g., <code class="docutils literal"><span class="pre">GG</span></code>)
occurs within the string <code class="docutils literal"><span class="pre">text</span></code>. Use the function to determine
how many times the pair <code class="docutils literal"><span class="pre">AA</span></code> appears in the string <code class="docutils literal"><span class="pre">gene</span></code> above.
Perform a manual counting too to check the answer.</p>
<p><strong>c)</strong>
Write a function <code class="docutils literal"><span class="pre">mystruct(text)</span></code> that counts the number of a certain
structure in the string <code class="docutils literal"><span class="pre">text</span></code>. The structure is defined as <code class="docutils literal"><span class="pre">G</span></code> followed by
<code class="docutils literal"><span class="pre">A</span></code> or <code class="docutils literal"><span class="pre">T</span></code> until a double <code class="docutils literal"><span class="pre">GG</span></code>. Perform a manual search for the structure
too to control the computations by <code class="docutils literal"><span class="pre">mystruct</span></code>.</p>
<p><strong>Solution.</strong>
Here is a program:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">gene</span> <span class="o">=</span> <span class="s">&#39;AGTCAATGGAATAGGCCAAGCGAATATTTGGGCTACCA&#39;</span>

<span class="k">def</span> <span class="nf">freq</span><span class="p">(</span><span class="n">letter</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
    <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">letter</span><span class="p">:</span>
            <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">counter</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">pairs</span><span class="p">(</span><span class="n">letter</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
    <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> \
               <span class="n">text</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">letter</span> <span class="ow">and</span> <span class="n">text</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">letter</span><span class="p">:</span>
            <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">counter</span>

<span class="k">def</span> <span class="nf">mystruct</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)):</span>
        <span class="c"># Search for the structure from position i</span>
        <span class="k">if</span> <span class="n">text</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;G&#39;</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;found G at&#39;</span><span class="p">,</span> <span class="n">i</span>
            <span class="c"># Search among A and T letters</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">while</span> <span class="n">text</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;A&#39;</span> <span class="ow">or</span> <span class="n">text</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;T&#39;</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">&#39;next is ok:&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">print</span> <span class="s">&#39;ending is&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">[</span><span class="n">j</span><span class="p">:</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">text</span><span class="p">[</span><span class="n">j</span><span class="p">:</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;GG&#39;</span><span class="p">:</span>
                <span class="c"># Correct ending of structure</span>
                <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">print</span> <span class="s">&#39;yes&#39;</span>
    <span class="k">return</span> <span class="n">counter</span>

<span class="k">print</span> <span class="s">&#39;frequency of C: </span><span class="si">%.1f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">freq</span><span class="p">(</span><span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="n">gene</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;frequency of G: </span><span class="si">%.1f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">freq</span><span class="p">(</span><span class="s">&#39;G&#39;</span><span class="p">,</span> <span class="n">gene</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;no of pairs AA: </span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">pairs</span><span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">,</span> <span class="n">gene</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;no of structures: </span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">mystruct</span><span class="p">(</span><span class="n">gene</span><span class="p">)</span>
</pre></div>
</div>
<p>Filename: <code class="docutils literal"><span class="pre">count_substrings.py</span></code>.</p>
<div class="section" id="remarks-4">
<h4>Remarks  (4)<a class="headerlink" href="#remarks-4" title="Permalink to this headline">¶</a></h4>
<p>You are supposed to solve the tasks using simple programming with loops
and variables. While a) and b) are quite straightforward, c) quickly
involves demanding logic.
However, there are powerful tools available in Python that
can solve the tasks efficiently in very compact code: a)
<code class="docutils literal"><span class="pre">text.count(letter)/float(len(text))</span></code>; b) <code class="docutils literal"><span class="pre">text.count(letter*2)</span></code>;
c) <code class="docutils literal"><span class="pre">len(re.findall('G[AT]+?GG',</span> <span class="pre">text))</span></code>. That is, there is rich
functionality for analysis of text in Python and this is particularly
useful in analysis of gene sequences.</p>
<span class="target" id="sec-integrals"></span></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Basic constructions</a><ul>
<li><a class="reference internal" href="#if-tests-colon-and-indentation">If tests, colon and indentation</a></li>
<li><a class="reference internal" href="#functions">Functions</a></li>
<li><a class="reference internal" href="#for-loops">For loops</a></li>
<li><a class="reference internal" href="#while-loops">While loops</a></li>
<li><a class="reference internal" href="#lists-and-tuples-alternatives-to-arrays">Lists and tuples - alternatives to arrays</a></li>
<li><a class="reference internal" href="#reading-from-and-writing-to-files">Reading from and writing to files</a></li>
<li><a class="reference internal" href="#exercises-2">Exercises  (2)</a><ul>
<li><a class="reference internal" href="#exercise-11-errors-with-colon-indent-etc">Exercise 11: Errors with colon, indent, etc.</a></li>
<li><a class="reference internal" href="#exercise-12-compare-integers-a-and-b">Exercise 12: Compare integers a and b</a></li>
<li><a class="reference internal" href="#exercise-13-functions-for-circumference-and-area-of-a-circle">Exercise 13: Functions for circumference and area of a circle</a></li>
<li><a class="reference internal" href="#exercise-14-function-for-area-of-a-rectangle">Exercise 14: Function for area of a rectangle</a></li>
<li><a class="reference internal" href="#exercise-15-area-of-a-polygon">Exercise 15: Area of a polygon</a></li>
<li><a class="reference internal" href="#exercise-16-average-of-integers">Exercise 16: Average of integers</a></li>
<li><a class="reference internal" href="#exercise-17-while-loop-with-errors">Exercise 17: While loop with errors</a></li>
<li><a class="reference internal" href="#exercise-18-area-of-rectangle-versus-circle">Exercise 18: Area of rectangle versus circle</a></li>
<li><a class="reference internal" href="#exercise-19-find-crossing-points-of-two-graphs">Exercise 19: Find crossing points of two graphs</a></li>
<li><a class="reference internal" href="#exercise-20-sort-array-with-numbers">Exercise 20: Sort array with numbers</a></li>
<li><a class="reference internal" href="#exercise-21-compute">Exercise 21: Compute <span class="math">\(\pi\)</span></a></li>
<li><a class="reference internal" href="#exercise-22-compute-combinations-of-sets">Exercise 22: Compute combinations of sets</a></li>
<li><a class="reference internal" href="#exercise-23-frequency-of-random-numbers">Exercise 23: Frequency of random numbers</a><ul>
<li><a class="reference internal" href="#remarks-1">Remarks  (1)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#exercise-24-game-21">Exercise 24: Game 21</a></li>
<li><a class="reference internal" href="#exercise-25-linear-interpolation">Exercise 25: Linear interpolation</a></li>
<li><a class="reference internal" href="#exercise-26-test-straight-line-requirement">Exercise 26: Test straight line requirement</a></li>
<li><a class="reference internal" href="#exercise-27-fit-straight-line-to-data">Exercise 27: Fit straight line to data</a><ul>
<li><a class="reference internal" href="#remarks-2">Remarks  (2)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#exercise-28-fit-sines-to-straight-line">Exercise 28: Fit sines to straight line</a><ul>
<li><a class="reference internal" href="#remarks-3">Remarks  (3)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#exercise-29-count-occurrences-of-a-string-in-a-string">Exercise 29: Count occurrences of a string in a string</a><ul>
<li><a class="reference internal" href="#remarks-4">Remarks  (4)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="._pylight002.html"
                        title="previous chapter">The first few steps</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="._pylight004.html"
                        title="next chapter">Computing integrals</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/._pylight003.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015, S. Linge and H. P. Langtangen.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.4</a>
      
      |
      <a href="_sources/._pylight003.txt"
          rel="nofollow">Page source</a></li>
    </div>

    

    
  </body>
</html>