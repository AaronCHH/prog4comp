<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Programming for Computations - A Gentle Introduction to Numerical Simulations with MATLAB/Octave">
<meta name="keywords" content="computer program,programming,language programming,language computer,MATLAB,Octave,Fortran,C,C++,Python,Maple,Mathematica,syntax,bug,debugging,script (and scripting),implement,print,program run,program execute,code,comment,instruction,program statement,variable,assignment,semi-colon (easy print),calculator,text editor,Idle,prompt,program typing,program run,program execute,ipython,m-file,function,function call,atan,function input parameter,function output parameter,function return,function take a parameter,library,library function,from,import,math,module,package,linspace,xlabel,ylabel,plot,interactive use (of Matlab),import,keyboard arrow up/down,operator Arithmetic,parentheses,variable type,variable name,float,integer,string,type conversion,reserved words,variable integer,variable float,variable string,variable assignment,default,single (precision),double (precision),printing formatted,printf formatting,default,array,array element,zeros,allocate,array index,indexing zero based,indexing one based,Matlab one-based indexing,array slice of,graph,hold (on/off),plot figure,title,legend,axis,hardcopy,format png,matrix mat,matrix vector product,transpose,linear algebra,matrix,vector,error message,debugging,debugger,try-exception,exception handling,program crash,program testing,program verification,program input,program output,input,raw input,list,tuple,symbolic computations,symbolic operations,symbolic simplifications,Symbolic Toolbox,WolframAlpha,Mathematica,Sage (symbolic package),Python documentation,garbage collection,variable delete,if,elif,else,colon,indent,boolean,boolean expression,True,False,boolean True,boolean False,pseudo code,operator Logical,function,function definition,def,return,argument,parameter input,parameter output,function nargin,function nargout,variable local,variable global,doc string,function handle,function local,function global,function nested,loop for,for loop,range,loop iteration,loop index,loop double,loop multiple,loop nested,linear algebra,while loop,loop while,loop infinite,loop iteration,loop index,array sorting,Leibniz pi,Euler pi,programming game,linear interpolation,least squares method,Fourier series,integral analytically,integral exact,integral approximately,integration points,code re-use,unit tests,complex domains,Monte Carlo integration,seed (random generators),scheme,finite difference method,forward difference approximation,Forward Euler scheme,logistic model,carrying capacity,SIR model,scalar ODE,ODE scalar,vector ODE,ODE vector,system of ODEs,Heun's method,Runge-Kutta, 2nd-order method,2nd-order Runge-Kutta method,RK2,PDE,heat equation,diffusion equation,MOL forward Euler,method of lines,MOL,mesh points,cell,method of lines,unstable solutions,instability,stability criterion,Poisson equation,Laplace equation,root finding,code robust,code try-except,code exception,Newton starting value,return None,sys.exit">

<title>Programming for Computations - A Gentle Introduction to Numerical Simulations with MATLAB/Octave</title>

<!-- Bootstrap style: bootswatch_journal -->
<link href="http://netdna.bootstrapcdn.com/bootswatch/3.1.1/journal/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }
/* Let pre tags for code blocks have the same color as the surroundings */
pre { color: inherit; background-color: transparent; }
</style>


</head>

<!-- tocinfo
{'highest level': 0,
 'sections': [(u' Preface ', 0, None, '___sec0'),
              (u' Why learn programming? ', 3, None, '___sec1'),
              (u' Target audience and background knowledge ',
               3,
               None,
               '___sec2'),
              (u' Numerical methods ', 3, None, '___sec3'),
              (u' The computer language: Matlab ', 3, None, '___sec4'),
              (u' How this book is different ', 3, None, '___sec5'),
              (u' Acknowledgments ', 3, None, '___sec6'),
              (u' The first few steps ',
               0,
               u'1st:TheFirstFewSteps',
               u'1st:TheFirstFewSteps'),
              (u' What is a program? And what is programming? ',
               1,
               None,
               '___sec8'),
              (u' A Matlab program with variables ',
               1,
               u'1st:ex1',
               u'1st:ex1'),
              (u' The program ', 2, None, '___sec10'),
              (u' Dissection of the program ', 2, None, '___sec11'),
              (u' Why not just use a pocket calculator? ',
               2,
               None,
               '___sec12'),
              (u' The importance of using a text editor to write programs ',
               2,
               None,
               '___sec13'),
              (u' Write and run your first program ', 2, None, '___sec14'),
              (u' Write and run a program in Matlab ', 3, None, '___sec15'),
              (u' Write a program in a text editor and run it in Octave ',
               3,
               None,
               '___sec16'),
              (u'  A Matlab program with a library function ',
               1,
               u'1st:ex2',
               u'1st:ex2'),
              (u' A Matlab program with vectorization and plotting ',
               1,
               u'1st:ex3',
               u'1st:ex3'),
              (u' More basic concepts ', 1, None, '___sec19'),
              (u' Using Matlab interactively ', 2, None, '___sec20'),
              (u' Arithmetics, parentheses and round-off errors ',
               2,
               None,
               '___sec21'),
              (u' Variables ', 2, None, '___sec22'),
              (u' Formatting text and numbers ', 2, None, '___sec23'),
              (u' Arrays ', 2, None, '___sec24'),
              (u' Plotting ', 2, None, '___sec25'),
              (u' Error messages and warnings ', 2, None, '___sec26'),
              (u' Input data ', 2, None, '___sec27'),
              (u' Symbolic computations ', 2, None, '___sec28'),
              (u' Concluding remarks ', 2, None, '___sec29'),
              (u' Exercises ', 1, None, '___sec30'),
              (u' Exercise 1: Error messages ',
               2,
               u'1st:exer:ErrorMessages',
               u'1st:exer:ErrorMessages'),
              (u' Exercise 2: Volume of a cube ',
               2,
               u'1st:exer:cubeVolume',
               u'1st:exer:cubeVolume'),
              (u' Exercise 3: Area and circumference of a circle ',
               2,
               u'1st:exer:areaCircle',
               u'1st:exer:areaCircle'),
              (u' Exercise 4: Volumes of three cubes ',
               2,
               u'1st:exer:volumes3cubes',
               u'1st:exer:volumes3cubes'),
              (u' Exercise 5: Average of integers ',
               2,
               u'1st:exer:averageOf5Integers',
               u'1st:exer:averageOf5Integers'),
              (u' Exercise 6: Interactive computing of volume and area ',
               2,
               u'1st:exer:cubeVolInteractively',
               u'1st:exer:cubeVolInteractively'),
              (u' Exercise 7: Update variable at command prompt ',
               2,
               u'1st:exer:updateVarInteractively',
               u'1st:exer:updateVarInteractively'),
              (u' Exercise 8: Formatted print to screen ',
               2,
               u'1st:exer:printfScreen',
               u'1st:exer:printfScreen'),
              (u' Exercise 9: Matlab documentation and random numbers ',
               2,
               u'1st:exer:PythonDocRandom',
               u'1st:exer:PythonDocRandom'),
              (u' Basic constructions ',
               0,
               u'2nd:BasicConstructins',
               u'2nd:BasicConstructins'),
              (u' If tests, colon and indentation ', 1, None, '___sec41'),
              (u' Functions ', 1, u'sec:functions', u'sec:functions'),
              (u' For loops ', 1, u'sec:for:loops', u'sec:for:loops'),
              (u' While loops ', 1, u'sec:while:loops', u'sec:while:loops'),
              (u' Reading from and writing to files ',
               1,
               u'sec:file:reading:writing',
               u'sec:file:reading:writing'),
              (u' Exercises ', 1, None, '___sec46'),
              (u' Exercise 10: Introducing errors ',
               2,
               u'2nd:exer:IntroducingErrors',
               u'2nd:exer:IntroducingErrors'),
              (u' Exercise 11: Compare integers a and b ',
               2,
               u'2nd:exer:compInt',
               u'2nd:exer:compInt'),
              (u' Exercise 12: Functions for circumference and area of a circle ',
               2,
               u'2nd:exer:funcCircArea',
               u'2nd:exer:funcCircArea'),
              (u' Exercise 13: Function for area of a rectangle ',
               2,
               u'2nd:exer:funcAreaRectangle',
               u'2nd:exer:funcAreaRectangle'),
              (u' Exercise 14: Area of a polygon ',
               2,
               u'2nd:exer:area:polygon',
               u'2nd:exer:area:polygon'),
              (u' Exercise 15: Average of integers ',
               2,
               u'2nd:exer:avNInt',
               u'2nd:exer:avNInt'),
              (u' Exercise 16: While loop with errors ',
               2,
               u'2nd:exer:whileLoopErrors',
               u'2nd:exer:whileLoopErrors'),
              (u' Exercise 17: Area of rectangle versus circle ',
               2,
               u'2nd:exer:areaRectCircle',
               u'2nd:exer:areaRectCircle'),
              (u' Exercise 18: Find crossing points of two graphs ',
               2,
               u'2nd:exer:Cross2Graphs',
               u'2nd:exer:Cross2Graphs'),
              (u' Exercise 19: Sort array with numbers ',
               2,
               u'2nd:exer:sortNumbers',
               u'2nd:exer:sortNumbers'),
              (u' Exercise 20: Compute $\\pi$ ',
               2,
               u'2nd:exer:computingPi',
               u'2nd:exer:computingPi'),
              (u' Exercise 21: Compute combinations of sets ',
               2,
               u'2nd:exer:combinatorics1',
               u'2nd:exer:combinatorics1'),
              (u' Exercise 22: Frequency of random numbers ',
               2,
               u'2nd:exer:numberOccurrence',
               u'2nd:exer:numberOccurrence'),
              (u' Remarks ', 3, None, '___sec60'),
              (u' Exercise 23: Game 21 ',
               2,
               u'2nd:exer:Game21',
               u'2nd:exer:Game21'),
              (u' Exercise 24: Linear interpolation ',
               2,
               u'2nd:exer:linearInterpol',
               u'2nd:exer:linearInterpol'),
              (u' Exercise 25: Test straight line requirement ',
               2,
               u'2nd:exer:testStraightLine',
               u'2nd:exer:testStraightLine'),
              (u' Exercise 26: Fit straight line to data ',
               2,
               u'2nd:exer:fitLine',
               u'2nd:exer:fitLine'),
              (u' Remarks ', 3, None, '___sec65'),
              (u' Exercise 27: Fit sines to straight line ',
               2,
               u'2nd:exer:fitSines',
               u'2nd:exer:fitSines'),
              (u' Remarks ', 3, None, '___sec67'),
              (u' Exercise 28: Count occurrences of a string in a string ',
               2,
               u'2nd:exer:countTextString',
               u'2nd:exer:countTextString'),
              (u' Computing integrals ',
               0,
               u'sec:integrals',
               u'sec:integrals'),
              (u' Basic ideas of numerical integration ',
               1,
               u'sec:integrals:basic',
               u'sec:integrals:basic'),
              (u' Computational example ', 3, None, '___sec71'),
              (u' The composite trapezoidal rule ',
               1,
               u'sec:integrals:trap',
               u'sec:integrals:trap'),
              (u' The general formula ',
               2,
               u'sec:integrals:formula',
               u'sec:integrals:formula'),
              (u' Implementation ',
               2,
               u'sec:integrals:trap:impl',
               u'sec:integrals:trap:impl'),
              (u' Specific or general implementation? ', 3, None, '___sec75'),
              (u' Implementation with functions ', 3, None, '___sec76'),
              (u' Solving our specific problem in a session ',
               3,
               None,
               '___sec77'),
              (u' Solving our specific problem in a program ',
               3,
               None,
               '___sec78'),
              (u' Alternative flat special-purpose implementation ',
               2,
               None,
               '___sec79'),
              (u' The composite midpoint method ',
               1,
               u'sec:integrals:Midpoint',
               u'sec:integrals:Midpoint'),
              (u' The idea ', 3, None, '___sec81'),
              (u' The general formula ', 2, None, '___sec82'),
              (u' Implementation ',
               2,
               u'sec:midpoint:code',
               u'sec:midpoint:code'),
              (u' Comparing the trapezoidal and the midpoint methods ',
               2,
               None,
               '___sec84'),
              (u' Testing ', 1, None, '___sec85'),
              (u' Problems with brief testing procedures ',
               2,
               None,
               '___sec86'),
              (u' Test procedures ',
               2,
               u'sec:integrals:testprocs',
               u'sec:integrals:testprocs'),
              (u' Hand-computed results ', 3, None, '___sec88'),
              (u' Solving a problem without numerical errors ',
               3,
               None,
               '___sec89'),
              (u' Demonstrating correct convergence rates ',
               3,
               None,
               '___sec90'),
              (u' Constructing unit tests and writing test functions ',
               2,
               u'sec:integrals:test:functions',
               u'sec:integrals:test:functions'),
              (u' Hand-computed numerical results ', 3, None, '___sec92'),
              (u' Solving a problem without numerical errors ',
               3,
               None,
               '___sec93'),
              (u' Demonstrating correct convergence rates ',
               3,
               None,
               '___sec94'),
              (u' Vectorization ', 1, None, '___sec95'),
              (u' Vectorizing the midpoint rule ', 3, None, '___sec96'),
              (u' Vectorizing the trapezoidal rule ', 3, None, '___sec97'),
              (u' Measuring computational speed ', 1, None, '___sec98'),
              (u' Double and triple integrals ',
               1,
               u'sec:int:double',
               u'sec:int:double'),
              (u' The midpoint rule for a double integral ',
               2,
               u'sec:int:double:midpoint',
               u'sec:int:double:midpoint'),
              (u' Derivation via one-dimensional integrals ',
               3,
               None,
               '___sec101'),
              (u' Direct derivation ', 3, None, '___sec102'),
              (u' Programming a double sum ', 3, None, '___sec103'),
              (u' Reusing code for one-dimensional integrals ',
               3,
               None,
               '___sec104'),
              (u' Verification via test functions ', 3, None, '___sec105'),
              (u' The midpoint rule for a triple integral ',
               2,
               None,
               '___sec106'),
              (u' Theory ', 3, None, '___sec107'),
              (u' Implementation ', 3, None, '___sec108'),
              (u' Monte Carlo integration for complex-shaped domains ',
               2,
               u'sec:int:complex:domain',
               u'sec:int:complex:domain'),
              (u' The Monte Carlo integration algorithm ',
               3,
               None,
               '___sec110'),
              (u' Implementation ', 3, None, '___sec111'),
              (u' Verification ', 3, None, '___sec112'),
              (u' Test function for function with random numbers ',
               3,
               None,
               '___sec113'),
              (u' Integral over a circle ', 3, None, '___sec114'),
              (u' Exercises ', 1, None, '___sec115'),
              (u' Exercise 29: Hand calculations for the trapezoidal method ',
               2,
               u'sec:exer:trap:hand',
               u'sec:exer:trap:hand'),
              (u' Exercise 30: Hand calculations for the midpoint method ',
               2,
               u'sec:exer:midpt:hand',
               u'sec:exer:midpt:hand'),
              (u' Exercise 31: Compute a simple integral ',
               2,
               u'sec:exer:trap:mid:parabola',
               u'sec:exer:trap:mid:parabola'),
              (u' Exercise 32: Hand-calculations with sine integrals ',
               2,
               u'sec:exer:hand:sine',
               u'sec:exer:hand:sine'),
              (u' Exercise 33: Make test functions for the midpoint method ',
               2,
               u'sec:exer:test:midpoint',
               u'sec:exer:test:midpoint'),
              (u' Exercise 34: Explore round-off errors with large numbers ',
               2,
               u'sec:exer:test:roundoff',
               u'sec:exer:test:roundoff'),
              (u' Exercise 35: Write test functions for $\\int_0^4\\sqrt{x}dx$ ',
               2,
               u'sec:exer:test:convrates:sqrt',
               u'sec:exer:test:convrates:sqrt'),
              (u' Remarks ', 3, None, '___sec123'),
              (u' Exercise 36: Rectangle methods ',
               2,
               u'sec:exer:rectangleMethod',
               u'sec:exer:rectangleMethod'),
              (u' Exercise 37: Adaptive integration ',
               2,
               u'sec:exer:adaptive:int',
               u'sec:exer:adaptive:int'),
              (u' Remarks ', 3, None, '___sec126'),
              (u' Exercise 38: Integrating x raised to x ',
               2,
               u'sec:exer:integrate:x2x',
               u'sec:exer:integrate:x2x'),
              (u' Exercise 39: Integrate products of sine functions ',
               2,
               u'sec:exer:sine:products',
               u'sec:exer:sine:products'),
              (u' Exercise 40: Revisit fit of sines to a function ',
               2,
               u'sec:exer:revisitFitSines',
               u'sec:exer:revisitFitSines'),
              (u' Exercise 41: Derive the trapezoidal rule for a double integral ',
               2,
               u'sec:exer:trapezoidal:2D',
               u'sec:exer:trapezoidal:2D'),
              (u' Exercise 42: Compute the area of a triangle by Monte Carlo integration ',
               2,
               u'sec:exer:MC:ellipse',
               u'sec:exer:MC:ellipse'),
              (u' Solving ordinary differential equations ',
               0,
               u'5th:SolvODEs',
               u'5th:SolvODEs'),
              (u' Population growth ', 1, u'sec:de:pg', u'sec:de:pg'),
              (u' Derivation of the model ',
               2,
               u'sec:de:pg:model',
               u'sec:de:pg:model'),
              (u' Numerical solution ',
               2,
               u'sec:de:pg:numerics',
               u'sec:de:pg:numerics'),
              (u' Programming the Forward Euler scheme; the special case ',
               2,
               u'sec:de:pg:prog1',
               u'sec:de:pg:prog1'),
              (u' Understanding the Forward Euler method ',
               2,
               u'sec:de:pg:geom',
               u'sec:de:pg:geom'),
              (u' Programming the Forward Euler scheme; the general case ',
               2,
               u'sec:de:FE:gen',
               u'sec:de:FE:gen'),
              (u' Making the population growth model more realistic ',
               2,
               None,
               '___sec139'),
              (u' Verification: exact linear solution of the discrete equations ',
               2,
               u'sec:de:growth:test:linear',
               u'sec:de:growth:test:linear'),
              (u' Spreading of diseases ', 1, None, '___sec141'),
              (u' Spreading of a flu ', 2, u'sec:de:flu', u'sec:de:flu'),
              (u' A Forward Euler method for the differential equation system ',
               2,
               u'sec:de:flu:FE',
               u'sec:de:flu:FE'),
              (u' Programming the numerical method; the special case ',
               2,
               u'sec:de:flu:prog:spec',
               u'sec:de:flu:prog:spec'),
              (u' Outbreak or not ', 2, None, '___sec145'),
              (u' Abstract problem and notation ',
               2,
               u'sec:de:flu:generic',
               u'sec:de:flu:generic'),
              (u' Programming the numerical method; the general case ',
               2,
               u'sec:de:flu:prog:generic',
               u'sec:de:flu:prog:generic'),
              (u' Time-restricted immunity ', 2, None, '___sec148'),
              (u' Incorporating vaccination ',
               2,
               u'sec:de:flu:vaccine',
               u'sec:de:flu:vaccine'),
              (u' Discontinuous coefficients: a vaccination campaign ',
               2,
               u'sec:de:flu:vaccine:discont',
               u'sec:de:flu:vaccine:discont'),
              (u' Oscillating one-dimensional systems ',
               1,
               u'sec:de:vib',
               u'sec:de:vib'),
              (u' Derivation of a simple model ', 2, None, '___sec152'),
              (u' Numerical solution ', 2, None, '___sec153'),
              (u' Programming the numerical method; the special case ',
               2,
               u'sec:de:vib:special',
               u'sec:de:vib:special'),
              (u' A magic fix of the numerical method ',
               2,
               None,
               '___sec155'),
              (u" The 2nd-order Runge-Kutta method (or Heun's method) ",
               2,
               u'sec:de:osc:Heun',
               u'sec:de:osc:Heun'),
              (u' Odespy: software for solving ODEs ',
               2,
               u'sec:de:osc:odespy',
               u'sec:de:osc:odespy'),
              (u' The 4th-order Runge-Kutta method ', 2, None, '___sec158'),
              (u' The algorithm ', 3, None, '___sec159'),
              (u' Application ', 3, None, '___sec160'),
              (u' Implementation ', 3, None, '___sec161'),
              (u' Derivation ', 3, None, '___sec162'),
              (u' More effects: damping, nonlinearity, and external forces ',
               2,
               None,
               '___sec163'),
              (u' The Euler-Cromer scheme ', 3, None, '___sec164'),
              (u' The 4-th order Runge-Kutta method ', 3, None, '___sec165'),
              (u' Illustration of linear damping ', 2, None, '___sec166'),
              (u' Illustration of linear damping with sinusoidal excitation ',
               2,
               None,
               '___sec167'),
              (u' Spring-mass system with sliding friction ',
               2,
               u'sec:de:vib:ode2:sliding:friction',
               u'sec:de:vib:ode2:sliding:friction'),
              (u' A finite difference method; undamped, linear case ',
               2,
               u'sec:de:vib:2nd',
               u'sec:de:vib:2nd'),
              (u' A finite difference method; linear damping ',
               2,
               u'sec:de:vib:2nd:damped1',
               u'sec:de:vib:2nd:damped1'),
              (u' Exercises ', 1, None, '___sec171'),
              (u' Exercise 43: Geometric construction of the Forward Euler method ',
               2,
               u'sec:de:exer:geom',
               u'sec:de:exer:geom'),
              (u' Exercise 44: Make test functions for the Forward Euler method ',
               2,
               u'sec:de:exer:FE:test1',
               u'sec:de:exer:FE:test1'),
              (u" Exercise 45: Implement and evaluate Heun's method ",
               2,
               u'sec:de:exer:Heun:pg',
               u'sec:de:exer:Heun:pg'),
              (u' Exercise 46: Find an appropriate time step; logistic model ',
               2,
               u'sec:de:exer:logistic:dtopt',
               u'sec:de:exer:logistic:dtopt'),
              (u' Exercise 47: Find an appropriate time step; SIR model ',
               2,
               u'sec:de:exer:SIR:dtopt',
               u'sec:de:exer:SIR:dtopt'),
              (u' Exercise 48: Model an adaptive vaccination campaign ',
               2,
               u'sec:de:exer:SIRV:padapt',
               u'sec:de:exer:SIRV:padapt'),
              (u' Exercise 49: Make a SIRV model with time-limited effect of vaccination ',
               2,
               u'sec:de:exer:SIRV:padapt',
               u'sec:de:exer:SIRV:padapt'),
              (u' Exercise 50: Refactor a flat program ',
               2,
               u'sec:de:exer:vib:FE:func',
               u'sec:de:exer:vib:FE:func'),
              (u' Exercise 51: Simulate oscillations by a general ODE solver ',
               2,
               u'sec:de:exer:vib:ode_FE',
               u'sec:de:exer:vib:ode_FE'),
              (u' Exercise 52: Compute the energy in oscillations ',
               2,
               u'sec:de:exer:vib:BE',
               u'sec:de:exer:vib:BE'),
              (u' Exercise 53: Use a Backward Euler scheme for population growth ',
               2,
               u'sec:de:exer:pg:BE',
               u'sec:de:exer:pg:BE'),
              (u' Exercise 54: Use a Crank-Nicolson scheme for population growth ',
               2,
               u'sec:de:exer:pg:CN',
               u'sec:de:exer:pg:CN'),
              (u' Exercise 55: Understand finite differences via Taylor series ',
               2,
               u'sec:de:exer:fd:Taylor',
               u'sec:de:exer:fd:Taylor'),
              (u' Exercise 56: Use a Backward Euler scheme for oscillations ',
               2,
               u'sec:de:exer:vib:BE',
               u'sec:de:exer:vib:BE'),
              (u' Remarks ', 3, None, '___sec186'),
              (u" Exercise 57: Use Heun's method for the SIR model ",
               2,
               u'sec:de:exer:SIR:Heun',
               u'sec:de:exer:SIR:Heun'),
              (u' Exercise 58: Use Odespy to solve a simple ODE ',
               2,
               u'sec:de:exer:odespy:decay',
               u'sec:de:exer:odespy:decay'),
              (u' Exercise 59: Set up a Backward Euler scheme for oscillations ',
               2,
               u'sec:de:exer:osc:BE',
               u'sec:de:exer:osc:BE'),
              (u' Exercise 60: Set up a Forward Euler scheme for nonlinear and damped oscillations ',
               2,
               u'sec:de:exer:osc:FE:general',
               u'sec:de:exer:osc:FE:general'),
              (u' Exercise 61: Discretize an initial condition ',
               2,
               u'sec:de:exer:osc:2nd:V0ic',
               u'sec:de:exer:osc:2nd:V0ic'),
              (u' Solving partial differential equations ',
               0,
               u'6th:SolvPDEs',
               u'6th:SolvPDEs'),
              (u' Finite difference methods ',
               1,
               u'6th:SolvPDEs:MOLandFE',
               u'6th:SolvPDEs:MOLandFE'),
              (u' Reduction of a PDE to a system of ODEs ',
               2,
               u'sec:pde:diff1D:reduce',
               u'sec:pde:diff1D:reduce'),
              (u' Construction of a test problem with known discrete solution ',
               2,
               u'sec:pde:diff1D:testproblem',
               u'sec:pde:diff1D:testproblem'),
              (u' Implementation: Forward Euler method ',
               2,
               None,
               '___sec196'),
              (u' Application: heat conduction in a rod ',
               2,
               u'sec:pde:diff1D:rod',
               u'sec:pde:diff1D:rod'),
              (u' Vectorization ', 2, None, '___sec198'),
              (u' Using Odespy to solve the system of ODEs ',
               2,
               None,
               '___sec199'),
              (u' Implicit methods ', 2, None, '___sec200'),
              (u' Exercises ', 1, None, '___sec201'),
              (u' Exercise 62: Simulate a diffusion equation by hand ',
               2,
               u'sec:pde:diff1D:exer:handFE',
               u'sec:pde:diff1D:exer:handFE'),
              (u' Exercise 63: Compute temperature variations in the ground ',
               2,
               u'sec:pde:diff1D:exer:groundtemp',
               u'sec:pde:diff1D:exer:groundtemp'),
              (u' Exercise 64: Compare implicit methods ',
               2,
               u'sec:pde:diff1D:exer:compare:implicit',
               u'sec:pde:diff1D:exer:compare:implicit'),
              (u' Exercise 65: Explore adaptive and implicit methods ',
               2,
               u'sec:pde:diff1D:exer:groundtemp:adapt',
               u'sec:pde:diff1D:exer:groundtemp:adapt'),
              (u' Exercise 66: Investigate the $\\theta$ rule ',
               2,
               u'sec:pde:diff1D:exer:CN',
               u'sec:pde:diff1D:exer:CN'),
              (u' Remarks ', 3, None, '___sec207'),
              (u' Exercise 67: Compute the diffusion of a Gaussian peak ',
               2,
               u'sec:pde:diff1D:exer:Gaussian',
               u'sec:pde:diff1D:exer:Gaussian'),
              (u' Exercise 68: Vectorize a function for computing the area of a polygon ',
               2,
               u'2nd:exer:area:polygon2',
               u'2nd:exer:area:polygon2'),
              (u' Exercise 69: Explore symmetry ',
               2,
               u'sec:pde:diff1D:exer:Gaussian:symm',
               u'sec:pde:diff1D:exer:Gaussian:symm'),
              (u' Remarks ', 3, None, '___sec211'),
              (u' Exercise 70: Compute solutions as $t\\rightarrow\\infty$ ',
               2,
               u'sec:pde:diff1D:exer:stationary',
               u'sec:pde:diff1D:exer:stationary'),
              (u' Remarks ', 3, None, '___sec213'),
              (u' Exercise 71: Solve a two-point boundary value problem ',
               2,
               u'sec:pde:diff1D:exer:stationary2',
               u'sec:pde:diff1D:exer:stationary2'),
              (u' Solving nonlinear algebraic equations ',
               0,
               u'4th:NonlinAlgEq',
               u'4th:NonlinAlgEq'),
              (u' Brute force methods ',
               1,
               u'4th:bruteforce',
               u'4th:bruteforce'),
              (u' Brute force root finding ', 2, None, '___sec217'),
              (u' Numerical algorithm ', 3, None, '___sec218'),
              (u' Implementation ', 3, None, '___sec219'),
              (u' Brute force optimization ', 2, None, '___sec220'),
              (u' Numerical algorithm ', 3, None, '___sec221'),
              (u' Implementation ', 3, None, '___sec222'),
              (u' Model problem for algebraic equations ',
               2,
               None,
               '___sec223'),
              (u" Newton's method ",
               1,
               u'4th:NonlinAlgEq:Newt',
               u'4th:NonlinAlgEq:Newt'),
              (u" Deriving and implementing Newton's method ",
               2,
               None,
               '___sec225'),
              (u' Making a more efficient and robust implementation ',
               2,
               u'4th:Newton:robust',
               u'4th:Newton:robust'),
              (u' The secant method ',
               1,
               u'4th:NonlinAlgEq:Secant',
               u'4th:NonlinAlgEq:Secant'),
              (u' The bisection method ',
               1,
               u'4th:NonlinAlgEq:Bisect',
               u'4th:NonlinAlgEq:Bisect'),
              (u' Rate of convergence ',
               1,
               u'4th:NonlinAlgEq:RateConv',
               u'4th:NonlinAlgEq:RateConv'),
              (u' Exercises ', 1, None, '___sec230'),
              (u" Exercise 72: Understand why Newton's method can fail ",
               2,
               u'4th:exer:Newton:failure',
               u'4th:exer:Newton:failure'),
              (u' Exercise 73: See if the secant method fails ',
               2,
               u'4th:exer:Secant:failure',
               u'4th:exer:Secant:failure'),
              (u' Exercise 74: Understand how the bisection method cannot fail ',
               2,
               u'4th:exer:Bisection:failure',
               u'4th:exer:Bisection:failure'),
              (u" Exercise 75: Combine the bisection method with Newton's method ",
               2,
               u'4th:exer:Bisection:Newton',
               u'4th:exer:Bisection:Newton'),
              (u" Exercise 76: Write a test function for Newton's method ",
               2,
               u'4th:exer:NewtonHand',
               u'4th:exer:NewtonHand'),
              (u' Exercise 77: Solve nonlinear equation for a vibrating beam ',
               2,
               u'4th:exer:beam:vib',
               u'4th:exer:beam:vib'),
              (u' References ', 0, None, '___sec237')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands.tex -->
$$
\newcommand{\Oof}[1]{\mathcal{O}(#1)}
$$




    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="p4c-bootstrap-Matlab.html">Programming for Computations - A Gentle Introduction to Numerical Simulations with MATLAB/Octave</a>
  </div>
  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab000.html#___sec0" style="font-size: 80%;">Preface</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab001.html#1st:TheFirstFewSteps" style="font-size: 80%;">The first few steps</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab007.html#2nd:BasicConstructins" style="font-size: 80%;">Basic constructions</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab012.html#sec:integrals" style="font-size: 80%;">Computing integrals</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#5th:SolvODEs" style="font-size: 80%;">Solving ordinary differential equations</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#6th:SolvPDEs" style="font-size: 80%;">Solving partial differential equations</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab023.html#4th:NonlinAlgEq" style="font-size: 80%;">Solving nonlinear algebraic equations</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab029.html#___sec237" style="font-size: 80%;">References</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0028"></a>
<!-- !split -->

<h1 id="___sec230">Exercises </h1>

<p>
<!-- --- begin exercise --- -->

<h2 id="4th:exer:Newton:failure">Exercise 72: Understand why Newton's method can fail</h2>

<p>
The purpose of this exercise is to understand when Newton's method works
and fails. To this end, solve \( \tanh x=0 \) by Newton's method
and study the intermediate details of the algorithm. Start with \( x_0=1.08 \).
Plot the tangent in each iteration of Newton's method. Then repeat the calculations
and the plotting when \( x_0=1.09 \). Explain what you observe.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_72_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_72_1">

<p>
The program may be written as:

<p>

<!-- begin box -->
<div style="width: 95%; padding: 10px; border: 1px solid #000; border-radius: 4px;">
Here is a missing file: Newton_failure
</div>
<!-- end box -->


<p>
which may be called from the script <code>use_my_Newton_failure.m</code>:

<p>

<!-- begin box -->
<div style="width: 95%; padding: 10px; border: 1px solid #000; border-radius: 4px;">
Here is a missing file: use_my_Newton_failure
</div>
<!-- end box -->


<p>
Note that <code>Newton_failure.m</code> calls the function <code>plot_line</code> (located in <code>plot_line.m</code>),
reading:

<p>

<!-- begin box -->
<div style="width: 95%; padding: 10px; border: 1px solid #000; border-radius: 4px;">
Here is a missing file: plot_line
</div>
<!-- end box -->


<p>
(The function <code>plot_line</code> is placed as a separate m-file so that it may be used also
by the function <code>secant_failure</code>, which is to be written in another exercise.)

<p>
Running the program with <code>x</code> set to \( 1.08 \) produces a series of plots (and prints) showing
the graph and the tangent for the present value of <code>x</code>. There are quite many
plots, so we do not show them here. However, the tangent line &quot;jumps&quot; around
a few times before it settles. In the final plot the tangent line goes through
the solution at \( x = 0 \). The final printout brings the information:

<p>

<!-- code=text (!bc dat) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">Number of function calls: 13
A solution is: 0.000024
</pre></div>
<p>
When we run the program anew, this time with <code>x</code> set to \( 1.09 \), we get another series of
plots (and prints), but this time the tangent moves away from the (known) solution.
The final printout we get states that:

<p>

<!-- code=text (!bc dat) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">Number of function calls: 19
A solution is: nan
</pre></div>
<p>
Here, <code>nan</code> stands for "not a number", meaning that we got no solution value for <code>x</code>.
That is, Newton's method diverged.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>Newton_failure.*</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="4th:exer:Secant:failure">Exercise 73: See if the secant method fails</h2>

<p>
Does the secant method behave better than Newton's method in
the problem described in <a href="#4th:exer:Newton:failure">Exercise 72: Understand why Newton's method can fail</a>?
Try the initial guesses

<ol>
<li> \( x_0=1.08 \) and \( x_1=1.09 \)</li>
<li> \( x_0=1.09 \) and \( x_1=1.1 \)</li>
<li> \( x_0=1 \) and \( x_1=2.3 \)</li>
<li> \( x_0=1 \) and \( x_1=2.4 \)</li>
</ol>

<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_73_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_73_1">

<p>
The program may be written as:

<p>

<!-- begin box -->
<div style="width: 95%; padding: 10px; border: 1px solid #000; border-radius: 4px;">
Here is a missing file: secant_failure
</div>
<!-- end box -->


<p>
which may be called from the script <code>use_my_secant_failure.m</code>:

<p>

<!-- begin box -->
<div style="width: 95%; padding: 10px; border: 1px solid #000; border-radius: 4px;">
Here is a missing file: use_my_secant_failure
</div>
<!-- end box -->


<p>
Note that, as with <code>Newton_failure.m</code>, the script <code>plot_line.m</code> is called for
plotting each tangent.

<p>
The script converges with the three first-mentioned alternatives for \( x_0 \) and \( x_1 \).
With the final set of parameter values, the method diverges with a printout:

<p>

<!-- code=text (!bc dat) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">Error! - denominator zero for x = 360.600893792
</pre></div>
<p>
and a few more lines stating that an exception error has occurred.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>secant_failure.*</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="4th:exer:Bisection:failure">Exercise 74: Understand how the bisection method cannot fail</h2>

<p>
Solve the same problem as in <a href="#4th:exer:Newton:failure">Exercise 72: Understand why Newton's method can fail</a>,
using the bisection method, but let the initial interval be
\( [-5,3] \). Report how the interval containing the solution evolves
during the iterations.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_74_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_74_1">

<p>
The code may be written as:

<p>

<!-- begin box -->
<div style="width: 95%; padding: 10px; border: 1px solid #000; border-radius: 4px;">
Here is a missing file: bisection_nonfailure
</div>
<!-- end box -->


<p>
which may be called from the script <code>use_my_bisection_nonfailure.m</code>:

<p>

<!-- begin box -->
<div style="width: 95%; padding: 10px; border: 1px solid #000; border-radius: 4px;">
Here is a missing file: use_my_bisection_nonfailure
</div>
<!-- end box -->


<p>
Running the program produces the following printout:

<p>

<!-- code=text (!bc dat) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">interval: [-1.000000, 3.000000]
interval: [-1.000000, 1.000000]
Number of function calls: 7
A solution is: 0.000000
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>bisection_nonfailure.*</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="4th:exer:Bisection:Newton">Exercise 75: Combine the bisection method with Newton's method</h2>

<p>
<!-- solution=`sol_bisection_Newton.pdf` -->

<p>
An attractive idea is to combine the reliability of the bisection method
with the speed of Newton's method, even if the potential divergence with
Newton's method then still is an issue. Such a combination is implemented
by running the bisection method until we have a narrow interval, and then switch
to Newton's method for speed.

<p>
Write a function that implements this idea.
Start with an interval \( [a,b] \) and switch to Newton's method when
the current interval in the bisection method is a fraction \( s \)
of the initial interval (i.e., when the interval has length \( s(b-a) \)).
The value of \( s \) must be given as an argument to the function, but
it may have a default value of 0.1.

<p>
Try the new method on \( \tanh(x)=0 \) with an initial interval \( [-10,15] \).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_75_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_75_1">

<p>
The code may be written as:

<p>

<!-- begin box -->
<div style="width: 95%; padding: 10px; border: 1px solid #000; border-radius: 4px;">
Here is a missing file: bisection_Newton
</div>
<!-- end box -->


<p>
which may be called from the script <code>use_my_bisection_Newton.m</code>:

<p>

<!-- begin box -->
<div style="width: 95%; padding: 10px; border: 1px solid #000; border-radius: 4px;">
Here is a missing file: use_my_bisection_Newton
</div>
<!-- end box -->


<p>
Running the program produces the following printout:

<p>

<!-- code=text (!bc dat) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">A solution x = 0.000000 was reached in 7 iterations
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>bisection_Newton.m</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="4th:exer:NewtonHand">Exercise 76: Write a test function for Newton's method</h2>

<p>
The purpose of this function is to verify the implementation of Newton's
method in the <code>Newton</code> function in the file <code>nonlinear_solvers.py</code>.
Construct an algebraic equation and perform two iterations of Newton's
method by
hand.
Find the corresponding size of \( |f(x)| \) and use this
as value for <code>eps</code> when calling <code>Newton</code>. The function should then
also perform two iterations and return the same approximation to
the root as you calculated manually. Implement this idea for a unit test
as a test function <code>test_Newton()</code>.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_76_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_76_1">

<p>
Here is the complete module with the test function.

<p>

<!-- begin box -->
<div style="width: 95%; padding: 10px; border: 1px solid #000; border-radius: 4px;">
Here is a missing file: test_Newton
</div>
<!-- end box -->


<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>test_Newton.m</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="4th:exer:beam:vib">Exercise 77: Solve nonlinear equation for a vibrating beam</h2>

<p>
An important engineering problem that arises in a lot of applications
is the vibrations of a clamped beam where the other end is free.
This problem can be analyzed
analytically, but the calculations boil down to solving the
following nonlinear algebraic equation:

$$ \cosh\beta \cos\beta = -1,$$

where \( \beta \) is related to important beam parameters through

$$ \beta^4 = \omega^2 \frac{\varrho A}{EI},$$

where \( \varrho \) is the density of the beam, \( A \) is the area of
the cross section, \( E \) is Young's modulus,
and \( I \) is the moment of the inertia of the cross section. The most
important parameter of interest is \( \omega \), which is the frequency
of the beam. We want to compute the frequencies of a
vibrating steel beam with a rectangular cross section having
width \( b=25 \) mm and height \( h=8 \) mm.
The density of steel is \( 7850 \mbox{ kg/m}^3 \),
and \( E= 2\cdot 10^{11} \) Pa. The moment of inertia of a rectangular cross section
is \( I=bh^3/12 \).

<p>
<b>a)</b>
Plot the equation to be solved so that one can inspect where the zero
crossings occur.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_77_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_77_1">

<p>
When writing the equation as \( f(\beta)=0 \), the \( f \) function increases
its amplitude dramatically with \( \beta \). It is therefore wise to
look at an equation with damped amplitude, \( g(\beta) = e^{-\beta}f(\beta) = 0 \).
Plot \( g \) instead.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_77_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_77_2">

<p>
<center><p><img src="figs/beam_vib_expmxf.png" align="bottom" width=600></p></center>

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>b)</b>
Compute the first three frequencies.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_77_3" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_77_3">

<p>
Here is a complete program, using the Bisection method for root
finding, based on intervals found from the plot above.

<p>

<!-- code=matlab (!bc mpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">beam_vib</span>()<span style="color: #bbbbbb"></span>

<span style="color: #bbbbbb">    </span>plot_f()

    f_handle = @f;
    <span style="color: #408080; font-style: italic">% Set up suitable intervals</span>
    intervals = [<span style="color: #666666">1</span> <span style="color: #666666">3</span>; <span style="color: #666666">4</span> <span style="color: #666666">6</span>; <span style="color: #666666">7</span> <span style="color: #666666">9</span>];
    betas = [];  <span style="color: #408080; font-style: italic">% roots</span>
    <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = <span style="color: #666666">1</span>:<span style="color: #008000">length</span>(intervals) 
        beta_L = intervals(<span style="color: #008000">i</span>, <span style="color: #666666">1</span>);  beta_R = intervals(<span style="color: #008000">i</span>, <span style="color: #666666">2</span>);
        [<span style="color: #008000">beta</span>, it] = bisection(f_handle, beta_L, beta_R, <span style="color: #008000">eps</span>=<span style="color: #666666">1E-6</span>);
        betas = [betas <span style="color: #008000">beta</span>];
        f(<span style="color: #008000">beta</span>)   
    <span style="color: #008000; font-weight: bold">end</span>
    betas

    <span style="color: #408080; font-style: italic">% Find corresponding frequencies</span>

<span style="color: #008000; font-weight: bold">    function</span><span style="color: #bbbbbb"> </span>value =<span style="color: #bbbbbb"> </span><span style="color: #0000FF">omega</span>(beta, rho, A, E, I)<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">        </span>value = <span style="color: #008000">sqrt</span>(<span style="color: #008000">beta</span>^<span style="color: #666666">4/</span>(rho<span style="color: #666666">*</span>A<span style="color: #666666">/</span>(E<span style="color: #666666">*</span>I)));
    <span style="color: #008000; font-weight: bold">end</span>

    rho = <span style="color: #666666">7850</span>;  <span style="color: #408080; font-style: italic">% kg/m^3</span>
    E = <span style="color: #666666">1.0E+11</span>; <span style="color: #408080; font-style: italic">% Pa</span>
    b = <span style="color: #666666">0.025</span>;   <span style="color: #408080; font-style: italic">% m</span>
    h = <span style="color: #666666">0.008</span>;   <span style="color: #408080; font-style: italic">% m</span>
    A = b<span style="color: #666666">*</span>h;
    I = b<span style="color: #666666">*</span>h^<span style="color: #666666">3/12</span>;

    <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = <span style="color: #666666">1</span>:<span style="color: #008000">length</span>(betas)
        omega(betas(<span style="color: #008000">i</span>), rho, A, E, I)
    <span style="color: #008000; font-weight: bold">end</span>

<span style="color: #008000; font-weight: bold">end</span>

<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span>value =<span style="color: #bbbbbb"> </span><span style="color: #0000FF">f</span>(beta)<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>value = <span style="color: #008000">cosh</span>(<span style="color: #008000">beta</span>)<span style="color: #666666">.*</span><span style="color: #008000">cos</span>(<span style="color: #008000">beta</span>) <span style="color: #666666">+</span> <span style="color: #666666">1</span>;
<span style="color: #008000; font-weight: bold">end</span>

<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span>value =<span style="color: #bbbbbb"> </span><span style="color: #0000FF">damped</span>(beta)<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span><span style="color: #408080; font-style: italic">% Damp the amplitude of f. It grows like cosh, i.e. exp.</span>
    value = <span style="color: #008000">exp</span>(<span style="color: #666666">-</span><span style="color: #008000">beta</span>)<span style="color: #666666">.*</span>f(<span style="color: #008000">beta</span>);
<span style="color: #008000; font-weight: bold">end</span>

<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">plot_f</span>()<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span><span style="color: #008000">beta</span> = <span style="color: #008000">linspace</span>(<span style="color: #666666">0</span>, <span style="color: #666666">20</span>, <span style="color: #666666">501</span>);
    <span style="color: #408080; font-style: italic">%y = f(x)</span>
    y = damped(<span style="color: #008000">beta</span>);
    plot(<span style="color: #008000">beta</span>, y, <span style="color: #BA2121">&#39;r&#39;</span>, [<span style="color: #008000">beta</span>(<span style="color: #666666">1</span>), <span style="color: #008000">beta</span>(<span style="color: #008000">length</span>(<span style="color: #008000">beta</span>))], [<span style="color: #666666">1</span>, <span style="color: #666666">1</span>], <span style="color: #BA2121">&#39;b--&#39;</span>)
    grid(<span style="color: #BA2121">&#39;on&#39;</span>);
    xlabel(<span style="color: #BA2121">&#39;beta&#39;</span>);
    ylabel(<span style="color: #BA2121">&#39;exp(-beta) (cosh(beta) cos(beta) +1)&#39;</span>)
    savefig(<span style="color: #BA2121">&#39;tmp1.png&#39;</span>); savefig(<span style="color: #BA2121">&#39;tmp1.pdf&#39;</span>)
<span style="color: #008000; font-weight: bold">end</span>
</pre></div>
<p>
The output of \( \beta \) reads \( 1.875 \), \( 4.494 \), \( 7.855 \), and corresponding
\( \omega \) values are \( 29 \), \( 182 \), and \( 509 \) Hz.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
Filename: <code>beam_vib.m</code>.

<p>
<!-- --- end exercise --- -->

<p>
<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">
  <li class="previous">
    <a href="._p4c-bootstrap-Matlab027.html">&larr; Prev</a>
  </li>
  <li class="next">
    <a href="._p4c-bootstrap-Matlab029.html">Next &rarr;</a>
  </li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


</body>
</html>
    

