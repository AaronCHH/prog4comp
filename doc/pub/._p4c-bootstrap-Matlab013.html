<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Programming for Computations - A Gentle Introduction to Numerical Simulations with MATLAB/Octave">
<meta name="keywords" content="DocOnce,computer program,programming,language programming,language computer,MATLAB,Octave,Fortran,C,C++,Python,Maple,Mathematica,syntax,bug,debugging,script (and scripting),algorithm,execute (a program),implement (a program),bug,debugging,simulation,model mathematical,print,program run,program execute,code,comment,instruction,program statement,variable,assignment,semi-colon (easy print),calculator,text editor,Emacs,Vim,Gedit,Notepad++,TextWrangler,prompt,program typing,program run,program execute,m-file,function,function call,atan,function input parameter,function output parameter,function return,function take a parameter,plot,linspace,xlabel,ylabel,plot,array,interactive use (of Matlab),keyboard arrow up/down,prompt,operator Arithmetic,parentheses,rounding error,variable type,variable name,float,integer,string,type conversion,reserved words,variable integer,variable float,variable string,variable assignment,default,single (precision),double (precision),printing formatted,printf formatting,default,array,array element,zeros,allocate,array index,indexing zero based,indexing one based,Matlab one-based indexing,array slice of,copy,graph,hold (on/off),plot figure,title (plot),legend (plot),axis (plot),hardcopy (plot),format png,matrix vector product,linear algebra,matrix,vector,error message,debugging,debugger,try-catch,exception handling,program crash,program testing,testing,program verification,verification,validation,program input,program output,input,symbolic computations,symbolic operations,symbolic simplifications,Symbolic Toolbox,WolframAlpha,Mathematica,Sage (symbolic package),variable delete,Matlab documentation,Matlab licence,long lines (splitting of),fast code,Matlab indent,commenting code,if,elseif,else,end,boolean,boolean expression,true (1),false (0),boolean true (1),boolean false (0),pseudo code,random walk,rand (function),operator Logical,function,function definition,return,argument,parameter input,parameter output,main program,return value,function nargin,function nargout,variable local,variable global,doc string,function handle,function local,function global,function nested,anonymous function,function anonymous,loop for,for loop,loop iteration,loop index,loop double,loop multiple,loop nested,linear algebra,while loop,loop while,loop infinite,loop iteration,loop index,stop program (Ctrl+c),read (from file),write (to file),array sorting,Leibniz pi,Euler pi,programming game,linear interpolation,least squares method,Fourier series,integral analytically,integral exact,integral numerically,integral approximately,Trapezoidal rule,composite trapezoidal rule,integration points,implementation specific,implementation general,code re-use,flat program,program flat,error function (erf),Midpoint method,composite midpoint method,Simpson's rule,Gauss quadrature,bug,unit tests,testing procedures,convergence rate,rate of convergence,error asymptotic,finite precision (of float),floating point number (float),error rounding,error tolerance,difference absolute,difference relative,assert (function),function assert,test function,vectorization,computational speed (measuring),domain,double integral midpoint,double sum,code re-use,triple integral midpoint,domain,domain complex,domain,Monte Carlo integration,seed (random generators),dynamical system,scheme,differential equation first-order,model mathematical,model differential equation,model computational,exp math notation,finite difference method,mesh,mesh uniform,mesh points,forward difference approximation,difference forward,Forward Euler scheme,Euler's method,numerical scheme,demo function,logistic model carrying capacity,SIR model,compartment model,mathematical modeling,scalar ODE,ODE scalar,vector ODE,ODE vector,system of ODEs,discontinuous coefficient,spring oscillations,spring damping of,differential equation second-order,simple pendulum,second-order ODE rewritten as two first-order ODEs,difference forward,difference backward,Heun's method,Runge-Kutta, 2nd-order method,2nd-order Runge-Kutta method,RK2,difference centered,nonlinear algebraic equation,ode45,ode23s,Runge-Kutta-Fehlberg,Crank-Nicolson method,spring damping of,spring nonlinear,spring linear,scaling,resonance,Verlet integration,Crank-Nicolson method,Taylor series,PDE,heat equation,diffusion equation,source term,domain,initial conditions,boundary conditions,MOL forward Euler,method of lines,MOL,mesh points,cell,method of lines,unstable solutions,instability,stability criterion,scaling,vectorization,tridiagonal matrix,matrix tridiagonal,theta rule,Poisson equation,Laplace equation,root finding,brute force method,code robust,divergence,code exception,code try-catch,Newton starting value,return None,rate of convergence">

<title>Programming for Computations - A Gentle Introduction to Numerical Simulations with MATLAB/Octave</title>

<!-- Bootstrap style: bootswatch_journal -->
<link href="http://netdna.bootstrapcdn.com/bootswatch/3.1.1/journal/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }
/* Let pre tags for code blocks have the same color as the surroundings */
pre { color: inherit; background-color: transparent; }

/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}
</style>


</head>

<!-- tocinfo
{'highest level': 0,
 'sections': [(u'Preface', 0, None, '___sec0'),
              (u'Why learn programming?', 3, None, '___sec1'),
              (u'Target audience and background knowledge',
               3,
               None,
               '___sec2'),
              (u'Numerical methods', 3, None, '___sec3'),
              (u'The computer language: Matlab', 3, None, '___sec4'),
              (u'How this book is different', 3, None, '___sec5'),
              (u'Supplementary materials', 3, None, '___sec6'),
              (u'Acknowledgments', 3, None, '___sec7'),
              (u'The first few steps',
               0,
               u'1st:TheFirstFewSteps',
               u'1st:TheFirstFewSteps'),
              (u'What is a program? And what is programming?',
               1,
               None,
               '___sec9'),
              (u'A Matlab program with variables', 1, u'1st:ex1', u'1st:ex1'),
              (u'The program', 2, None, '___sec11'),
              (u'Dissection of the program', 2, None, '___sec12'),
              (u'Why not just use a pocket calculator?', 2, None, '___sec13'),
              (u'Why you must use a text editor to write programs',
               2,
               None,
               '___sec14'),
              (u'Write and run your first program', 2, None, '___sec15'),
              (u'Write and run a program in Matlab', 3, None, '___sec16'),
              (u'Write a program in a text editor and run it in Octave',
               3,
               None,
               '___sec17'),
              (u'A Matlab program with a library function',
               1,
               u'1st:ex2',
               u'1st:ex2'),
              (u'A Matlab program with vectorization and plotting',
               1,
               u'1st:ex3',
               u'1st:ex3'),
              (u'More basic concepts', 1, None, '___sec20'),
              (u'Using Matlab interactively', 2, None, '___sec21'),
              (u'Arithmetics, parentheses and rounding errors',
               2,
               None,
               '___sec22'),
              (u'Variables', 2, None, '___sec23'),
              (u'Formatting text and numbers', 2, None, '___sec24'),
              (u'Arrays', 2, None, '___sec25'),
              (u'Plotting', 2, None, '___sec26'),
              (u'Error messages and warnings', 2, None, '___sec27'),
              (u'Input data', 2, None, '___sec28'),
              (u'Symbolic computations', 2, None, '___sec29'),
              (u'Concluding remarks', 2, None, '___sec30'),
              (u'Exercises', 1, None, '___sec31'),
              (u'Exercise 1: Error messages',
               2,
               u'1st:exer:ErrorMessages',
               u'1st:exer:ErrorMessages'),
              (u'Exercise 2: Volume of a cube',
               2,
               u'1st:exer:cubeVolume',
               u'1st:exer:cubeVolume'),
              (u'Exercise 3: Area and circumference of a circle',
               2,
               u'1st:exer:areaCircle',
               u'1st:exer:areaCircle'),
              (u'Exercise 4: Volumes of three cubes',
               2,
               u'1st:exer:volumes3cubes',
               u'1st:exer:volumes3cubes'),
              (u'Exercise 5: Average of integers',
               2,
               u'1st:exer:averageOf5Integers',
               u'1st:exer:averageOf5Integers'),
              (u'Exercise 6: Interactive computing of volume and area',
               2,
               u'1st:exer:cubeVolInteractively',
               u'1st:exer:cubeVolInteractively'),
              (u'Exercise 7: Update variable at command prompt',
               2,
               u'1st:exer:updateVarInteractively',
               u'1st:exer:updateVarInteractively'),
              (u'Exercise 8: Formatted print to screen',
               2,
               u'1st:exer:printfScreen',
               u'1st:exer:printfScreen'),
              (u'Exercise 9: Matlab documentation and random numbers',
               2,
               u'1st:exer:PythonDocRandom',
               u'1st:exer:PythonDocRandom'),
              (u'Basic constructions',
               0,
               u'2nd:BasicConstructins',
               u'2nd:BasicConstructins'),
              (u'If tests', 1, None, '___sec42'),
              (u'Functions', 1, u'sec:functions', u'sec:functions'),
              (u'For loops', 1, u'sec:for:loops', u'sec:for:loops'),
              (u'While loops', 1, u'sec:while:loops', u'sec:while:loops'),
              (u'Reading from and writing to files',
               1,
               u'sec:file:reading:writing',
               u'sec:file:reading:writing'),
              (u'Exercises', 1, None, '___sec47'),
              (u'Exercise 10: Introducing errors',
               2,
               u'2nd:exer:IntroducingErrors',
               u'2nd:exer:IntroducingErrors'),
              (u'Exercise 11: Compare integers a and b',
               2,
               u'2nd:exer:compInt',
               u'2nd:exer:compInt'),
              (u'Exercise 12: Functions for circumference and area of a circle',
               2,
               u'2nd:exer:funcCircArea',
               u'2nd:exer:funcCircArea'),
              (u'Exercise 13: Function for area of a rectangle',
               2,
               u'2nd:exer:funcAreaRectangle',
               u'2nd:exer:funcAreaRectangle'),
              (u'Exercise 14: Area of a polygon',
               2,
               u'2nd:exer:area:polygon',
               u'2nd:exer:area:polygon'),
              (u'Exercise 15: Average of integers',
               2,
               u'2nd:exer:avNInt',
               u'2nd:exer:avNInt'),
              (u'Exercise 16: While loop with errors',
               2,
               u'2nd:exer:whileLoopErrors',
               u'2nd:exer:whileLoopErrors'),
              (u'Exercise 17: Area of rectangle versus circle',
               2,
               u'2nd:exer:areaRectCircle',
               u'2nd:exer:areaRectCircle'),
              (u'Exercise 18: Find crossing points of two graphs',
               2,
               u'2nd:exer:Cross2Graphs',
               u'2nd:exer:Cross2Graphs'),
              (u'Exercise 19: Sort array with numbers',
               2,
               u'2nd:exer:sortNumbers',
               u'2nd:exer:sortNumbers'),
              (u'Exercise 20: Compute $\\pi$',
               2,
               u'2nd:exer:computingPi',
               u'2nd:exer:computingPi'),
              (u'Exercise 21: Compute combinations of sets',
               2,
               u'2nd:exer:combinatorics1',
               u'2nd:exer:combinatorics1'),
              (u'Exercise 22: Frequency of random numbers',
               2,
               u'2nd:exer:numberOccurrence',
               u'2nd:exer:numberOccurrence'),
              (u'Remarks', 3, None, '___sec61'),
              (u'Exercise 23: Game 21',
               2,
               u'2nd:exer:Game21',
               u'2nd:exer:Game21'),
              (u'Exercise 24: Linear interpolation',
               2,
               u'2nd:exer:linearInterpol',
               u'2nd:exer:linearInterpol'),
              (u'Exercise 25: Test straight line requirement',
               2,
               u'2nd:exer:testStraightLine',
               u'2nd:exer:testStraightLine'),
              (u'Exercise 26: Fit straight line to data',
               2,
               u'2nd:exer:fitLine',
               u'2nd:exer:fitLine'),
              (u'Remarks', 3, None, '___sec66'),
              (u'Exercise 27: Fit sines to straight line',
               2,
               u'2nd:exer:fitSines',
               u'2nd:exer:fitSines'),
              (u'Remarks', 3, None, '___sec68'),
              (u'Exercise 28: Count occurrences of a string in a string',
               2,
               u'2nd:exer:countTextString',
               u'2nd:exer:countTextString'),
              (u'Computing integrals', 0, u'sec:integrals', u'sec:integrals'),
              (u'Basic ideas of numerical integration',
               1,
               u'sec:integrals:basic',
               u'sec:integrals:basic'),
              (u'Computational example', 3, None, '___sec72'),
              (u'The composite trapezoidal rule',
               1,
               u'sec:integrals:trap',
               u'sec:integrals:trap'),
              (u'The general formula',
               2,
               u'sec:integrals:formula',
               u'sec:integrals:formula'),
              (u'Implementation',
               2,
               u'sec:integrals:trap:impl',
               u'sec:integrals:trap:impl'),
              (u'Specific or general implementation?', 3, None, '___sec76'),
              (u'Implementation with functions', 3, None, '___sec77'),
              (u'Solving our specific problem in a session',
               3,
               None,
               '___sec78'),
              (u'Solving our specific problem in a program',
               3,
               None,
               '___sec79'),
              (u'Alternative flat special-purpose implementation',
               2,
               None,
               '___sec80'),
              (u'The composite midpoint method',
               1,
               u'sec:integrals:Midpoint',
               u'sec:integrals:Midpoint'),
              (u'The idea', 3, None, '___sec82'),
              (u'The general formula', 2, None, '___sec83'),
              (u'Implementation',
               2,
               u'sec:midpoint:code',
               u'sec:midpoint:code'),
              (u'Comparing the trapezoidal and the midpoint methods',
               2,
               None,
               '___sec85'),
              (u'Testing', 1, None, '___sec86'),
              (u'Problems with brief testing procedures',
               2,
               None,
               '___sec87'),
              (u'Proper test procedures',
               2,
               u'sec:integrals:testprocs',
               u'sec:integrals:testprocs'),
              (u'Hand-computed results', 3, None, '___sec89'),
              (u'Solving a problem without numerical errors',
               3,
               None,
               '___sec90'),
              (u'Demonstrating correct convergence rates',
               3,
               None,
               '___sec91'),
              (u'Finite precision of floating-point numbers',
               2,
               u'sec:integrals:finite_prec',
               u'sec:integrals:finite_prec'),
              (u'Constructing unit tests and writing test functions',
               2,
               u'sec:integrals:test:functions',
               u'sec:integrals:test:functions'),
              (u'Hand-computed numerical results', 3, None, '___sec94'),
              (u'Solving a problem without numerical errors',
               3,
               None,
               '___sec95'),
              (u'Demonstrating correct convergence rates',
               3,
               None,
               '___sec96'),
              (u'Vectorization', 1, None, '___sec97'),
              (u'Vectorizing the midpoint rule', 3, None, '___sec98'),
              (u'Vectorizing the trapezoidal rule', 3, None, '___sec99'),
              (u'Measuring computational speed', 1, None, '___sec100'),
              (u'Double and triple integrals',
               1,
               u'sec:int:double',
               u'sec:int:double'),
              (u'The midpoint rule for a double integral',
               2,
               u'sec:int:double:midpoint',
               u'sec:int:double:midpoint'),
              (u'Derivation via one-dimensional integrals',
               3,
               None,
               '___sec103'),
              (u'Direct derivation', 3, None, '___sec104'),
              (u'Programming a double sum', 3, None, '___sec105'),
              (u'Reusing code for one-dimensional integrals',
               3,
               None,
               '___sec106'),
              (u'Verification via test functions', 3, None, '___sec107'),
              (u'The midpoint rule for a triple integral',
               2,
               None,
               '___sec108'),
              (u'Theory', 3, None, '___sec109'),
              (u'Implementation', 3, None, '___sec110'),
              (u'Monte Carlo integration for complex-shaped domains',
               2,
               u'sec:int:complex:domain',
               u'sec:int:complex:domain'),
              (u'The Monte Carlo integration algorithm',
               3,
               None,
               '___sec112'),
              (u'Implementation', 3, None, '___sec113'),
              (u'Verification', 3, None, '___sec114'),
              (u'Test function for function with random numbers',
               3,
               None,
               '___sec115'),
              (u'Integral over a circle', 3, None, '___sec116'),
              (u'Exercises', 1, None, '___sec117'),
              (u'Exercise 29: Hand calculations for the trapezoidal method',
               2,
               u'sec:exer:trap:hand',
               u'sec:exer:trap:hand'),
              (u'Exercise 30: Hand calculations for the midpoint method',
               2,
               u'sec:exer:midpt:hand',
               u'sec:exer:midpt:hand'),
              (u'Exercise 31: Compute a simple integral',
               2,
               u'sec:exer:trap:mid:parabola',
               u'sec:exer:trap:mid:parabola'),
              (u'Exercise 32: Hand-calculations with sine integrals',
               2,
               u'sec:exer:hand:sine',
               u'sec:exer:hand:sine'),
              (u'Exercise 33: Make test functions for the midpoint method',
               2,
               u'sec:exer:test:midpoint',
               u'sec:exer:test:midpoint'),
              (u'Exercise 34: Explore rounding errors with large numbers',
               2,
               u'sec:exer:test:roundoff',
               u'sec:exer:test:roundoff'),
              (u'Exercise 35: Write test functions for $\\int_0^4\\sqrt{x}dx$',
               2,
               u'sec:exer:test:convrates:sqrt',
               u'sec:exer:test:convrates:sqrt'),
              (u'Remarks', 3, None, '___sec125'),
              (u'Exercise 36: Rectangle methods',
               2,
               u'sec:exer:rectangleMethod',
               u'sec:exer:rectangleMethod'),
              (u'Exercise 37: Adaptive integration',
               2,
               u'sec:exer:adaptive:int',
               u'sec:exer:adaptive:int'),
              (u'Remarks', 3, None, '___sec128'),
              (u'Exercise 38: Integrating x raised to x',
               2,
               u'sec:exer:integrate:x2x',
               u'sec:exer:integrate:x2x'),
              (u'Exercise 39: Integrate products of sine functions',
               2,
               u'sec:exer:sine:products',
               u'sec:exer:sine:products'),
              (u'Exercise 40: Revisit fit of sines to a function',
               2,
               u'sec:exer:revisitFitSines',
               u'sec:exer:revisitFitSines'),
              (u'Exercise 41: Derive the trapezoidal rule for a double integral',
               2,
               u'sec:exer:trapezoidal:2D',
               u'sec:exer:trapezoidal:2D'),
              (u'Exercise 42: Compute the area of a triangle by Monte Carlo integration',
               2,
               u'sec:exer:MC:ellipse',
               u'sec:exer:MC:ellipse'),
              (u'Solving ordinary differential equations',
               0,
               u'5th:SolvODEs',
               u'5th:SolvODEs'),
              (u'Population growth', 1, u'sec:de:pg', u'sec:de:pg'),
              (u'Derivation of the model',
               2,
               u'sec:de:pg:model',
               u'sec:de:pg:model'),
              (u'Numerical solution',
               2,
               u'sec:de:pg:numerics',
               u'sec:de:pg:numerics'),
              (u'Programming the Forward Euler scheme; the special case',
               2,
               u'sec:de:pg:prog1',
               u'sec:de:pg:prog1'),
              (u'Understanding the Forward Euler method',
               2,
               u'sec:de:pg:geom',
               u'sec:de:pg:geom'),
              (u'Programming the Forward Euler scheme; the general case',
               2,
               u'sec:de:FE:gen',
               u'sec:de:FE:gen'),
              (u'Making the population growth model more realistic',
               2,
               None,
               '___sec141'),
              (u'Verification: exact linear solution of the discrete equations',
               2,
               u'sec:de:growth:test:linear',
               u'sec:de:growth:test:linear'),
              (u'Spreading of diseases', 1, None, '___sec143'),
              (u'Spreading of a flu', 2, u'sec:de:flu', u'sec:de:flu'),
              (u'A Forward Euler method for the differential equation system',
               2,
               u'sec:de:flu:FE',
               u'sec:de:flu:FE'),
              (u'Programming the numerical method; the special case',
               2,
               u'sec:de:flu:prog:spec',
               u'sec:de:flu:prog:spec'),
              (u'Outbreak or not', 2, None, '___sec147'),
              (u'Abstract problem and notation',
               2,
               u'sec:de:flu:generic',
               u'sec:de:flu:generic'),
              (u'Programming the numerical method; the general case',
               2,
               u'sec:de:flu:prog:generic',
               u'sec:de:flu:prog:generic'),
              (u'Time-restricted immunity', 2, None, '___sec150'),
              (u'Incorporating vaccination',
               2,
               u'sec:de:flu:vaccine',
               u'sec:de:flu:vaccine'),
              (u'Discontinuous coefficients: a vaccination campaign',
               2,
               u'sec:de:flu:vaccine:discont',
               u'sec:de:flu:vaccine:discont'),
              (u'Oscillating one-dimensional systems',
               1,
               u'sec:de:vib',
               u'sec:de:vib'),
              (u'Derivation of a simple model', 2, None, '___sec154'),
              (u'Numerical solution', 2, None, '___sec155'),
              (u'Programming the numerical method; the special case',
               2,
               u'sec:de:vib:special',
               u'sec:de:vib:special'),
              (u'A magic fix of the numerical method', 2, None, '___sec157'),
              (u"The 2nd-order Runge-Kutta method (or Heun's method)",
               2,
               u'sec:de:osc:Heun',
               u'sec:de:osc:Heun'),
              (u'Software for solving ODEs',
               2,
               u'sec:de:osc:odespy',
               u'sec:de:osc:odespy'),
              (u'The 4th-order Runge-Kutta method', 2, None, '___sec160'),
              (u'The algorithm', 3, None, '___sec161'),
              (u'Application', 3, None, '___sec162'),
              (u'Implementation', 3, None, '___sec163'),
              (u'Derivation', 3, None, '___sec164'),
              (u'More effects: damping, nonlinearity, and external forces',
               2,
               None,
               '___sec165'),
              (u'The Euler-Cromer scheme', 3, None, '___sec166'),
              (u'The 4-th order Runge-Kutta method', 3, None, '___sec167'),
              (u'Illustration of linear damping', 2, None, '___sec168'),
              (u'Illustration of linear damping with sinusoidal excitation',
               2,
               None,
               '___sec169'),
              (u'Spring-mass system with sliding friction',
               2,
               u'sec:de:vib:ode2:sliding:friction',
               u'sec:de:vib:ode2:sliding:friction'),
              (u'A finite difference method; undamped, linear case',
               2,
               u'sec:de:vib:2nd',
               u'sec:de:vib:2nd'),
              (u'A finite difference method; linear damping',
               2,
               u'sec:de:vib:2nd:damped1',
               u'sec:de:vib:2nd:damped1'),
              (u'Exercises', 1, None, '___sec173'),
              (u'Exercise 43: Geometric construction of the Forward Euler method',
               2,
               u'sec:de:exer:geom',
               u'sec:de:exer:geom'),
              (u'Exercise 44: Make test functions for the Forward Euler method',
               2,
               u'sec:de:exer:FE:test1',
               u'sec:de:exer:FE:test1'),
              (u"Exercise 45: Implement and evaluate Heun's method",
               2,
               u'sec:de:exer:Heun:pg',
               u'sec:de:exer:Heun:pg'),
              (u'Exercise 46: Find an appropriate time step; logistic model',
               2,
               u'sec:de:exer:logistic:dtopt',
               u'sec:de:exer:logistic:dtopt'),
              (u'Exercise 47: Find an appropriate time step; SIR model',
               2,
               u'sec:de:exer:SIR:dtopt',
               u'sec:de:exer:SIR:dtopt'),
              (u'Exercise 48: Model an adaptive vaccination campaign',
               2,
               u'sec:de:exer:SIRV:padapt',
               u'sec:de:exer:SIRV:padapt'),
              (u'Exercise 49: Make a SIRV model with time-limited effect of vaccination',
               2,
               u'sec:de:exer:SIRV:padapt_time_limited',
               u'sec:de:exer:SIRV:padapt_time_limited'),
              (u'Exercise 50: Refactor a flat program',
               2,
               u'sec:de:exer:vib:FE:func',
               u'sec:de:exer:vib:FE:func'),
              (u'Exercise 51: Simulate oscillations by a general ODE solver',
               2,
               u'sec:de:exer:vib:ode_FE',
               u'sec:de:exer:vib:ode_FE'),
              (u'Exercise 52: Compute the energy in oscillations',
               2,
               u'sec:de:exer:vib:energy',
               u'sec:de:exer:vib:energy'),
              (u'Exercise 53: Use a Backward Euler scheme for population growth',
               2,
               u'sec:de:exer:pg:BE',
               u'sec:de:exer:pg:BE'),
              (u'Exercise 54: Use a Crank-Nicolson scheme for population growth',
               2,
               u'sec:de:exer:pg:CN',
               u'sec:de:exer:pg:CN'),
              (u'Exercise 55: Understand finite differences via Taylor series',
               2,
               u'sec:de:exer:fd:Taylor',
               u'sec:de:exer:fd:Taylor'),
              (u'Exercise 56: Use a Backward Euler scheme for oscillations',
               2,
               u'sec:de:exer:vib:BE',
               u'sec:de:exer:vib:BE'),
              (u'Remarks', 3, None, '___sec188'),
              (u"Exercise 57: Use Heun's method for the SIR model",
               2,
               u'sec:de:exer:SIR:Heun',
               u'sec:de:exer:SIR:Heun'),
              (u'Exercise 58: Use Odespy to solve a simple ODE',
               2,
               u'sec:de:exer:odespy:decay',
               u'sec:de:exer:odespy:decay'),
              (u'Exercise 59: Set up a Backward Euler scheme for oscillations',
               2,
               u'sec:de:exer:osc:BE',
               u'sec:de:exer:osc:BE'),
              (u'Exercise 60: Set up a Forward Euler scheme for nonlinear and damped oscillations',
               2,
               u'sec:de:exer:osc:FE:general',
               u'sec:de:exer:osc:FE:general'),
              (u'Exercise 61: Discretize an initial condition',
               2,
               u'sec:de:exer:osc:2nd:V0ic',
               u'sec:de:exer:osc:2nd:V0ic'),
              (u'Solving partial differential equations',
               0,
               u'6th:SolvPDEs',
               u'6th:SolvPDEs'),
              (u'Finite difference methods',
               1,
               u'6th:SolvPDEs:MOLandFE',
               u'6th:SolvPDEs:MOLandFE'),
              (u'Reduction of a PDE to a system of ODEs',
               2,
               u'sec:pde:diff1D:reduce',
               u'sec:pde:diff1D:reduce'),
              (u'Construction of a test problem with known discrete solution',
               2,
               u'sec:pde:diff1D:testproblem',
               u'sec:pde:diff1D:testproblem'),
              (u'Implementation: Forward Euler method', 2, None, '___sec198'),
              (u'Application: heat conduction in a rod',
               2,
               u'sec:pde:diff1D:rod',
               u'sec:pde:diff1D:rod'),
              (u'Vectorization', 2, None, '___sec200'),
              (u'Using Odespy to solve the system of ODEs',
               2,
               None,
               '___sec201'),
              (u'Implicit methods', 2, None, '___sec202'),
              (u'Exercises', 1, None, '___sec203'),
              (u'Exercise 62: Simulate a diffusion equation by hand',
               2,
               u'sec:pde:diff1D:exer:handFE',
               u'sec:pde:diff1D:exer:handFE'),
              (u'Exercise 63: Compute temperature variations in the ground',
               2,
               u'sec:pde:diff1D:exer:groundtemp',
               u'sec:pde:diff1D:exer:groundtemp'),
              (u'Exercise 64: Compare implicit methods',
               2,
               u'sec:pde:diff1D:exer:compare:implicit',
               u'sec:pde:diff1D:exer:compare:implicit'),
              (u'Exercise 65: Explore adaptive and implicit methods',
               2,
               u'sec:pde:diff1D:exer:groundtemp:adapt',
               u'sec:pde:diff1D:exer:groundtemp:adapt'),
              (u'Exercise 66: Investigate the $\\theta$ rule',
               2,
               u'sec:pde:diff1D:exer:CN',
               u'sec:pde:diff1D:exer:CN'),
              (u'Remarks', 3, None, '___sec209'),
              (u'Exercise 67: Compute the diffusion of a Gaussian peak',
               2,
               u'sec:pde:diff1D:exer:Gaussian',
               u'sec:pde:diff1D:exer:Gaussian'),
              (u'Remarks', 3, None, '___sec211'),
              (u'Exercise 68: Vectorize a function for computing the area of a polygon',
               2,
               u'2nd:exer:area:polygon2',
               u'2nd:exer:area:polygon2'),
              (u'Exercise 69: Explore symmetry',
               2,
               u'sec:pde:diff1D:exer:Gaussian:symm',
               u'sec:pde:diff1D:exer:Gaussian:symm'),
              (u'Remarks', 3, None, '___sec214'),
              (u'Exercise 70: Compute solutions as $t\\rightarrow\\infty$',
               2,
               u'sec:pde:diff1D:exer:stationary',
               u'sec:pde:diff1D:exer:stationary'),
              (u'Remarks', 3, None, '___sec216'),
              (u'Exercise 71: Solve a two-point boundary value problem',
               2,
               u'sec:pde:diff1D:exer:stationary2',
               u'sec:pde:diff1D:exer:stationary2'),
              (u'Solving nonlinear algebraic equations',
               0,
               u'4th:NonlinAlgEq',
               u'4th:NonlinAlgEq'),
              (u'Brute force methods',
               1,
               u'4th:bruteforce',
               u'4th:bruteforce'),
              (u'Brute force root finding', 2, None, '___sec220'),
              (u'Numerical algorithm', 3, None, '___sec221'),
              (u'Implementation', 3, None, '___sec222'),
              (u'Brute force optimization', 2, None, '___sec223'),
              (u'Numerical algorithm', 3, None, '___sec224'),
              (u'Implementation', 3, None, '___sec225'),
              (u'Model problem for algebraic equations',
               2,
               None,
               '___sec226'),
              (u"Newton's method",
               1,
               u'4th:NonlinAlgEq:Newt',
               u'4th:NonlinAlgEq:Newt'),
              (u"Deriving and implementing Newton's method",
               2,
               None,
               '___sec228'),
              (u'Making a more efficient and robust implementation',
               2,
               u'4th:Newton:robust',
               u'4th:Newton:robust'),
              (u'The secant method',
               1,
               u'4th:NonlinAlgEq:Secant',
               u'4th:NonlinAlgEq:Secant'),
              (u'The bisection method',
               1,
               u'4th:NonlinAlgEq:Bisect',
               u'4th:NonlinAlgEq:Bisect'),
              (u'Rate of convergence',
               1,
               u'4th:NonlinAlgEq:RateConv',
               u'4th:NonlinAlgEq:RateConv'),
              (u'Solving multiple nonlinear algebraic equations',
               1,
               u'nonlin:Newton:systems',
               u'nonlin:Newton:systems'),
              (u'Abstract notation',
               2,
               u'nonlin:Newton:systems:notation',
               u'nonlin:Newton:systems:notation'),
              (u'Taylor expansions for multi-variable functions',
               2,
               None,
               '___sec235'),
              (u"Newton's method", 2, None, '___sec236'),
              (u'Implementation', 2, None, '___sec237'),
              (u'Exercises', 1, None, '___sec238'),
              (u"Exercise 72: Understand why Newton's method can fail",
               2,
               u'4th:exer:Newton:failure',
               u'4th:exer:Newton:failure'),
              (u'Exercise 73: See if the secant method fails',
               2,
               u'4th:exer:Secant:failure',
               u'4th:exer:Secant:failure'),
              (u'Exercise 74: Understand why the bisection method cannot fail',
               2,
               u'4th:exer:Bisection:failure',
               u'4th:exer:Bisection:failure'),
              (u"Exercise 75: Combine the bisection method with Newton's method",
               2,
               u'4th:exer:Bisection:Newton',
               u'4th:exer:Bisection:Newton'),
              (u"Exercise 76: Write a test function for Newton's method",
               2,
               u'4th:exer:NewtonHand',
               u'4th:exer:NewtonHand'),
              (u'Exercise 77: Solve nonlinear equation for a vibrating beam',
               2,
               u'4th:exer:beam:vib',
               u'4th:exer:beam:vib'),
              (u'References', 0, None, '___sec245')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands.tex -->
$$
\newcommand{\Oof}[1]{\mathcal{O}(#1)}
\newcommand{\F}{\boldsymbol{F}}
\newcommand{\J}{\boldsymbol{J}}
\newcommand{\x}{\boldsymbol{x}}
\renewcommand{\c}{\boldsymbol{c}}
$$




    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="p4c-bootstrap-Matlab.html">Programming for Computations - A Gentle Introduction to Numerical Simulations with MATLAB/Octave</a>
  </div>

  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab001.html#___sec0" style="font-size: 80%;"><b>Preface</b></a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab001.html#___sec1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Why learn programming?</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab001.html#___sec2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Target audience and background knowledge</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab001.html#___sec3" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Numerical methods</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab001.html#___sec4" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The computer language: Matlab</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab001.html#___sec5" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;How this book is different</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab001.html#___sec6" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Supplementary materials</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab001.html#___sec7" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Acknowledgments</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab003.html#1st:TheFirstFewSteps" style="font-size: 80%;"><b>The first few steps</b></a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab003.html#___sec9" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;What is a program? And what is programming?</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab004.html#1st:ex1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;A Matlab program with variables</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab004.html#___sec11" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The program</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab004.html#___sec12" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dissection of the program</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab004.html#___sec13" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Why not just use a pocket calculator?</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab004.html#___sec14" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Why you must use a text editor to write programs</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab004.html#___sec15" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write and run your first program</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab004.html#___sec16" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write and run a program in Matlab</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab004.html#___sec17" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write a program in a text editor and run it in Octave</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab005.html#1st:ex2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;A Matlab program with a library function</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab006.html#1st:ex3" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;A Matlab program with vectorization and plotting</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab007.html#___sec20" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;More basic concepts</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab007.html#___sec21" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Using Matlab interactively</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab007.html#___sec22" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arithmetics, parentheses and rounding errors</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab007.html#___sec23" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Variables</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab007.html#___sec24" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Formatting text and numbers</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab007.html#___sec25" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arrays</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab007.html#___sec26" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Plotting</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab007.html#___sec27" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error messages and warnings</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab007.html#___sec28" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Input data</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab007.html#___sec29" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Symbolic computations</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab007.html#___sec30" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Concluding remarks</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab008.html#___sec31" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercises</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab008.html#1st:exer:ErrorMessages" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 1: Error messages</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab008.html#1st:exer:cubeVolume" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2: Volume of a cube</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab008.html#1st:exer:areaCircle" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 3: Area and circumference of a circle</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab008.html#1st:exer:volumes3cubes" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 4: Volumes of three cubes</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab008.html#1st:exer:averageOf5Integers" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 5: Average of integers</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab008.html#1st:exer:cubeVolInteractively" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 6: Interactive computing of volume and area</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab008.html#1st:exer:updateVarInteractively" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 7: Update variable at command prompt</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab008.html#1st:exer:printfScreen" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 8: Formatted print to screen</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab008.html#1st:exer:PythonDocRandom" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 9: Matlab documentation and random numbers</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab009.html#2nd:BasicConstructins" style="font-size: 80%;"><b>Basic constructions</b></a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab009.html#___sec42" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;If tests</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab010.html#sec:functions" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Functions</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab011.html#sec:for:loops" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;For loops</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab012.html#sec:while:loops" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;While loops</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab012.html#sec:file:reading:writing" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Reading from and writing to files</a></li>
     <!-- navigation toc: --> <li><a href="#___sec47" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercises</a></li>
     <!-- navigation toc: --> <li><a href="#2nd:exer:IntroducingErrors" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 10: Introducing errors</a></li>
     <!-- navigation toc: --> <li><a href="#2nd:exer:compInt" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 11: Compare integers a and b</a></li>
     <!-- navigation toc: --> <li><a href="#2nd:exer:funcCircArea" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 12: Functions for circumference and area of a circle</a></li>
     <!-- navigation toc: --> <li><a href="#2nd:exer:funcAreaRectangle" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 13: Function for area of a rectangle</a></li>
     <!-- navigation toc: --> <li><a href="#2nd:exer:area:polygon" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 14: Area of a polygon</a></li>
     <!-- navigation toc: --> <li><a href="#2nd:exer:avNInt" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 15: Average of integers</a></li>
     <!-- navigation toc: --> <li><a href="#2nd:exer:whileLoopErrors" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 16: While loop with errors</a></li>
     <!-- navigation toc: --> <li><a href="#2nd:exer:areaRectCircle" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 17: Area of rectangle versus circle</a></li>
     <!-- navigation toc: --> <li><a href="#2nd:exer:Cross2Graphs" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 18: Find crossing points of two graphs</a></li>
     <!-- navigation toc: --> <li><a href="#2nd:exer:sortNumbers" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 19: Sort array with numbers</a></li>
     <!-- navigation toc: --> <li><a href="#2nd:exer:computingPi" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 20: Compute \( \pi \)</a></li>
     <!-- navigation toc: --> <li><a href="#2nd:exer:combinatorics1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 21: Compute combinations of sets</a></li>
     <!-- navigation toc: --> <li><a href="#2nd:exer:numberOccurrence" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 22: Frequency of random numbers</a></li>
     <!-- navigation toc: --> <li><a href="#___sec61" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="#2nd:exer:Game21" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 23: Game 21</a></li>
     <!-- navigation toc: --> <li><a href="#2nd:exer:linearInterpol" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 24: Linear interpolation</a></li>
     <!-- navigation toc: --> <li><a href="#2nd:exer:testStraightLine" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 25: Test straight line requirement</a></li>
     <!-- navigation toc: --> <li><a href="#2nd:exer:fitLine" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 26: Fit straight line to data</a></li>
     <!-- navigation toc: --> <li><a href="#___sec66" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="#2nd:exer:fitSines" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 27: Fit sines to straight line</a></li>
     <!-- navigation toc: --> <li><a href="#___sec68" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="#2nd:exer:countTextString" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 28: Count occurrences of a string in a string</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab014.html#sec:integrals" style="font-size: 80%;"><b>Computing integrals</b></a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab014.html#sec:integrals:basic" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Basic ideas of numerical integration</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab014.html#___sec72" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Computational example</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab015.html#sec:integrals:trap" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The composite trapezoidal rule</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab015.html#sec:integrals:formula" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The general formula</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab015.html#sec:integrals:trap:impl" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab015.html#___sec76" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Specific or general implementation?</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab015.html#___sec77" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation with functions</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab015.html#___sec78" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Solving our specific problem in a session</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab015.html#___sec79" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Solving our specific problem in a program</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab015.html#___sec80" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Alternative flat special-purpose implementation</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#sec:integrals:Midpoint" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The composite midpoint method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec82" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The idea</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec83" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The general formula</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#sec:midpoint:code" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec85" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Comparing the trapezoidal and the midpoint methods</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec86" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Testing</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec87" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problems with brief testing procedures</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#sec:integrals:testprocs" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Proper test procedures</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec89" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hand-computed results</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec90" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Solving a problem without numerical errors</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec91" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Demonstrating correct convergence rates</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#sec:integrals:finite_prec" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Finite precision of floating-point numbers</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#sec:integrals:test:functions" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constructing unit tests and writing test functions</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec94" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hand-computed numerical results</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec95" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Solving a problem without numerical errors</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec96" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Demonstrating correct convergence rates</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec97" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Vectorization</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec98" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vectorizing the midpoint rule</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec99" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vectorizing the trapezoidal rule</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec100" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Measuring computational speed</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#sec:int:double" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Double and triple integrals</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#sec:int:double:midpoint" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The midpoint rule for a double integral</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec103" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Derivation via one-dimensional integrals</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec104" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Direct derivation</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec105" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Programming a double sum</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec106" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reusing code for one-dimensional integrals</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec107" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verification via test functions</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec108" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The midpoint rule for a triple integral</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec109" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Theory</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec110" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#sec:int:complex:domain" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Monte Carlo integration for complex-shaped domains</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec112" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Monte Carlo integration algorithm</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec113" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec114" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verification</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec115" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Test function for function with random numbers</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec116" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Integral over a circle</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab017.html#___sec117" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercises</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab017.html#sec:exer:trap:hand" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 29: Hand calculations for the trapezoidal method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab017.html#sec:exer:midpt:hand" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 30: Hand calculations for the midpoint method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab017.html#sec:exer:trap:mid:parabola" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 31: Compute a simple integral</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab017.html#sec:exer:hand:sine" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 32: Hand-calculations with sine integrals</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab017.html#sec:exer:test:midpoint" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 33: Make test functions for the midpoint method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab017.html#sec:exer:test:roundoff" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 34: Explore rounding errors with large numbers</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab017.html#sec:exer:test:convrates:sqrt" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 35: Write test functions for \( \int_0^4\sqrt{x}dx \)</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab017.html#___sec125" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab017.html#sec:exer:rectangleMethod" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 36: Rectangle methods</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab017.html#sec:exer:adaptive:int" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 37: Adaptive integration</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab017.html#___sec128" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab017.html#sec:exer:integrate:x2x" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 38: Integrating x raised to x</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab017.html#sec:exer:sine:products" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 39: Integrate products of sine functions</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab017.html#sec:exer:revisitFitSines" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 40: Revisit fit of sines to a function</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab017.html#sec:exer:trapezoidal:2D" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 41: Derive the trapezoidal rule for a double integral</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab017.html#sec:exer:MC:ellipse" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 42: Compute the area of a triangle by Monte Carlo integration</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab018.html#5th:SolvODEs" style="font-size: 80%;"><b>Solving ordinary differential equations</b></a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab019.html#sec:de:pg" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Population growth</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab019.html#sec:de:pg:model" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Derivation of the model</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab019.html#sec:de:pg:numerics" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Numerical solution</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab019.html#sec:de:pg:prog1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Programming the Forward Euler scheme; the special case</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab019.html#sec:de:pg:geom" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Understanding the Forward Euler method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab019.html#sec:de:FE:gen" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Programming the Forward Euler scheme; the general case</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab019.html#___sec141" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Making the population growth model more realistic</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab019.html#sec:de:growth:test:linear" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verification: exact linear solution of the discrete equations</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab020.html#___sec143" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Spreading of diseases</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab020.html#sec:de:flu" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Spreading of a flu</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab020.html#sec:de:flu:FE" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A Forward Euler method for the differential equation system</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab020.html#sec:de:flu:prog:spec" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Programming the numerical method; the special case</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab020.html#___sec147" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Outbreak or not</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab020.html#sec:de:flu:generic" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Abstract problem and notation</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab020.html#sec:de:flu:prog:generic" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Programming the numerical method; the general case</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab020.html#___sec150" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time-restricted immunity</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab020.html#sec:de:flu:vaccine" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Incorporating vaccination</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab020.html#sec:de:flu:vaccine:discont" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Discontinuous coefficients: a vaccination campaign</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#sec:de:vib" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Oscillating one-dimensional systems</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#___sec154" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Derivation of a simple model</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#___sec155" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Numerical solution</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#sec:de:vib:special" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Programming the numerical method; the special case</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#___sec157" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A magic fix of the numerical method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#sec:de:osc:Heun" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The 2nd-order Runge-Kutta method (or Heun's method)</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#sec:de:osc:odespy" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software for solving ODEs</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#___sec160" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The 4th-order Runge-Kutta method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#___sec161" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The algorithm</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#___sec162" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#___sec163" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#___sec164" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Derivation</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#___sec165" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;More effects: damping, nonlinearity, and external forces</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#___sec166" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Euler-Cromer scheme</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#___sec167" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The 4-th order Runge-Kutta method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#___sec168" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Illustration of linear damping</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#___sec169" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Illustration of linear damping with sinusoidal excitation</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#sec:de:vib:ode2:sliding:friction" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Spring-mass system with sliding friction</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#sec:de:vib:2nd" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A finite difference method; undamped, linear case</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#sec:de:vib:2nd:damped1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A finite difference method; linear damping</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#___sec173" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercises</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:geom" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 43: Geometric construction of the Forward Euler method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:FE:test1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 44: Make test functions for the Forward Euler method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:Heun:pg" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 45: Implement and evaluate Heun's method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:logistic:dtopt" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 46: Find an appropriate time step; logistic model</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:SIR:dtopt" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 47: Find an appropriate time step; SIR model</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:SIRV:padapt" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 48: Model an adaptive vaccination campaign</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:SIRV:padapt_time_limited" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 49: Make a SIRV model with time-limited effect of vaccination</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:vib:FE:func" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 50: Refactor a flat program</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:vib:ode_FE" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 51: Simulate oscillations by a general ODE solver</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:vib:energy" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 52: Compute the energy in oscillations</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:pg:BE" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 53: Use a Backward Euler scheme for population growth</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:pg:CN" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 54: Use a Crank-Nicolson scheme for population growth</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:fd:Taylor" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 55: Understand finite differences via Taylor series</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:vib:BE" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 56: Use a Backward Euler scheme for oscillations</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#___sec188" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:SIR:Heun" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 57: Use Heun's method for the SIR model</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:odespy:decay" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 58: Use Odespy to solve a simple ODE</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:osc:BE" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 59: Set up a Backward Euler scheme for oscillations</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:osc:FE:general" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 60: Set up a Forward Euler scheme for nonlinear and damped oscillations</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:osc:2nd:V0ic" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 61: Discretize an initial condition</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab023.html#6th:SolvPDEs" style="font-size: 80%;"><b>Solving partial differential equations</b></a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#6th:SolvPDEs:MOLandFE" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Finite difference methods</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#sec:pde:diff1D:reduce" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reduction of a PDE to a system of ODEs</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#sec:pde:diff1D:testproblem" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Construction of a test problem with known discrete solution</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#___sec198" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation: Forward Euler method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#sec:pde:diff1D:rod" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application: heat conduction in a rod</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#___sec200" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vectorization</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#___sec201" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Using Odespy to solve the system of ODEs</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#___sec202" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implicit methods</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#___sec203" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercises</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#sec:pde:diff1D:exer:handFE" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 62: Simulate a diffusion equation by hand</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#sec:pde:diff1D:exer:groundtemp" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 63: Compute temperature variations in the ground</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#sec:pde:diff1D:exer:compare:implicit" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 64: Compare implicit methods</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#sec:pde:diff1D:exer:groundtemp:adapt" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 65: Explore adaptive and implicit methods</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#sec:pde:diff1D:exer:CN" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 66: Investigate the \( \theta \) rule</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#___sec209" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#sec:pde:diff1D:exer:Gaussian" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 67: Compute the diffusion of a Gaussian peak</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#___sec211" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#2nd:exer:area:polygon2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 68: Vectorize a function for computing the area of a polygon</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#sec:pde:diff1D:exer:Gaussian:symm" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 69: Explore symmetry</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#___sec214" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#sec:pde:diff1D:exer:stationary" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 70: Compute solutions as \( t\rightarrow\infty \)</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#___sec216" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#sec:pde:diff1D:exer:stationary2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 71: Solve a two-point boundary value problem</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab025.html#4th:NonlinAlgEq" style="font-size: 80%;"><b>Solving nonlinear algebraic equations</b></a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab025.html#4th:bruteforce" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Brute force methods</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab025.html#___sec220" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Brute force root finding</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab025.html#___sec221" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Numerical algorithm</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab025.html#___sec222" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab025.html#___sec223" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Brute force optimization</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab025.html#___sec224" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Numerical algorithm</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab025.html#___sec225" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab025.html#___sec226" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Model problem for algebraic equations</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab026.html#4th:NonlinAlgEq:Newt" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Newton's method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab026.html#___sec228" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Deriving and implementing Newton's method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab026.html#4th:Newton:robust" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Making a more efficient and robust implementation</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab027.html#4th:NonlinAlgEq:Secant" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The secant method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab028.html#4th:NonlinAlgEq:Bisect" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The bisection method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab029.html#4th:NonlinAlgEq:RateConv" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Rate of convergence</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab030.html#nonlin:Newton:systems" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Solving multiple nonlinear algebraic equations</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab030.html#nonlin:Newton:systems:notation" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Abstract notation</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab030.html#___sec235" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Taylor expansions for multi-variable functions</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab030.html#___sec236" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Newton's method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab030.html#___sec237" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab031.html#___sec238" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercises</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab031.html#4th:exer:Newton:failure" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 72: Understand why Newton's method can fail</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab031.html#4th:exer:Secant:failure" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 73: See if the secant method fails</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab031.html#4th:exer:Bisection:failure" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 74: Understand why the bisection method cannot fail</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab031.html#4th:exer:Bisection:Newton" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 75: Combine the bisection method with Newton's method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab031.html#4th:exer:NewtonHand" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 76: Write a test function for Newton's method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab031.html#4th:exer:beam:vib" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 77: Solve nonlinear equation for a vibrating beam</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab032.html#___sec245" style="font-size: 80%;"><b>References</b></a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0013"></a>
<!-- !split -->

<h1 id="___sec47">Exercises </h1>

<p>
<!-- --- begin exercise --- -->

<h2 id="2nd:exer:IntroducingErrors">Exercise 10: Introducing errors</h2>

<p>
<!-- solution=`sol_errors_colon_indent_etc.pdf` -->

<p>
Write the program <code>ball_function.m</code> as given in the text and
confirm that the program runs correctly. Then save a copy of the
program and use that program during the following error testing.

<p>
You are supposed to introduce errors in the code, one by one. For each
error introduced, save and run the program, and comment how well
Matlab's response corresponds to the actual error. When you are
finished with one error, re-set the program to correct behavior (and
check that it works!) before moving on to the next error.

<p>
<b>a)</b>
Change the first line from <code>function ball_function()</code> to
<code>ball_function()</code>, i.e. remove the word <code>function</code>.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_10_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_10_1">

<p>
Running the program gives an error message containing
<p>

<!-- code=text (!bc dat) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">Error: Unexpected input at line number: 9
</pre></div>
<p>
as well as the name of the file in which this problem occurred. The last
part of the error message reads:
<p>

<!-- code=text (!bc dat) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">    fprintf(&#39;%f \n&#39;,vertical_position);
end
  ^
</pre></div>
<p>
Matlab reacts to the word <code>end</code> here. However, (as we know) <code>end</code> is correctly
used and placed, the problem is rather that the word <code>function</code> to which <code>end</code>
was supposed to match, is not there! So, Matlab responds by stating that it
does not understand the word <code>end</code>. With such error messages, the programmer has to
understand whether <code>end</code> is to be removed, or if some other keyword (here <code>function</code>)
lacks in the above.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>b)</b>
Change the first line from <code>function ball_function()</code>
to <code>function ball_func()</code>, i.e., change the name of the function.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_10_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_10_2">

<p>
The program runs as before, i.e. no error messages. This is because Matlab
understands that the (main or first) function in the file <code>ball_function.m</code>
is supposed to be run, even if the name of that function is not the same as
the name of the file in which the function definition is located.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>c)</b>
Change the line <code>function result = y(t)</code> to <code>function y(t)</code>.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_10_3" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_10_3">

<p>
Running the program gives an error message containing the line in which Matlab
found a problem (line 4 here), as well as a message telling us what seems to
be wrong
<p>

<!-- code=text (!bc dat) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">Error: Too many outputs to function y
</pre></div>
<p>
Again, there is a mismatch between the function <code>y(t)</code> as it now (wrongly) is
defined and the way it is used. In the erroneous definition, we have not specified
in the header of the function that there is to be a return value from the function.
Therefore, when we state in line 4 that we want the return value from the function
to be stored in <code>vertical_position</code>, Matlab gets a problem.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>d)</b>
Change the line <code>function result = y(t)</code> to
<code>function result = y()</code>, i.e., remove the parameter <code>t</code>.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_10_4" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_10_4">

<p>
Running the program gives an error message containing the line in which Matlab
found a problem (line 4 here), as well as a message telling us what seems to
be wrong
<p>

<!-- code=text (!bc dat) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">Error: Too many inputs to function y
</pre></div>
<p>
Again, there is a mismatch between the function <code>y</code> as it now (wrongly) is
defined and the way it is used. In the erroneous definition, we have not specified
that the function should have an input parameter. Therefore, when we (in line 4) call
the function with a parameter, Matlab gets a problem.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>e)</b>
Change the first statement that calls <code>y</code> from
<code>vertical_position = y(time);</code> to <code>vertical_position = y();</code>.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_10_5" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_10_5">

<p>
Running the program gives an error message containing the line in which Matlab
found a problem (line 4 here), as well as a message telling us what seems to
be wrong
<p>

<!-- code=text (!bc dat) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">Error: Undefined function or variable t
</pre></div>
<p>
This message tells us that the input parameter <code>t</code> does not get any value assigned.
We have defined the function to take one parameter, but we call it without any parameter.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
Filename: <code>introducing_errors.m</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="2nd:exer:compInt">Exercise 11: Compare integers a and b</h2>

<p>
<!-- solution=`sol_compare_integers.pdf` -->

<p>
Explain briefly, in your own words, what the following program
does.

<p>

<!-- code=matlab (!bc mcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">a = input(<span style="color: #BA2121">&#39;Give an integer a: &#39;</span>);
b = input(<span style="color: #BA2121">&#39;Give an integer b: &#39;</span>);

<span style="color: #008000; font-weight: bold">if</span> a <span style="color: #666666">&lt;</span> b
    fprintf(<span style="color: #BA2121">&#39;a is the smallest of the two numbers\n&#39;</span>);
<span style="color: #008000; font-weight: bold">elseif</span> a <span style="color: #666666">==</span> b
    fprintf(<span style="color: #BA2121">&#39;a and b are equal\n&#39;</span>);
<span style="color: #008000; font-weight: bold">else</span>
    fprintf(<span style="color: #BA2121">&#39;a is the largest of the two numbers\n&#39;</span>);
<span style="color: #008000; font-weight: bold">end</span>
</pre></div>
<p>
Proceed by writing the program, and then run it a few times with
different values for <code>a</code> and <code>b</code> to confirm that it works as
intended. In particular, choose combinations for <code>a</code> and <code>b</code> so that
all three branches of the <code>if</code> construction get tested.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_11_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_11_1">

<p>
The program takes two integers as input and checks if the number <code>a</code> is
smaller than <code>b</code>, equal to <code>b</code>, or larger than <code>b</code>. A message is printed
to the screen in each case.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>compare_a_and_b.m</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="2nd:exer:funcCircArea">Exercise 12: Functions for circumference and area of a circle</h2>

<p>
<!-- solution=`sol_functions_circumference_area.pdf` -->

<p>
Write a program that takes a circle radius <code>r</code> as input from the user
and then computes the circumference <code>C</code> and area <code>A</code> of the
circle. Implement the computations of <code>C</code> and <code>A</code> as two separate
functions that each takes <code>r</code> as input parameter. Print <code>C</code> and <code>A</code> to
the screen along with an appropriate text. Run the program with \( r =
1 \) and confirm that you get the right answer.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_12_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_12_1">

<p>
The code reads:
<p>

<!-- code=matlab (!bc mcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">circumference = @(r) <span style="color: #666666">2*</span><span style="color: #008000">pi</span><span style="color: #666666">*</span>r;
area = @(r) <span style="color: #008000">pi</span><span style="color: #666666">*</span>r^<span style="color: #666666">2</span>;

r = input(<span style="color: #BA2121">&#39;Give the radius of a circle: &#39;</span>);
C = circumference(r);
A = area(r);
fprintf(<span style="color: #BA2121">&#39;Circumference: %g , Area: %g\n&#39;</span>, C, A);
</pre></div>
<p>
Running the program, choosing <code>r = 1</code>, gives the following dialog:

<p>

<!-- code=text (!bc dat) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">Give the radius of a circle: 1
Circumference: 6.28319 , Area: 3.14159
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>functions_circumference_area.m</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="2nd:exer:funcAreaRectangle">Exercise 13: Function for area of a rectangle</h2>

<p>
<!-- solution=`sol_function_area_rectangle.pdf` -->

<p>
Write a program that computes the area \( A = b c \) of a rectangle. The
values of \( b \) and \( c \) should be user input to the program. Also, write
the area computation as a function that takes \( b \) and \( c \) as input
parameters and returns the computed area. Let the program print the
result to screen along with an appropriate text. Run the program with
\( b = 2 \) and \( c = 3 \) to confirm correct program behavior.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_13_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_13_1">

<p>
The code reads:
<p>

<!-- code=matlab (!bc mcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">area = @(s1, s2) s1<span style="color: #666666">*</span>s2;

b = input(<span style="color: #BA2121">&#39;Give the one side of the rectangle: &#39;</span>);
c = input(<span style="color: #BA2121">&#39;Give the other side of the rectangle: &#39;</span>);
A = area(b, c);
fprintf(<span style="color: #BA2121">&#39;Area: %g\n&#39;</span>,A);
</pre></div>
<p>
Running the program gives the following dialog:

<p>

<!-- code=text (!bc dat) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">Give the one side of the rectangle: 2
Give the other side of the rectangle: 3
Area:

ans = 6
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>function_area_rectangle.m</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="2nd:exer:area:polygon">Exercise 14: Area of a polygon</h2>

<p>
One of the most important mathematical problems through all times has been
to find the area of a polygon, especially because real estate areas often
had the shape of polygons, and it was necessary to pay tax for the area.
We have a polygon as depicted below.

<p>
<center><p><img src="figs/polygon.png" align="bottom" width=500></p></center>

<p>
The vertices (&quot;corners&quot;)
of the polygon have coordinates \( (x_1,y_1) \), \( (x_2,y_2) \),
\( \ldots \), \( (x_n, y_n) \), numbered either in a clockwise or
counter clockwise fashion.
The area \( A \) of the polygon can amazingly be computed by just knowing the
boundary coordinates:
<!-- (see <a href="http://en.wikipedia.org/wiki/Shoelace_formula" target="_self">Wikipedia</a> for explanation): -->

$$ A = \frac{1}{2}\left| (x_1y_2+x_2y_3 + \cdots + x_{n-1}y_n + x_ny_1)
- (y_1x_2 + y_2x_3 + \cdots + y_{n-1}x_n + y_nx_1)\right|\thinspace .$$

Write a function <code>polyarea(x, y)</code> that takes two coordinate arrays
with the vertices as arguments and returns the area.
Assume that <code>x</code> and <code>y</code> are either lists or arrays.

<p>
Test the function on a triangle, a quadrilateral, and a pentagon where
you can calculate the area by alternative methods for comparison.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_14_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_14_1">

<p>
Code:

<p>

<!-- code=matlab (!bc mpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #408080; font-style: italic">% Computes the area of a polygon from vertex </span>
<span style="color: #408080; font-style: italic">% coordinates only.</span>

<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span>area =<span style="color: #bbbbbb"> </span><span style="color: #0000FF">polyarea</span>(x, y)<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>n = <span style="color: #008000">length</span>(x);
    <span style="color: #408080; font-style: italic">% next we may initialize area with those terms in the</span>
    <span style="color: #408080; font-style: italic">% sum that does not follow the &quot;increasing index pattern&quot;</span>
    area = x(n)<span style="color: #666666">*</span>y(<span style="color: #666666">1</span>) <span style="color: #666666">-</span> y(n)<span style="color: #666666">*</span>x(<span style="color: #666666">1</span>);  
    <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = <span style="color: #666666">1</span>:(n<span style="color: #666666">-1</span>) 
        area = area <span style="color: #666666">+</span> x(<span style="color: #008000">i</span>)<span style="color: #666666">*</span>y(<span style="color: #008000">i</span><span style="color: #666666">+1</span>) <span style="color: #666666">-</span> y(<span style="color: #008000">i</span>)<span style="color: #666666">*</span>x(<span style="color: #008000">i</span><span style="color: #666666">+1</span>);
    <span style="color: #008000; font-weight: bold">end</span>
    area = <span style="color: #666666">0.5*</span><span style="color: #008000">abs</span>(area);
<span style="color: #008000; font-weight: bold">end</span>
</pre></div>
<p>
The simple tests may be executed by running another function (<code>test_polyarea.m</code>) that
calls the former:

<p>

<!-- code=matlab (!bc mpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #408080; font-style: italic">% pentagon</span>
x = [<span style="color: #666666">0</span> <span style="color: #666666">2</span> <span style="color: #666666">2</span> <span style="color: #666666">1</span> <span style="color: #666666">0</span>];
y = [<span style="color: #666666">0</span> <span style="color: #666666">0</span> <span style="color: #666666">2</span> <span style="color: #666666">3</span> <span style="color: #666666">2</span>];
fprintf(<span style="color: #BA2121">&#39;Area pentagon (true value = 5): %g\n&#39;</span>, polyarea(x, y));

<span style="color: #408080; font-style: italic">% quadrilateral</span>
x = [<span style="color: #666666">0</span> <span style="color: #666666">2</span> <span style="color: #666666">2</span> <span style="color: #666666">0</span>];
y = [<span style="color: #666666">0</span> <span style="color: #666666">0</span> <span style="color: #666666">2</span> <span style="color: #666666">2</span>];
fprintf(<span style="color: #BA2121">&#39;Area quadrilateral (true value = 4): %g\n&#39;</span>, polyarea(x, y));

<span style="color: #408080; font-style: italic">% triangle</span>
x = [<span style="color: #666666">0</span> <span style="color: #666666">2</span> <span style="color: #666666">0</span>];
y = [<span style="color: #666666">0</span> <span style="color: #666666">0</span> <span style="color: #666666">2</span>];
fprintf(<span style="color: #BA2121">&#39;Area triangle (true value = 2): %g\n&#39;</span>, polyarea(x, y));
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>polyarea.m</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="2nd:exer:avNInt">Exercise 15: Average of integers</h2>

<p>
<!-- solution=`sol_average_1_to_N.pdf` -->

<p>
Write a program that gets an integer \( N > 1 \) from the user and
computes the average of all integers \( i = 1,\ldots,N \). The
computation should be done in a function that takes \( N \) as input
parameter. Print the result to the screen with an appropriate text. Run
the program with \( N = 5 \) and confirm that you get the correct answer.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_15_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_15_1">

<p>
The code reads:
<p>

<!-- code=matlab (!bc mcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">average_of_N_integers</span>()<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>N = input(<span style="color: #BA2121">&#39;Give an integer &gt; 1: &#39;</span>);
    average1toN = average(N);
    fprintf(<span style="color: #BA2121">&#39;The average of 1,..., %d is %g\n&#39;</span>, N, average1toN);
<span style="color: #008000; font-weight: bold">end</span>

<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span>result =<span style="color: #bbbbbb"> </span><span style="color: #0000FF">average</span>(N)<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>sum = <span style="color: #666666">0</span>;
    <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = <span style="color: #666666">1</span>:N
        sum = sum <span style="color: #666666">+</span> <span style="color: #008000">i</span>;
    <span style="color: #008000; font-weight: bold">end</span>
    result = sum<span style="color: #666666">/</span>N;
<span style="color: #008000; font-weight: bold">end</span>
</pre></div>
<p>
Running the program gives the following dialog:

<p>

<!-- code=text (!bc dat) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">Give a positive integer &gt; 1: 5
The average of 1,..., 5 is: 3
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>average_1_to_N.m</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="2nd:exer:whileLoopErrors">Exercise 16: While loop with errors</h2>

<p>
<!-- solution=`sol_while_loop_with_errors.pdf` -->

<p>
Assume some program has been written for the task of adding all
integers \( i = 1,2,\ldots,10 \):

<p>

<!-- code=matlab (!bc mpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">some_number = <span style="color: #666666">0</span>;
<span style="color: #008000">i</span> = <span style="color: #666666">1</span>;
<span style="color: #008000; font-weight: bold">while</span> <span style="color: #008000">j</span> <span style="color: #666666">&lt;</span> <span style="color: #666666">11</span>;
    some_number <span style="color: #666666">+</span>= <span style="color: #666666">1</span>
print some_number
</pre></div>
<p>
<b>a)</b>
Identify the errors in the program by just reading the code and
simulating the program by hand.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_16_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_16_1">

<p>
There is a semicolon at the end of the while loop header which should not be there.
There is use of <code>+=</code> within the loop, which is wrong in Matlab (the correct way of
updating the variable is shown in the corrected program below). Furthermore, 1 is added instead
of <code>i</code>. There is no increase of the loop variable <code>i</code>. Finally, the word <code>print</code> will give
an error in Matlab. The printing should use <code>fprintf</code> as shown below.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>b)</b>
Write a new version of the program with errors corrected.
Run this program and confirm that it gives the correct output.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_16_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_16_2">

<p>
The code reads:
<p>

<!-- code=matlab (!bc mcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">some_number = <span style="color: #666666">0</span>;
<span style="color: #008000">i</span> = <span style="color: #666666">1</span>;
<span style="color: #008000; font-weight: bold">while</span> <span style="color: #008000">i</span> <span style="color: #666666">&lt;</span> <span style="color: #666666">11</span>
    some_number = some_number <span style="color: #666666">+</span> <span style="color: #008000">i</span>;
    <span style="color: #008000">i</span> = <span style="color: #008000">i</span> <span style="color: #666666">+</span> <span style="color: #666666">1</span>;
<span style="color: #008000; font-weight: bold">end</span>
fprintf(<span style="color: #BA2121">&#39;The sum: %d\n&#39;</span>, some_number)
</pre></div>
<p>
Running the program gives 55 as the answer.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
Filename: <code>while_loop_errors.m</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="2nd:exer:areaRectCircle">Exercise 17: Area of rectangle versus circle</h2>

<p>
<!-- solution=`sol_area_rectangle_vs_circle.pdf` -->

<p>
Consider one circle and one rectangle. The circle has a radius \( r =
10.6 \). The rectangle has sides \( a \) and \( b \), but only \( a \) is known from
the outset. Let \( a = 1.3 \) and write a program that uses a <code>while</code> loop
to find the largest possible integer \( b \) that gives a rectangle area
smaller than, but as close as possible to, the area of the circle. Run
the program and confirm that it gives the right answer (which is \( b =
271 \)).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_17_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_17_1">

<p>
The code reads:
<p>

<!-- code=matlab (!bc mcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">r = <span style="color: #666666">10.6</span>;
a = <span style="color: #666666">1.3</span>;
circle_area = <span style="color: #008000">pi</span><span style="color: #666666">*</span>r^<span style="color: #666666">2</span>;

b = <span style="color: #666666">0</span>;    <span style="color: #408080; font-style: italic">% chosen starting value for other side of rectangle</span>
<span style="color: #008000; font-weight: bold">while</span> a<span style="color: #666666">*</span>b <span style="color: #666666">&lt;</span> circle_area
    b = b <span style="color: #666666">+</span> <span style="color: #666666">1</span>;
<span style="color: #008000; font-weight: bold">end</span>
b = b <span style="color: #666666">-</span> <span style="color: #666666">1</span>;    <span style="color: #408080; font-style: italic">% must reverse the last update to the right value</span>
fprintf(<span style="color: #BA2121">&#39;The largest possible value of b: %d\n&#39;</span>, b);
</pre></div>
<p>
Running the program gives 271 as output for b.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>area_rectangle_vs_circle.m</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="2nd:exer:Cross2Graphs">Exercise 18: Find crossing points of two graphs</h2>

<p>
<!-- solution=`sol_crossing_2_graphs.pdf` -->

<p>
Consider two functions \( f(x) = x \) and \( g(x) = x^2 \) on the interval \( [-4,4] \).

<p>
Write a program that, by trial and error, finds approximately for
which values of \( x \) the two graphs cross, i.e., \( f(x) = g(x) \). Do this
by considering \( N \) equally distributed points on the interval, at each
point checking whether \( |f(x) - g(x)| < \epsilon \), where \( \epsilon \) is some
small number. Let \( N \) and \( \epsilon \) be user input to the program and let
the result be printed to screen. Run your program with \( N = 400 \) and
\( \epsilon = 0.01 \). Explain the output from the program. Finally, try also
other values of \( N \), keeping the value of \( \epsilon \) fixed.
Explain your observations.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_18_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_18_1">

<p>
The code reads:
<p>

<!-- code=matlab (!bc mcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">f = @(x) x;
g = @(x) x^<span style="color: #666666">2</span>;

N = input(<span style="color: #BA2121">&#39;Give the number of check-points N: &#39;</span>);
epsilon = input(<span style="color: #BA2121">&#39;Give the error tolerance epsilon: &#39;</span>);
x_values = <span style="color: #008000">linspace</span>(<span style="color: #666666">-4</span>, <span style="color: #666666">4</span>, N);

<span style="color: #408080; font-style: italic">% Next, we run over all indices in the array `x_values` and check if</span>
<span style="color: #408080; font-style: italic">% the difference is smaller than the chosen limit. If so, we print x</span>
<span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = <span style="color: #666666">1</span>:N
    <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">abs</span>(f(x_values(<span style="color: #008000">i</span>)) <span style="color: #666666">-</span> g(x_values(<span style="color: #008000">i</span>))) <span style="color: #666666">&lt;</span> epsilon
        x_values(<span style="color: #008000">i</span>)    <span style="color: #408080; font-style: italic">% i.e. print that x value to screen</span>
    <span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">end</span>
</pre></div>
<p>
Running the program with 400 check-points (i.e. <code>N = 400</code>) and
an error tolerance of 0.01 (i.e. <code>epsilon = 0.01</code>) gives the following dialog:

<p>

<!-- code=text (!bc dat) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">Give the number of check-points N: 400
Give the error tolerance: 0.01

ans = 0.01002506265664

ans = 0.99248120300752
</pre></div>
<p>
We note that we do not get exactly 0 and 1 (which we know are the answers). This
owes to the chosen distribution of \( x \)-values. This distribution is decided by <code>N</code>.
Trying other combinations of <code>N</code> and <code>epsilon</code> might give more than 2 "solutions",
or fewer, maybe even none. All of this boils down to whether the <code>if</code> test becomes
true or not. For example, if you let <code>epsilon</code> stay constant while increasing <code>N</code>,
you realize that the difference between \( f(x) \) and \( g(x) \) will be small for several
values of \( x \), allowing more than one \( x \) value to "be a solution". Decreasing <code>N</code> while
<code>epsilon</code> is constant will eventually give no solutions, since the difference between
\( f(x) \) and \( g(x) \) at the tested \( x \)-values gets too large.

<p>
Is is important here to realize the difference between the numerical test we do and the
exact solution. The numerical test just gives us an approximation which we may get as
"good as we want" by the right choices of <code>N</code> and <code>epsilon</code>.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>crossing_2_graphs.m</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="2nd:exer:sortNumbers">Exercise 19: Sort array with numbers</h2>

<p>
<!-- solution=`sol_sort_numbers.pdf` -->

<p>
The built-in function <code>rand</code> may be used to draw pseudo-random numbers
for the standard uniform distribution between \( 0 \) and \( 1 \) (exclusive
at both ends). See <code>help rand</code>.

<p>
Write a script that generates an array of \( 6 \) random numbers between
\( 0 \) and \( 10 \). The program should then sort the array so that numbers
appear in increasing order. Let the program make a formatted print of
the array to the screen both before and after sorting. The printouts
should appear on the screen so that comparison is made easy. Confirm
that the array has been sorted correctly.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_19_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_19_1">

<p>
The code may be written as follows

<p>

<!-- code=matlab (!bc mpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">N = <span style="color: #666666">6</span>;
numbers = <span style="color: #008000">zeros</span>(N, <span style="color: #666666">1</span>);

<span style="color: #408080; font-style: italic">% Draw random numbers</span>
<span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = <span style="color: #666666">1</span>:N
    numbers(<span style="color: #008000">i</span>) = <span style="color: #666666">10*</span><span style="color: #008000">rand</span>;
<span style="color: #008000; font-weight: bold">end</span>
fprintf(<span style="color: #BA2121">&#39;Unsorted: %5.3f %5.3f %5.3f %5.3f %5.3f %5.3f \n&#39;</span>,<span style="color: #408080; font-style: italic">...</span>
          numbers(<span style="color: #666666">1</span>), numbers(<span style="color: #666666">2</span>), numbers(<span style="color: #666666">3</span>),<span style="color: #408080; font-style: italic">...</span>
          numbers(<span style="color: #666666">4</span>), numbers(<span style="color: #666666">5</span>), numbers(<span style="color: #666666">6</span>));

<span style="color: #008000; font-weight: bold">for</span> reference = <span style="color: #666666">1</span>:N
    smallest = numbers(reference);
    i_smallest = reference;
    <span style="color: #408080; font-style: italic">% Find the smallest number in remaining unprinted array</span>
    <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = (reference <span style="color: #666666">+</span> <span style="color: #666666">1</span>):N
        <span style="color: #008000; font-weight: bold">if</span> numbers(<span style="color: #008000">i</span>) <span style="color: #666666">&lt;</span>= smallest
            smallest = numbers(<span style="color: #008000">i</span>);
            i_smallest = <span style="color: #008000">i</span>;
        <span style="color: #008000; font-weight: bold">end</span>
    <span style="color: #008000; font-weight: bold">end</span>
    <span style="color: #408080; font-style: italic">% switch numbers, and use an extra variable for that</span>
    switch_number = numbers(reference);
    numbers(reference) = numbers(i_smallest);
    numbers(i_smallest) = switch_number;
<span style="color: #008000; font-weight: bold">end</span>
fprintf(<span style="color: #BA2121">&#39;Sorted  : %5.3f %5.3f %5.3f %5.3f %5.3f %5.3f \n&#39;</span>,<span style="color: #408080; font-style: italic">...</span>
          numbers(<span style="color: #666666">1</span>), numbers(<span style="color: #666666">2</span>), numbers(<span style="color: #666666">3</span>),<span style="color: #408080; font-style: italic">...</span>
          numbers(<span style="color: #666666">4</span>), numbers(<span style="color: #666666">5</span>), numbers(<span style="color: #666666">6</span>))
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>sort_numbers.m</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="2nd:exer:computingPi">Exercise 20: Compute \( \pi \)</h2>

<p>
<!-- solution=`sol_compute_pi.pdf` -->

<p>
Up through history, great minds have developed different computational
schemes for the number \( \pi \). We will here consider two such schemes,
one by Leibniz (\( 1646-1716 \)), and one by Euler (\( 1707-1783 \)).

<p>
The scheme by Leibniz may be written

$$
\begin{equation*}
\pi = 8\sum_{k=0}^{\infty}\frac{1}{(4k + 1)(4k + 3)} , \nonumber
\end{equation*}
$$

while one form of the Euler scheme may appear as

$$
\begin{equation*}
\pi = \sqrt[]{6\sum_{k=1}^{\infty}\frac{1}{k^2}} . \nonumber
\end{equation*}
$$

If only the first \( N \) terms of each sum are used as an approximation to
\( \pi \), each modified scheme will have computed \( \pi \) with some error.

<p>
Write a program that takes \( N \) as input from the user, and plots the
error development with both schemes as the number of iterations
approaches \( N \). Your program should also print out the final error
achieved with both schemes, i.e. when the number of terms is <code>N</code>.
Run the program with \( N = 100 \) and explain briefly what the graphs show.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_20_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_20_1">

<p>
The code may be written as follows

<p>

<!-- code=matlab (!bc mpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">no_of_terms = input(<span style="color: #BA2121">&#39;Give number of terms in sum for pi: &#39;</span>); 
Leibniz_error = <span style="color: #008000">zeros</span>(no_of_terms, <span style="color: #666666">1</span>);
Euler_error = <span style="color: #008000">zeros</span>(no_of_terms, <span style="color: #666666">1</span>);

<span style="color: #408080; font-style: italic">% Leibniz</span>
sum1 = <span style="color: #666666">0</span>;
<span style="color: #008000; font-weight: bold">for</span> k = <span style="color: #666666">0</span>:(no_of_terms<span style="color: #666666">-1</span>)
    sum1 = sum1 <span style="color: #666666">+</span> <span style="color: #666666">1.0/</span>((<span style="color: #666666">4*</span>k <span style="color: #666666">+</span> <span style="color: #666666">1</span>)<span style="color: #666666">*</span>(<span style="color: #666666">4*</span>k <span style="color: #666666">+</span> <span style="color: #666666">3</span>));
    Leibniz_error(k<span style="color: #666666">+1</span>) = <span style="color: #008000">pi</span> <span style="color: #666666">-</span> <span style="color: #666666">8*</span>sum1;
<span style="color: #008000; font-weight: bold">end</span>
sum1 = <span style="color: #666666">8*</span>sum1;
final_Leibniz_error = <span style="color: #008000">abs</span>(<span style="color: #008000">pi</span> <span style="color: #666666">-</span> sum1);
fprintf(<span style="color: #BA2121">&#39;Leibniz: %g \n&#39;</span>, final_Leibniz_error)

<span style="color: #408080; font-style: italic">% Euler</span>
sum2 = <span style="color: #666666">0</span>;
<span style="color: #008000; font-weight: bold">for</span> k = <span style="color: #666666">1</span>:no_of_terms      <span style="color: #408080; font-style: italic">% Note index range</span>
    sum2 = sum2 <span style="color: #666666">+</span> <span style="color: #666666">1.0/</span>k^<span style="color: #666666">2</span>;
    Euler_error(k) = <span style="color: #008000">pi</span> <span style="color: #666666">-</span> <span style="color: #008000">sqrt</span>(<span style="color: #666666">6*</span>sum2);
<span style="color: #008000; font-weight: bold">end</span>
sum2 = <span style="color: #666666">6*</span>sum2;
sum2 = <span style="color: #008000">sqrt</span>(sum2);
final_Euler_error = <span style="color: #008000">abs</span>(<span style="color: #008000">pi</span> <span style="color: #666666">-</span> sum2);
fprintf(<span style="color: #BA2121">&#39;Leibniz: %g \n&#39;</span>, final_Euler_error)

figure(); plot([<span style="color: #666666">1</span>:no_of_terms], Leibniz_error, <span style="color: #BA2121">&#39;b-&#39;</span>,<span style="color: #408080; font-style: italic">...</span>
               [<span style="color: #666666">1</span>:no_of_terms], Euler_error, <span style="color: #BA2121">&#39;r-&#39;</span>);
xlabel(<span style="color: #BA2121">&#39;No of terms&#39;</span>);
ylabel(<span style="color: #BA2121">&#39;Error with Leibniz (blue) and Euler (red)&#39;</span>);
</pre></div>
<p>
Running the program as told produces the dialog
<p>

<!-- code=text (!bc dat) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">Give number of terms in sum for pi: 100
Leibniz: 0.00499996875098
Euler: 0.00951612178069
</pre></div>
<p>
and the plot in Figure <a href="#fig:pi_comp">3</a>

<p>
<center> <!-- figure label: --> <div id="fig:pi_comp"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 3:  Error as a function of number of terms.  <!-- caption label: fig:pi_comp --> </p></center>
<p><img src="figs/pi_Leibniz_Euler.png" align="bottom" width=400></p>
</center>

<p>
We see that the scheme of Leibniz gives the least error all over the interval. However,
the difference in the error with the two schemes becomes smaller as the number of terms increases.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>compute_pi.m</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="2nd:exer:combinatorics1">Exercise 21: Compute combinations of sets</h2>

<p>
Consider an ID number consisting of two letters and three digits, e.g.,
RE198. How many different numbers can we have, and how can a program
generate all these combinations?

<p>
If a collection of \( n \) things can have \( m_1 \) variations of the first thing,
\( m_2 \) of the second and so on, the total number of variations of
the collection equals \( m_1m_2\cdots m_n \). In particular, the ID number
exemplified above can have \( 26\cdot 26\cdot 10\cdot 10\cdot 10 =676,000 \)
variations. To generate all the combinations, we must have five
nested for loops. The first two run over all letters A, B, and so on to Z,
while the next three run over all digits \( 0,1,\ldots,9 \).

<p>
To convince yourself about this result, start out with an ID number on the
form A3 where the first part can vary among A, B, and C, and the
digit can be among 1, 2, or 3. We must start with A and combine
it with 1, 2, and 3, then continue with B, combined with 1, 2, and 3,
and finally combine C with 1, 2, and 3. A double for loop does the work.

<p>
<b>a)</b>
In a deck of cards, each card is a combination of a rank and a suit.
There are 13 ranks: ace (A), 2, 3, 4, 5, 6, 7, 8, 9, 10, jack (J),
queen (Q), king (K), and
four suits: clubs (C), diamonds (D), hearts (H), and spades (S).
A typical card may be D3. Write statements that generate a
deck of cards, i.e., all the combinations <code>CA</code>, <code>C2</code>, <code>C3</code>, and so on
to <code>SK</code>.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_21_3" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_21_3">

<p>
Program:
<p>

<!-- code=matlab (!bc mpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">pos = <span style="color: #666666">1</span>;
<span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = <span style="color: #666666">1</span>:<span style="color: #008000">length</span>(suits)
    <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">j</span> = <span style="color: #666666">1</span>:<span style="color: #008000">length</span>(ranks)
        deck_of_cards{pos} = strcat(suits(<span style="color: #008000">i</span>), ranks(<span style="color: #008000">j</span>));
        pos = pos <span style="color: #666666">+</span> <span style="color: #666666">1</span>;
    <span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">end</span>
deck_of_cards
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>b)</b>
A vehicle registration number is on the form <code>DE562</code>, where the letters
vary from A to Z and the digits from 0 to 9. Write statements that compute
all the possible registration numbers and stores them in a list.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_21_4" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_21_4">

<p>
Program:
<p>

<!-- code=matlab (!bc mpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">pos = <span style="color: #666666">1</span>;
<span style="color: #008000; font-weight: bold">for</span> L1 = <span style="color: #666666">65</span>:(<span style="color: #666666">65+25</span>)    <span style="color: #408080; font-style: italic">% First letter</span>
    <span style="color: #008000; font-weight: bold">for</span> L2 = <span style="color: #666666">65</span>:(<span style="color: #666666">65+25</span>)   <span style="color: #408080; font-style: italic">% Second letter</span>
       <span style="color: #008000; font-weight: bold">for</span> D1 = <span style="color: #666666">48</span>:<span style="color: #666666">57</span>       <span style="color: #408080; font-style: italic">% First digit</span>
           <span style="color: #008000; font-weight: bold">for</span> D2 = <span style="color: #666666">48</span>:<span style="color: #666666">57</span>     <span style="color: #408080; font-style: italic">% Second digit</span>
               <span style="color: #008000; font-weight: bold">for</span> D3 = <span style="color: #666666">48</span>:<span style="color: #666666">57</span>    <span style="color: #408080; font-style: italic">% Third digit</span>
                    reg_no{pos} = strcat(char(L1), char(L2),<span style="color: #408080; font-style: italic">...</span>
                                      char(D1), char(D2), char(D3));
                    pos = pos <span style="color: #666666">+</span> <span style="color: #666666">1</span>;
               <span style="color: #008000; font-weight: bold">end</span>
           <span style="color: #008000; font-weight: bold">end</span>
       <span style="color: #008000; font-weight: bold">end</span>
    <span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">end</span>
reg_no
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>c)</b>
Generate all the combinations of throwing two dice (the number of eyes
can vary from 1 to 6). Count how many combinations where the sum of
the eyes equals 7.

<p>
<!-- --- begin answer of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_21_1" style="font-size: 80%;"></a>
<b>Answer.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_21_1">

<p>
6

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end answer of exercise --- -->

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_21_5" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_21_5">

<p>
Program:
<p>

<!-- code=matlab (!bc mpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #408080; font-style: italic">% Note that both dice can be represented by a single set here</span>
dice = [<span style="color: #BA2121">&#39;1&#39;</span>, <span style="color: #BA2121">&#39;2&#39;</span>, <span style="color: #BA2121">&#39;3&#39;</span>, <span style="color: #BA2121">&#39;4&#39;</span>, <span style="color: #BA2121">&#39;5&#39;</span>, <span style="color: #BA2121">&#39;6&#39;</span>];
pos = <span style="color: #666666">1</span>;
<span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = <span style="color: #666666">1</span>:<span style="color: #666666">6</span>
    <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">j</span> = <span style="color: #666666">1</span>:<span style="color: #666666">6</span>
        dice_combinations{pos} = dice(<span style="color: #008000">i</span>);
        dice_combinations{pos<span style="color: #666666">+1</span>} = dice(<span style="color: #008000">j</span>);
        pos = pos <span style="color: #666666">+</span> <span style="color: #666666">2</span>;
    <span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">end</span>
<span style="color: #408080; font-style: italic">%dice_combinations</span>

n = <span style="color: #666666">0</span>;
<span style="color: #408080; font-style: italic">% convert to numbers</span>
throw = cell2mat(dice_combinations) <span style="color: #666666">-</span> <span style="color: #666666">48</span>;  <span style="color: #408080; font-style: italic">% adjust to right inverval</span>
<span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = <span style="color: #666666">1</span>:<span style="color: #666666">2</span>:(<span style="color: #008000">length</span>(throw))
   <span style="color: #408080; font-style: italic">%%fprintf(&#39;throw(i) = %d, throw(j) = %d\n&#39;, throw(i), throw(j));</span>
    <span style="color: #008000; font-weight: bold">if</span> (throw(<span style="color: #008000">i</span>) <span style="color: #666666">+</span> throw(<span style="color: #008000">i</span><span style="color: #666666">+1</span>) <span style="color: #666666">==</span> <span style="color: #666666">7</span>)
        n = n <span style="color: #666666">+</span> <span style="color: #666666">1</span>;
    <span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">end</span>
fprintf(<span style="color: #BA2121">&#39;No of combinations giving 7: %d\n&#39;</span>, n);
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
Filename: <code>combine_sets.m</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="2nd:exer:numberOccurrence">Exercise 22: Frequency of random numbers</h2>

<p>
<!-- solution=`sol_number_occurrence.pdf` -->

<p>
Write a program that takes a positive integer \( N \) as input and then draws
\( N \) random integers in the interval \( [1,6] \) (both ends inclusive). In the program,
count how many of the numbers, \( M \), that equal 6 and write out
the fraction \( M/N \). Also, print all the random numbers to the screen so that
you can check for yourself that the counting is correct. Run the program with
a small value for <code>N</code> (e.g., <code>N = 10</code>) to confirm that it works as intended.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_22_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_22_1">

<p>
Use <code>1+floor(6*rand())</code> to draw
a random integer between 1 and 6.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_22_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_22_2">

<p>
The code may be written as follows

<p>

<!-- code=matlab (!bc mpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">N = input(<span style="color: #BA2121">&#39;How many random numbers should be drawn? &#39;</span>); 

<span style="color: #408080; font-style: italic">% Draw random numbers</span>
M = <span style="color: #666666">0</span>;    <span style="color: #408080; font-style: italic">% Counter for the occurences of 6</span>
<span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = <span style="color: #666666">1</span>:N
    drawn_number = <span style="color: #666666">1</span> <span style="color: #666666">+</span> <span style="color: #008000">floor</span>(<span style="color: #666666">6*</span><span style="color: #008000">rand</span>());
    fprintf(<span style="color: #BA2121">&#39;Draw number %d gave: %d \n&#39;</span>, <span style="color: #008000">i</span>, drawn_number);
    <span style="color: #008000; font-weight: bold">if</span> drawn_number <span style="color: #666666">==</span> <span style="color: #666666">6</span>
        M = M <span style="color: #666666">+</span> <span style="color: #666666">1</span>;
    <span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">end</span>
fprintf(<span style="color: #BA2121">&#39;The fraction M/N became: %g \n&#39;</span>, M<span style="color: #666666">/</span>float(N));
</pre></div>
<p>
Running the program produces the dialog
<p>

<!-- code=text (!bc dat) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">How many random numbers should be drawn? 10
Draw number 1 gave: 2
Draw number 2 gave: 4
Draw number 3 gave: 3
Draw number 4 gave: 2
Draw number 5 gave: 2
Draw number 6 gave: 1
Draw number 7 gave: 2
Draw number 8 gave: 6
Draw number 9 gave: 2
Draw number 10 gave: 3
The fraction M/N became: 0.1
</pre></div>
<p>
We see that, in this case, 6 was drawn just a
single time, so one out of ten gives a fraction
<code>M/N</code> of \( 0.1 \).

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>count_random_numbers.m</code>.

<p>
<!-- Closing remarks for this Exercise -->

<h3 id="___sec61">Remarks </h3>

<p>
For large \( N \), this program computes the probability \( M/N \)
of getting six eyes when throwing a die.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="2nd:exer:Game21">Exercise 23: Game 21</h2>

<p>
<!-- solution=`sol_game_21.pdf` -->

<p>
Consider some game where each participant draws a series of random
integers evenly distributed from \( 0 \) and \( 10 \), with the aim of getting
the sum as close as possible to \( 21 \), but <em>not larger</em> than \( 21 \).  You
are out of the game if the sum passes \( 21 \).  After each draw, you are
told the number and your total sum, and is asked whether you want
another draw or not. The one coming closest to \( 21 \) is the winner.

<p>
Implement this game in a program.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_23_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_23_1">

<p>
Use <code>floor(11*rand())</code> to draw
random integers in \( [0,10] \).

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_23_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_23_2">

<p>
The code may be written as follows

<p>

<!-- code=matlab (!bc mpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">upper_limit = <span style="color: #666666">21</span>;
answer = input(<span style="color: #BA2121">&#39;Are you ready to make the first draw (y/n)? &#39;</span>, <span style="color: #BA2121">&#39;s&#39;</span>);
not_finished = true;
sum = <span style="color: #666666">0</span>
<span style="color: #008000; font-weight: bold">while</span> not_finished
    next_number = <span style="color: #008000">floor</span>(<span style="color: #666666">11*</span><span style="color: #008000">rand</span>());
    fprintf(<span style="color: #BA2121">&#39;You got: %d \n&#39;</span>, next_number);
    sum = sum <span style="color: #666666">+</span> next_number;
    <span style="color: #008000; font-weight: bold">if</span> sum <span style="color: #666666">&gt;</span> upper_limit
       fprintf(<span style="color: #408080; font-style: italic">...</span>
       <span style="color: #BA2121">&#39;Game over, you passed 21 (with your %d points)! \n&#39;</span>, sum);
       not_finished = false;
    <span style="color: #008000; font-weight: bold">else</span>
       fprintf(<span style="color: #BA2121">&#39;Your score is now: %d points! \n&#39;</span>, sum);
       answer = input(<span style="color: #BA2121">&#39;Another draw (y/n)? &#39;</span>, <span style="color: #BA2121">&#39;s&#39;</span>);
       <span style="color: #008000; font-weight: bold">if</span> answer <span style="color: #666666">~=</span> <span style="color: #BA2121">&#39;y&#39;</span>
           not_finished = false;
       <span style="color: #008000; font-weight: bold">end</span>
    <span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">end</span>
fprintf(<span style="color: #BA2121">&#39;Finished! \n&#39;</span>);
</pre></div>
<p>
Running the program may produce this dialog
<p>

<!-- code=text (!bc dat) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">You got: 8
Your score is now: 8 points!

Another draw (y/n)? y
You got: 6
Your score is now: 14 points!

Another draw (y/n)? y
You got: 8
Game over, you passed 21 (with your 22 points)!
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>game_21.m</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="2nd:exer:linearInterpol">Exercise 24: Linear interpolation</h2>

<p>
<!-- solution=`sol_linear_interpolation.pdf` -->

<p>
Some measurements \( y_i \), \( i = 1,2,\ldots,N \) (given below), of a
quantity \( y \) have been collected regularly, once every minute, at
times \( t_i=i \), \( i=0,1,\ldots,N \).  We want to find the value \( y \)
<em>in between</em> the measurements, e.g., at \( t=3.2 \) min. Computing such
\( y \) values is called <em>interpolation</em>.

<p>
Let your program use <em>linear interpolation</em> to compute \( y \)
between two consecutive measurements:

<ol>
  <li> Find \( i \) such that \( t_i\leq t \leq t_{i+1} \).</li>
  <li> Find a mathematical expression for the straight line that goes through the
     points \( (i,y_i) \) and \( (i+1,y_{i+1}) \).</li>
  <li> Compute the \( y \) value by inserting the user's time value in
     the expression for the straight line.</li>
</ol>

<b>a)</b>
Implement the linear interpolation technique in a function that
takes an array with the \( y_i \) measurements as input, together with
some time \( t \), and returns the interpolated \( y \) value at time \( t \).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_24_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_24_1">

<p>
See the function <code>interpolate</code> in the script below

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>b)</b>
Write another function with in a loop where the user is asked
for a
time on the interval \( [0,N] \) and the corresponding (interpolated)
\( y \) value is written to the screen.
The loop is terminated when the user gives a negative time.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_24_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_24_2">

<p>
See the function <code>find_y</code> in the script below

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>c)</b>
Use the following measurements: \( 4.4, 2.0, 11.0, 21.5, 7.5 \), corresponding
to times \( 0,1,\ldots,4 \) (min), and compute interpolated values at
\( t=2.5 \) and \( t=3.1 \) min.
Perform separate hand calculations to check that the output from the
program is correct.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_24_3" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_24_3">

<p>
The code may be written as follows

<p>

<!-- code=matlab (!bc mpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">linear_interpolation</span>()<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span><span style="color: #408080; font-style: italic">% From measurement data y (collected once every minute),</span>
    <span style="color: #408080; font-style: italic">% linear interpolation is used to find values in between</span>
    <span style="color: #408080; font-style: italic">% measured data. </span>

    <span style="color: #408080; font-style: italic">% Note: do not need to store the sequence of times</span>
    N = <span style="color: #666666">4</span>;           <span style="color: #408080; font-style: italic">% Total number of measurements</span>
    delta_t = <span style="color: #666666">1</span>;     <span style="color: #408080; font-style: italic">% Time difference between measurements</span>
    
    <span style="color: #408080; font-style: italic">% Note: y(1) is measurement at time zero</span>
    y = <span style="color: #008000">zeros</span>(<span style="color: #666666">5</span>,<span style="color: #666666">1</span>);
    y(<span style="color: #666666">1</span>) = <span style="color: #666666">4.4</span>; y(<span style="color: #666666">2</span>) = <span style="color: #666666">2.0</span>; y(<span style="color: #666666">3</span>) = <span style="color: #666666">11.0</span>; 
    y(<span style="color: #666666">4</span>) = <span style="color: #666666">21.5</span>; y(<span style="color: #666666">5</span>) = <span style="color: #666666">7.5</span>;

    find_y(y,N,delta_t);
<span style="color: #008000; font-weight: bold">end</span>

<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span>result =<span style="color: #bbbbbb"> </span><span style="color: #0000FF">interpolate</span>(y, t, delta_t)<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span><span style="color: #408080; font-style: italic">% Uses linear interpolation to find intermediate y</span>
    <span style="color: #008000">i</span> = <span style="color: #008000">floor</span>(t) <span style="color: #666666">+</span> <span style="color: #666666">1</span>;
    <span style="color: #408080; font-style: italic">% Scheme: y(t) = y_i + delta-y/delta-t * dt</span>
    result = y(<span style="color: #008000">i</span>) <span style="color: #666666">+</span> ((y(<span style="color: #008000">i</span><span style="color: #666666">+1</span>) <span style="color: #666666">-</span> y(<span style="color: #008000">i</span>))<span style="color: #666666">/</span>delta_t)<span style="color: #666666">*</span>(t<span style="color: #666666">-</span><span style="color: #008000">floor</span>(t));
<span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">    </span>
<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">find_y</span>(y, N, delta_t)<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>fprintf(<span style="color: #BA2121">&#39;For time t on the interval [0,%d]... \n&#39;</span>, N);
    t = input(<span style="color: #BA2121">&#39;Give your desired t: &#39;</span>);
    <span style="color: #008000; font-weight: bold">while</span> t <span style="color: #666666">&gt;</span>= <span style="color: #666666">0</span>
        fprintf(<span style="color: #BA2121">&#39;y(t) = %g \n&#39;</span>, interpolate(y, t, delta_t));
        t = input(<span style="color: #BA2121">&#39;Give new time t: &#39;</span>);
    <span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">end</span>
</pre></div>
<p>
Running the program may produce this dialog
<p>

<!-- code=text (!bc dat) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">For time t on the interval [0,4]...
Give your desired t: 2.5
y(t) = 16.25

Give new time t: 0.5
y(t) = 3.2

Give new time t: -1
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
Filename: <code>linear_interpolation.m</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="2nd:exer:testStraightLine">Exercise 25: Test straight line requirement</h2>

<p>
<!-- solution=`sol_test_straight_line.pdf` -->

<p>
Assume the straight line function \( f(x) = 4x + 1 \). Write a script that
tests the &quot;point-slope&quot; form for this line as follows. Within a chosen
interval on the \( x \)-axis (for example, for \( x \) between 0 and 10), randomly
pick \( 100 \) points on the line and check
if the following requirement is fulfilled for each point:
$$ \frac{f(x_i) - f(c)}{x_i - c} = a,\hspace{.3in}  i = 1,2,\ldots,100\thinspace , $$

where \( a \) is the slope of the line and \( c \) defines a fixed point \( (c,f(c)) \)
on the line. Let \( c = 2 \) here.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_25_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_25_1">

<p>
The code may be written as follows

<p>

<!-- code=matlab (!bc mpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #408080; font-style: italic">% For a straight line f(x) = ax + b, and the fixed point (2,f(2)) on </span>
<span style="color: #408080; font-style: italic">% the line, the script tests whether (f(x_i) - f(2)) / (x_i - 2) = a </span>
<span style="color: #408080; font-style: italic">% for randomly chosen x_i, i = 1,...,100.</span>

a = <span style="color: #666666">4</span>; b = <span style="color: #666666">1</span>;
f = @(x) a<span style="color: #666666">*</span>x <span style="color: #666666">+</span> b;
c = <span style="color: #666666">2</span>; f_c = f(c);       <span style="color: #408080; font-style: italic">% Fixed point on the line</span>
epsilon = <span style="color: #666666">1e-6</span>;
<span style="color: #008000">i</span> = <span style="color: #666666">0</span>;
<span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = <span style="color: #666666">1</span>:<span style="color: #666666">100</span>
    x = <span style="color: #666666">10*</span><span style="color: #008000">rand</span>();   <span style="color: #408080; font-style: italic">% rand() returns number between 0 and 1 ...</span>
    numerator = f(x) <span style="color: #666666">-</span> f_c;
    denominator = x <span style="color: #666666">-</span> c;
    <span style="color: #008000; font-weight: bold">if</span> denominator <span style="color: #666666">&gt;</span> epsilon     <span style="color: #408080; font-style: italic">% to avoid zero division</span>
        fraction = numerator<span style="color: #666666">/</span>denominator;
        <span style="color: #408080; font-style: italic">% The following printout should be very close to zero in</span>
        <span style="color: #408080; font-style: italic">% each case IF the points are on the line</span>
        fprintf(<span style="color: #BA2121">&#39;For x = %g : %g \n&#39;</span>, x, <span style="color: #008000">abs</span>(fraction <span style="color: #666666">-</span> a));
    <span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">end</span>
</pre></div>
<p>
The potential problem of zero division is here simply handled by the <code>if</code> test, meaning
that if the denominator is too close to zero, that particular \( x \) is skipped.
A more elegant procedure would be to use a <code>try-catch</code> construction.

<p>
Running the program generates a printout of \( 100 \) lines that for each \( x \) drawn
gives 0 as result from the test. The two last lines of the printout read:

<p>

<!-- code=text (!bc dat) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">For x = 2.67588 : 0
For x = 9.75893 : 0
</pre></div>
<p>
Note that since the \( x \) values are (pseudo-)random in nature, a second run gives
different values for \( x \) (but still 0 for each test!).

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>test_straight_line.m</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="2nd:exer:fitLine">Exercise 26: Fit straight line to data</h2>

<p>
<!-- solution=`sol_fit_straight_line.pdf` -->

<p>
Assume some measurements \( y_i, i = 1,2,\ldots,5 \) have been collected,
once every second. Your task is to write a program that
fits a straight line to those data.

<p>
<b>a)</b>
Make a function that computes the error between the straight line
\( f(x)=ax+b \) and the measurements:

$$ e = \sum_{i=1}^{5} \left(ax_i+b - y_i\right)^2\thinspace . $$

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_26_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_26_1">

<p>
See the function <code>find_error</code> in the script below.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>b)</b>
Make a function with a loop where you give \( a \) and \( b \), the
corresponding value of \( e \) is written to the screen, and
a plot of the straight line \( f(x)=ax+b \) together with the
discrete measurements is shown.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_26_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_26_2">

<p>
See the function <code>interactive_line_fit</code> in the script below.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>c)</b>
Given the measurements \( 0.5, 2.0, 1.0, 1.5, 7.5 \), at times
\( 0, 1, 2, 3, 4 \), use the function in b) to interactively search
for \( a \) and \( b \) such that \( e \) is minimized.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_26_3" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_26_3">

<p>
The code may be written as follows

<p>

<!-- code=matlab (!bc mpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">interactive_line_fit</span>()<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>data = [<span style="color: #666666">0.5</span> <span style="color: #666666">2.0</span> <span style="color: #666666">1.0</span> <span style="color: #666666">1.5</span> <span style="color: #666666">7.5</span>];
    time = [<span style="color: #666666">0</span> <span style="color: #666666">1</span> <span style="color: #666666">2</span> <span style="color: #666666">3</span> <span style="color: #666666">4</span>];

    one_more = true;
    <span style="color: #008000; font-weight: bold">while</span> one_more
        a = input(<span style="color: #BA2121">&#39;Give a: &#39;</span>)
        b = input(<span style="color: #BA2121">&#39;Give b: &#39;</span>)
        error = find_error(time, data, a, b);
        fprintf(<span style="color: #BA2121">&#39;The error is: %g \n&#39;</span>, error);
        y = f(time, a, b);
        figure(); plot(time, y, time, data, <span style="color: #BA2121">&#39;*&#39;</span>); 
        xlabel(<span style="color: #BA2121">&#39;Time (s)&#39;</span>);
        ylabel(<span style="color: #BA2121">&#39;y (stars) and straight line f(t)&#39;</span>);
        answer = input(<span style="color: #BA2121">&#39;Do you want another fit (y/n)? &#39;</span>,<span style="color: #BA2121">&#39;s&#39;</span>);
        <span style="color: #008000; font-weight: bold">if</span> answer <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;n&#39;</span>
            one_more = false;
        <span style="color: #008000; font-weight: bold">end</span>
    <span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">end</span>

<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span>result =<span style="color: #bbbbbb"> </span><span style="color: #0000FF">f</span>(t, a, b)<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>result = a<span style="color: #666666">*</span>t <span style="color: #666666">+</span> b;
<span style="color: #008000; font-weight: bold">end</span>

<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span>result =<span style="color: #bbbbbb"> </span><span style="color: #0000FF">find_error</span>(time, data, a, b)<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>E = <span style="color: #666666">0</span>
    <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = <span style="color: #666666">1</span>:<span style="color: #008000">length</span>(time)
        E = E <span style="color: #666666">+</span> (f(time(<span style="color: #008000">i</span>),a,b) <span style="color: #666666">-</span> data(<span style="color: #008000">i</span>))^<span style="color: #666666">2</span>;
    <span style="color: #008000; font-weight: bold">end</span>
    result = E;
<span style="color: #008000; font-weight: bold">end</span>
</pre></div>
<p>
Running the program may produce this dialog
<p>

<!-- code=text (!bc dat) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">Give a: 1
Give b: 0
The error is: 16.75
</pre></div>
<p>
(followed by the plot seen in Figure <a href="#fig:fit_line_1">4</a>)

<p>
<center> <!-- figure label: --> <div id="fig:fit_line_1"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 4:  Straight line fitted to data with first choice of line parameters (a and b).  <!-- caption label: fig:fit_line_1 --> </p></center>
<p><img src="figs/fit_straight_line_1.png" align="bottom" width=400></p>
</center>

<p>

<!-- code=text (!bc dat) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">Do you want another fit (y/n)? y
Give a: 0.5
Give b: 1
The error is: 22.75
</pre></div>
<p>
(followed by the plot seen in Figure <a href="#fig:fit_line_2">5</a>)

<p>
<center> <!-- figure label: --> <div id="fig:fit_line_2"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 5:  Straight line fitted to data with second choice of line parameters (a and b).  <!-- caption label: fig:fit_line_2 --> </p></center>
<p><img src="figs/fit_straight_line_2.png" align="bottom" width=400></p>
</center>

<p>

<!-- code=text (!bc dat) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">Do you want another fit (y/n)? n
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
Filename: <code>fit_straight_line.m</code>.

<p>
<!-- Closing remarks for this Exercise -->

<h3 id="___sec66">Remarks </h3>

<p>
Fitting a straight line to measured data points is a very common
task. The manual search procedure in c) can be automated by using a
mathematical method called the <em>method of least squares</em>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="2nd:exer:fitSines">Exercise 27: Fit sines to straight line</h2>

<p>
<!-- solution=`sol_fit_sines.pdf` -->

<p>
A lot of technology, especially most types of digital audio devices
for processing sound, is based on representing a signal of time
as a sum of sine functions. Say the signal is some function \( f(t) \)
on the interval \( [-\pi,\pi] \) (a more general interval \( [a,b] \)
can easily be treated, but leads to slightly more complicated
formulas). Instead of working with \( f(t) \) directly,
we approximate \( f \) by the sum

$$
\begin{equation}
S_N(t) = \sum_{n=1}^{N} b_n \sin(nt),
\tag{2.1}
\end{equation}
$$

where the coefficients \( b_n \) must be adjusted such that \( S_N(t) \) is
a good approximation to \( f(t) \). We shall in this exercise adjust
\( b_n \) by a trial-and-error process.

<p>
<b>a)</b>
Make a function <code>sinesum(t, b)</code> that returns \( S_N(t) \), given the
coefficients \( b_n \) in an array <code>b</code> and time coordinates in an
array <code>t</code>. Note that if <code>t</code> is an array, the return value is also
an array.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_27_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_27_1">

<p>
See the script below.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>b)</b>
Write a function <code>test_sinesum()</code> that calls <code>sinesum(t, b)</code> in a)
and determines if the function computes a test case correctly.
As test case, let <code>t</code> be an array with values \( -\pi/2 \) and \( \pi/4 \),
choose \( N=2 \), and \( b_1=4 \) and \( b_2=-3 \). Compute \( S_N(t) \) by hand
to get reference values.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_27_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_27_2">

<p>
See the script below. Note that the call to <code>test_sinesum</code> is
commented out, but the function will step into action if the
leading <code>#</code> is removed.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>c)</b>
Make a function <code>plot_compare(f, N, M)</code> that plots the original
function \( f(t) \) together with the sum of sines \( S_N(t) \), so that
the quality of the approximation \( S_N(t) \) can be examined visually.
The argument <code>f</code> is a Matlab function implementing \( f(t) \), <code>N</code>
is the number of terms in the sum \( S_N(t) \), and <code>M</code> is the number
of uniformly distributed \( t \) coordinates used to plot \( f \) and \( S_N \).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_27_3" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_27_3">

<p>
See the script below.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>d)</b>
Write a function <code>error(b, f, M)</code> that returns a mathematical measure
of the error in \( S_N(t) \) as an approximation to \( f(t) \):

$$ E = \sqrt{\sum_{i} \left(f(t_i) - S_N(t_i)\right)^2},$$

where the \( t_i \) values are \( M \) uniformly distributed coordinates on
\( [-\pi, \pi] \).
The array <code>b</code> holds the coefficients in \( S_N \) and <code>f</code> is a Matlab
function implementing the mathematical function \( f(t) \).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_27_4" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_27_4">

<p>
See the script below.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>e)</b>
Make a function <code>trial(f, N)</code> for interactively giving \( b_n \)
values and getting a plot on the screen where the resulting
\( S_N(t) \) is plotted together with \( f(t) \). The error in the
approximation should also be computed as indicated in d).
The argument <code>f</code>
is a Matlab function for \( f(t) \) and <code>N</code> is the number of terms \( N \) in
the sum \( S_N(t) \). The <code>trial</code> function can run a loop where
the user is asked for the \( b_n \) values in each pass of the
loop and the corresponding plot is shown.
You must find a way to terminate the loop when the
experiments are over. Use <code>M=500</code> in the calls to <code>plot_compare</code>
and <code>error</code>.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_27_5" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_27_5">

<p>
See the script below. Note that the call to <code>trial</code> is
commented out, but the function will run if the leading <code>#</code> is removed.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>f)</b>
Choose \( f(t) \) to be a straight line
\( f(t) = \frac{1}{\pi}t \) on \( [-\pi,\pi] \). Call <code>trial(f, 3)</code>
and try to find through experimentation
some values \( b_1 \), \( b_2 \), and \( b_3 \) such that
the sum of sines \( S_N(t) \) is a good approximation to the straight line.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_27_6" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_27_6">

<p>
See the function <code>trial</code> in the script below.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>g)</b>
Now we shall try to automate the procedure in f). Write a function
that has three nested loops over values of \( b_1 \), \( b_2 \), and \( b_3 \).
Let each loop cover the interval \( [-1,1] \) in steps of \( 0.1 \). For each
combination of \( b_1 \), \( b_2 \), and \( b_3 \), the error in the approximation \( S_N \)
should be computed. Use this to find, and print, the smallest error and the
corresponding values of \( b_1 \), \( b_2 \), and \( b_3 \). Let the program also plot
\( f \) and the approximation \( S_N \) corresponding to the smallest error.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_27_7" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_27_7">

<p>
The code may be written as follows

<p>

<!-- code=matlab (!bc mpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">fit_sines</span>()<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span><span style="color: #408080; font-style: italic">% Search for b-values, - just pick limits and step</span>
    
    left_end = <span style="color: #666666">-</span><span style="color: #008000">pi</span>; right_end = <span style="color: #008000">pi</span>;
    N = <span style="color: #666666">3</span>;
    b = <span style="color: #008000">zeros</span>(N,<span style="color: #666666">1</span>);
    f = @(t) (<span style="color: #666666">1/</span><span style="color: #008000">pi</span>)<span style="color: #666666">*</span>t;
    
    M = <span style="color: #666666">500</span>;
    
    <span style="color: #408080; font-style: italic">%test_sinesum();</span>
    <span style="color: #408080; font-style: italic">%trial(left_end, right_end, f, b, N, M);</span>
    
    <span style="color: #408080; font-style: italic">% Produce and store an initially &quot;smallest&quot; error</span>
    b(<span style="color: #666666">1</span>) = <span style="color: #666666">-1</span>; b(<span style="color: #666666">2</span>) = <span style="color: #666666">-1</span>; b(<span style="color: #666666">3</span>) = <span style="color: #666666">-1</span>;
    test_b = b;
    smallest_E = error(left_end, right_end, test_b, f, M);
    db = <span style="color: #666666">0.1</span>;
    <span style="color: #008000; font-weight: bold">for</span> b1 = <span style="color: #666666">-1</span>:db:<span style="color: #666666">1</span>
        <span style="color: #008000; font-weight: bold">for</span> b2 = <span style="color: #666666">-1</span>:db:<span style="color: #666666">1</span>
            <span style="color: #008000; font-weight: bold">for</span> b3 = <span style="color: #666666">-1</span>:db:<span style="color: #666666">1</span>
                test_b(<span style="color: #666666">1</span>) = b1; test_b(<span style="color: #666666">2</span>) = b2; 
                test_b(<span style="color: #666666">3</span>) = b3;
                E = error(left_end, right_end, test_b, f, M);
                <span style="color: #008000; font-weight: bold">if</span> E <span style="color: #666666">&lt;</span> smallest_E
                    b = test_b;
                    smallest_E = E;
                <span style="color: #008000; font-weight: bold">end</span>
            <span style="color: #008000; font-weight: bold">end</span>
        <span style="color: #008000; font-weight: bold">end</span>
    <span style="color: #008000; font-weight: bold">end</span>
    b
    plot_compare(left_end, right_end, f, b, N, M)
    fprintf(<span style="color: #BA2121">&#39;b coeffiecients: %g %g and %g \n&#39;</span>, b(<span style="color: #666666">1</span>), b(<span style="color: #666666">2</span>), b(<span style="color: #666666">3</span>));
    fprintf(<span style="color: #BA2121">&#39;Smallest error found: %g \n&#39;</span>, smallest_E);
<span style="color: #008000; font-weight: bold">end</span>

<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span>result =<span style="color: #bbbbbb"> </span><span style="color: #0000FF">sinesum</span>(t, b)<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span><span style="color: #408080; font-style: italic">% Computes S as the sum over n of b_n * sin(n*t)</span>
    <span style="color: #408080; font-style: italic">% For each point in time (M) we loop over all b_n to </span>
    <span style="color: #408080; font-style: italic">% produce one element S(M), i.e. one element in</span>
    <span style="color: #408080; font-style: italic">% S corresponds to one point in time.</span>
    S = <span style="color: #008000">zeros</span>(<span style="color: #008000">length</span>(t),<span style="color: #666666">1</span>);
    <span style="color: #008000; font-weight: bold">for</span> M = <span style="color: #666666">1</span>:<span style="color: #008000">length</span>(t)
        <span style="color: #008000; font-weight: bold">for</span> n = <span style="color: #666666">1</span>:<span style="color: #008000">length</span>(b)
            S(M) = S(M) <span style="color: #666666">+</span> b(n)<span style="color: #666666">*</span><span style="color: #008000">sin</span>(n<span style="color: #666666">*</span>t(M));
        <span style="color: #008000; font-weight: bold">end</span>
    <span style="color: #008000; font-weight: bold">end</span>
    result = S;
<span style="color: #008000; font-weight: bold">end</span>

<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">test_sinesum</span>()<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>t = <span style="color: #008000">zeros</span>(<span style="color: #666666">2</span>,<span style="color: #666666">1</span>); t(<span style="color: #666666">1</span>) = <span style="color: #666666">-</span><span style="color: #008000">pi</span><span style="color: #666666">/2</span>; t(<span style="color: #666666">2</span>) = <span style="color: #008000">pi</span><span style="color: #666666">/4</span>;
    b = <span style="color: #008000">zeros</span>(<span style="color: #666666">2</span>,<span style="color: #666666">1</span>); b(<span style="color: #666666">1</span>) = <span style="color: #666666">4.0</span>; b(<span style="color: #666666">2</span>) = <span style="color: #666666">-3</span>;
    sinesum(t,b)
<span style="color: #008000; font-weight: bold">end</span>

<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">plot_compare</span>(left_end, right_end, f, b, N, M)<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>time = <span style="color: #008000">linspace</span>(left_end, right_end, M);
    y = f(time);
    S = sinesum(time, b);
    plot(time, y, <span style="color: #BA2121">&#39;b-&#39;</span>, time, S, <span style="color: #BA2121">&#39;r--&#39;</span>);
    xlabel(<span style="color: #BA2121">&#39;Time&#39;</span>);
    ylabel(<span style="color: #BA2121">&#39;f (blue) and S (red)&#39;</span>);
<span style="color: #008000; font-weight: bold">end</span>

<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span>result =<span style="color: #bbbbbb"> </span><span style="color: #0000FF">error</span>(left_end, right_end, b, f, M)<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>time = <span style="color: #008000">linspace</span>(left_end, right_end, M);
    y = f(time);
    S = sinesum(time, b);
    E = <span style="color: #666666">0</span>;
    <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = <span style="color: #666666">1</span>:<span style="color: #008000">length</span>(time)
        E = E <span style="color: #666666">+</span> <span style="color: #008000">sqrt</span>((y(<span style="color: #008000">i</span>) <span style="color: #666666">-</span> S(<span style="color: #008000">i</span>))^<span style="color: #666666">2</span>);
    <span style="color: #008000; font-weight: bold">end</span>
    result = E;
<span style="color: #008000; font-weight: bold">end</span>

<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">trial</span>(left_end, right_end, f, b, N, M)<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>M = <span style="color: #666666">500</span>;
    new_trial = true;
    <span style="color: #008000; font-weight: bold">while</span> new_trial
        <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = <span style="color: #666666">1</span>:N
            text = strcat(<span style="color: #BA2121">&#39;Give b&#39;</span>, num2str(<span style="color: #008000">i</span>), <span style="color: #BA2121">&#39; : \n&#39;</span>);
            b(<span style="color: #008000">i</span>) = input(text);
        <span style="color: #008000; font-weight: bold">end</span>
        plot_compare(left_end, right_end, f, b, N, M)
        fprintf(<span style="color: #BA2121">&#39;Error: \n&#39;</span>,error(left_end, right_end, b, f, M));
        answer = input(<span style="color: #BA2121">&#39;Another trial (y/n)? &#39;</span>,<span style="color: #BA2121">&#39;s&#39;</span>);
        <span style="color: #008000; font-weight: bold">if</span> answer <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;n&#39;</span>
            new_trial = false;
        <span style="color: #008000; font-weight: bold">end</span>
    <span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">end</span>
</pre></div>
<p>
Running the program may produce this dialog

<p>

<!-- code=text (!bc dat) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">The b coefficients: [ 0.6 -0.2 0.1 ]
The smallest error found: 67.1213886326
</pre></div>
<p>
and the plot seen in Figure <a href="#fig:fit_sines">6</a>

<p>
<center> <!-- figure label: --> <div id="fig:fit_sines"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 6:  Straight line fitted to data with first choice of line parameters (a and b).  <!-- caption label: fig:fit_sines --> </p></center>
<p><img src="figs/fit_sines.png" align="bottom" width=400></p>
</center>

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
Filename: <code>fit_sines.m</code>.

<p>
<!-- Closing remarks for this Exercise -->

<h3 id="___sec68">Remarks </h3>

<ol>
<li> The function \( S_N(x) \) is a special case of what is called a <em>Fourier series</em>. At the beginning of the 19th century, Joseph Fourier (1768-1830) showed that any function can be approximated analytically by a sum of cosines and sines. The approximation improves as the number of terms (\( N \)) is increased. Fourier series are very important throughout science and engineering today.

<ol type="a"></li>
<li> Finding the coefficients \( b_n \) is solved much more accurately in <a href="._p4c-bootstrap-Matlab017.html#sec:exer:revisitFitSines">Exercise 40: Revisit fit of sines to a function</a>, by a procedure that also requires much less human and computer work!</li>
<li> In real applications, \( f(t) \) is not known as a continuous function, but function values of \( f(t) \) are provided. For example, in digital sound applications, music in a CD-quality WAV file is a signal with 44100 samples of the corresponding analog signal \( f(t) \) per second.</li>
</ol>

</ol>

<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="2nd:exer:countTextString">Exercise 28: Count occurrences of a string in a string</h2>

<p>
<!-- solution=`count_substrings.pdf` -->

<p>
In the analysis of genes one encounters many problem settings
involving searching for certain combinations of letters in a long
string. For example, we may have a string like

<p>

<!-- code=text (!bc cod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">gene = &#39;AGTCAATGGAATAGGCCAAGCGAATATTTGGGCTACCA&#39;
</pre></div>
<p>
We may traverse this string letter by letter. The length of the string
is given by <code>length(gene)</code>, so with a loop index <code>i</code>, <code>for i = 1:length(gene)</code>
will produce the required index values. Letter number <code>i</code> is then reached through
<code>gene(i)</code>, and a substring from index <code>i</code> up to and including <code>j</code>,
is created by <code>gene(i:j)</code>.

<p>
<b>a)</b>
Write a function <code>freq(letter, text)</code> that returns the frequency of the
letter <code>letter</code> in the string <code>text</code>, i.e., the number of occurrences of
<code>letter</code> divided by the length of <code>text</code>.
Call the function to determine the frequency of <code>C</code> and <code>G</code> in the
<code>gene</code> string above. Compute the frequency by hand too.

<p>
<b>b)</b>
Write a function <code>pairs(letter, text)</code>
that counts how many times a pair of the letter <code>letter</code> (e.g., <code>GG</code>)
occurs within the string <code>text</code>. Use the function to determine
how many times the pair <code>AA</code> appears in the string <code>gene</code> above.
Perform a manual counting too to check the answer.

<p>
<b>c)</b>
Write a function <code>mystruct(text)</code> that counts the number of a certain
structure in the string <code>text</code>. The structure is defined as <code>G</code> followed by
<code>A</code> or <code>T</code> until a double <code>GG</code>. Perform a manual search for the structure
too to control the computations by <code>mystruct</code>.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_28_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_28_1">

<p>
Here is a program:

<p>

<!-- code=matlab (!bc mpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">count_substrings</span>()<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>gene = <span style="color: #BA2121">&#39;AGTCAATGGAATAGGCCAAGCGAATATTTGGGCTACCA&#39;</span>;

    fprintf(<span style="color: #BA2121">&#39;frequency of C: %.1f\n&#39;</span>, freq(<span style="color: #BA2121">&#39;C&#39;</span>, gene));
    fprintf(<span style="color: #BA2121">&#39;frequency of G: %.1f\n&#39;</span>, freq(<span style="color: #BA2121">&#39;G&#39;</span>, gene));
    fprintf(<span style="color: #BA2121">&#39;no of pairs AA: %d\n&#39;</span>, pairs(<span style="color: #BA2121">&#39;A&#39;</span>, gene));
    fprintf(<span style="color: #BA2121">&#39;no of structures: %d\n&#39;</span>, mystruct(gene));
<span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">    </span>
<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span>result =<span style="color: #bbbbbb"> </span><span style="color: #0000FF">freq</span>(letter, text)<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>counter = <span style="color: #666666">0</span>;
    <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = <span style="color: #666666">1</span>:<span style="color: #008000">length</span>(text)
        <span style="color: #008000; font-weight: bold">if</span> text(<span style="color: #008000">i</span>) <span style="color: #666666">==</span> letter
            counter = counter <span style="color: #666666">+</span> <span style="color: #666666">1</span>;
        <span style="color: #008000; font-weight: bold">end</span>
    <span style="color: #008000; font-weight: bold">end</span>
    result = counter<span style="color: #666666">/</span><span style="color: #008000">length</span>(text);
<span style="color: #008000; font-weight: bold">end</span>

<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span>result =<span style="color: #bbbbbb"> </span><span style="color: #0000FF">pairs</span>(letter, text)<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>counter = <span style="color: #666666">0</span>;
    <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = <span style="color: #666666">1</span>:<span style="color: #008000">length</span>(text)
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">i</span> <span style="color: #666666">&lt;</span>= <span style="color: #008000">length</span>(text)<span style="color: #666666">-1</span> <span style="color: #666666">&amp;&amp;</span> text(<span style="color: #008000">i</span>) <span style="color: #666666">==</span> letter<span style="color: #408080; font-style: italic">...</span>
                               <span style="color: #666666">&amp;&amp;</span> text(<span style="color: #008000">i</span><span style="color: #666666">+1</span>) <span style="color: #666666">==</span> letter
            counter = counter <span style="color: #666666">+</span> <span style="color: #666666">1</span>;
        <span style="color: #008000; font-weight: bold">end</span>
    <span style="color: #008000; font-weight: bold">end</span>
    result = counter;
<span style="color: #008000; font-weight: bold">end</span>

<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span>result =<span style="color: #bbbbbb"> </span><span style="color: #0000FF">mystruct</span>(text)<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>counter = <span style="color: #666666">0</span>;
    <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = <span style="color: #666666">1</span>:<span style="color: #008000">length</span>(text)
        <span style="color: #408080; font-style: italic">%% Search for the structure from position i</span>
        <span style="color: #008000; font-weight: bold">if</span> text(<span style="color: #008000">i</span>) <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;G&#39;</span>
            fprintf(<span style="color: #BA2121">&#39;found G at %d\n&#39;</span>, <span style="color: #008000">i</span>);
            <span style="color: #408080; font-style: italic">%% Search among A and T letters</span>
            <span style="color: #008000">j</span> = <span style="color: #008000">i</span> <span style="color: #666666">+</span> <span style="color: #666666">1</span>;
            <span style="color: #008000; font-weight: bold">while</span> text(<span style="color: #008000">j</span>) <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;A&#39;</span> <span style="color: #666666">||</span> text(<span style="color: #008000">j</span>) <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;T&#39;</span>
                fprintf(<span style="color: #BA2121">&#39;next is ok: %s\n&#39;</span>, text(<span style="color: #008000">j</span>));
                <span style="color: #008000">j</span> = <span style="color: #008000">j</span> <span style="color: #666666">+</span> <span style="color: #666666">1</span>;
            <span style="color: #008000; font-weight: bold">end</span>
            fprintf(<span style="color: #BA2121">&#39;ending is %s\n&#39;</span>, text(<span style="color: #008000">j</span>:<span style="color: #008000">j</span><span style="color: #666666">+1</span>));
            <span style="color: #008000; font-weight: bold">if</span> text(<span style="color: #008000">j</span>:<span style="color: #008000">j</span><span style="color: #666666">+1</span>) <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;GG&#39;</span>
                <span style="color: #408080; font-style: italic">%% Correct ending of structure</span>
                counter = counter <span style="color: #666666">+</span> <span style="color: #666666">1</span>;
                fprintf(<span style="color: #BA2121">&#39;yes\n&#39;</span>);
            <span style="color: #008000; font-weight: bold">end</span>
        <span style="color: #008000; font-weight: bold">end</span>
    <span style="color: #008000; font-weight: bold">end</span>
    result = counter;
<span style="color: #008000; font-weight: bold">end</span>
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
Filename: <code>count_substrings.m</code>.

<p>
<!-- --- end exercise --- -->

<p>
<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">
  <li class="previous">
    <a href="._p4c-bootstrap-Matlab012.html">&larr; Prev</a>
  </li>
  <li class="next">
    <a href="._p4c-bootstrap-Matlab014.html">Next &rarr;</a>
  </li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


</body>
</html>
    

