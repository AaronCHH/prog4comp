<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Programming for Computations - A Gentle Introduction to Numerical Simulations with MATLAB/Octave">
<meta name="keywords" content="DocOnce,computer program,programming,language programming,language computer,MATLAB,Octave,Fortran,C,C++,Python,Maple,Mathematica,syntax,bug,debugging,script (and scripting),algorithm,execute (a program),implement (a program),bug,debugging,simulation,model mathematical,print,program run,program execute,code,comment,instruction,program statement,variable,assignment,semi-colon (easy print),calculator,text editor,Emacs,Vim,Gedit,Notepad++,TextWrangler,prompt,program typing,program run,program execute,m-file,function,function call,atan,function input parameter,function output parameter,function return,function take a parameter,plot,linspace,xlabel,ylabel,plot,array,interactive use (of Matlab),keyboard arrow up/down,prompt,operator Arithmetic,parentheses,rounding error,variable type,variable name,float,integer,string,type conversion,reserved words,variable integer,variable float,variable string,variable assignment,default,single (precision),double (precision),printing formatted,printf formatting,default,array,array element,zeros,allocate,array index,indexing zero based,indexing one based,Matlab one-based indexing,array slice of,copy,graph,hold (on/off),plot figure,title (plot),legend (plot),axis (plot),hardcopy (plot),format png,matrix vector product,linear algebra,matrix,vector,error message,debugging,debugger,try-catch,exception handling,program crash,program testing,testing,program verification,verification,validation,program input,program output,input,symbolic computations,symbolic operations,symbolic simplifications,Symbolic Toolbox,WolframAlpha,Mathematica,Sage (symbolic package),variable delete,Matlab documentation,Matlab licence,long lines (splitting of),fast code,Matlab indent,commenting code,if,elseif,else,end,boolean,boolean expression,true (1),false (0),boolean true (1),boolean false (0),pseudo code,random walk,rand (function),operator Logical,function,function definition,return,argument,parameter input,parameter output,main program,return value,function nargin,function nargout,variable local,variable global,doc string,function handle,function local,function global,function nested,anonymous function,function anonymous,loop for,for loop,loop iteration,loop index,loop double,loop multiple,loop nested,linear algebra,while loop,loop while,loop infinite,loop iteration,loop index,stop program (Ctrl+c),read (from file),write (to file),array sorting,Leibniz pi,Euler pi,programming game,linear interpolation,least squares method,Fourier series,integral analytically,integral exact,integral numerically,integral approximately,Trapezoidal rule,composite trapezoidal rule,integration points,implementation specific,implementation general,code re-use,flat program,program flat,error function (erf),Midpoint method,composite midpoint method,Simpson's rule,Gauss quadrature,bug,unit tests,testing procedures,convergence rate,rate of convergence,error asymptotic,finite precision (of float),floating point number (float),error rounding,error tolerance,difference absolute,difference relative,assert (function),function assert,test function,vectorization,computational speed (measuring),domain,double integral midpoint,double sum,code re-use,triple integral midpoint,domain,domain complex,domain,Monte Carlo integration,seed (random generators),dynamical system,scheme,differential equation first-order,model mathematical,model differential equation,model computational,exp math notation,finite difference method,mesh,mesh uniform,mesh points,forward difference approximation,difference forward,Forward Euler scheme,Euler's method,numerical scheme,demo function,logistic model carrying capacity,SIR model,compartment model,mathematical modeling,scalar ODE,ODE scalar,vector ODE,ODE vector,system of ODEs,discontinuous coefficient,spring oscillations,spring damping of,differential equation second-order,simple pendulum,second-order ODE rewritten as two first-order ODEs,difference forward,difference backward,Heun's method,Runge-Kutta, 2nd-order method,2nd-order Runge-Kutta method,RK2,difference centered,nonlinear algebraic equation,ode45,ode23s,Runge-Kutta-Fehlberg,Crank-Nicolson method,spring damping of,spring nonlinear,spring linear,scaling,resonance,Verlet integration,Crank-Nicolson method,Taylor series,PDE,heat equation,diffusion equation,source term,domain,initial conditions,boundary conditions,MOL forward Euler,method of lines,MOL,mesh points,cell,method of lines,unstable solutions,instability,stability criterion,scaling,vectorization,tridiagonal matrix,matrix tridiagonal,theta rule,Poisson equation,Laplace equation,root finding,brute force method,code robust,divergence,code exception,code try-catch,Newton starting value,return None,rate of convergence">

<title>Programming for Computations - A Gentle Introduction to Numerical Simulations with MATLAB/Octave</title>

<!-- Bootstrap style: bootswatch_journal -->
<link href="http://netdna.bootstrapcdn.com/bootswatch/3.1.1/journal/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }
/* Let pre tags for code blocks have the same color as the surroundings */
pre { color: inherit; background-color: transparent; }

/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}
</style>


</head>

<!-- tocinfo
{'highest level': 0,
 'sections': [(u'Preface', 0, None, '___sec0'),
              (u'Why learn programming?', 3, None, '___sec1'),
              (u'Target audience and background knowledge',
               3,
               None,
               '___sec2'),
              (u'Numerical methods', 3, None, '___sec3'),
              (u'The computer language: Matlab', 3, None, '___sec4'),
              (u'How this book is different', 3, None, '___sec5'),
              (u'Supplementary materials', 3, None, '___sec6'),
              (u'Acknowledgments', 3, None, '___sec7'),
              (u'The first few steps',
               0,
               u'1st:TheFirstFewSteps',
               u'1st:TheFirstFewSteps'),
              (u'What is a program? And what is programming?',
               1,
               None,
               '___sec9'),
              (u'A Matlab program with variables', 1, u'1st:ex1', u'1st:ex1'),
              (u'The program', 2, None, '___sec11'),
              (u'Dissection of the program', 2, None, '___sec12'),
              (u'Why not just use a pocket calculator?', 2, None, '___sec13'),
              (u'Why you must use a text editor to write programs',
               2,
               None,
               '___sec14'),
              (u'Write and run your first program', 2, None, '___sec15'),
              (u'Write and run a program in Matlab', 3, None, '___sec16'),
              (u'Write a program in a text editor and run it in Octave',
               3,
               None,
               '___sec17'),
              (u'A Matlab program with a library function',
               1,
               u'1st:ex2',
               u'1st:ex2'),
              (u'A Matlab program with vectorization and plotting',
               1,
               u'1st:ex3',
               u'1st:ex3'),
              (u'More basic concepts', 1, None, '___sec20'),
              (u'Using Matlab interactively', 2, None, '___sec21'),
              (u'Arithmetics, parentheses and rounding errors',
               2,
               None,
               '___sec22'),
              (u'Variables', 2, None, '___sec23'),
              (u'Formatting text and numbers', 2, None, '___sec24'),
              (u'Arrays', 2, None, '___sec25'),
              (u'Plotting', 2, None, '___sec26'),
              (u'Error messages and warnings', 2, None, '___sec27'),
              (u'Input data', 2, None, '___sec28'),
              (u'Symbolic computations', 2, None, '___sec29'),
              (u'Concluding remarks', 2, None, '___sec30'),
              (u'Exercises', 1, None, '___sec31'),
              (u'Exercise 1: Error messages',
               2,
               u'1st:exer:ErrorMessages',
               u'1st:exer:ErrorMessages'),
              (u'Exercise 2: Volume of a cube',
               2,
               u'1st:exer:cubeVolume',
               u'1st:exer:cubeVolume'),
              (u'Exercise 3: Area and circumference of a circle',
               2,
               u'1st:exer:areaCircle',
               u'1st:exer:areaCircle'),
              (u'Exercise 4: Volumes of three cubes',
               2,
               u'1st:exer:volumes3cubes',
               u'1st:exer:volumes3cubes'),
              (u'Exercise 5: Average of integers',
               2,
               u'1st:exer:averageOf5Integers',
               u'1st:exer:averageOf5Integers'),
              (u'Exercise 6: Interactive computing of volume and area',
               2,
               u'1st:exer:cubeVolInteractively',
               u'1st:exer:cubeVolInteractively'),
              (u'Exercise 7: Update variable at command prompt',
               2,
               u'1st:exer:updateVarInteractively',
               u'1st:exer:updateVarInteractively'),
              (u'Exercise 8: Formatted print to screen',
               2,
               u'1st:exer:printfScreen',
               u'1st:exer:printfScreen'),
              (u'Exercise 9: Matlab documentation and random numbers',
               2,
               u'1st:exer:PythonDocRandom',
               u'1st:exer:PythonDocRandom'),
              (u'Basic constructions',
               0,
               u'2nd:BasicConstructins',
               u'2nd:BasicConstructins'),
              (u'If tests', 1, None, '___sec42'),
              (u'Functions', 1, u'sec:functions', u'sec:functions'),
              (u'For loops', 1, u'sec:for:loops', u'sec:for:loops'),
              (u'While loops', 1, u'sec:while:loops', u'sec:while:loops'),
              (u'Reading from and writing to files',
               1,
               u'sec:file:reading:writing',
               u'sec:file:reading:writing'),
              (u'Exercises', 1, None, '___sec47'),
              (u'Exercise 10: Introducing errors',
               2,
               u'2nd:exer:IntroducingErrors',
               u'2nd:exer:IntroducingErrors'),
              (u'Exercise 11: Compare integers a and b',
               2,
               u'2nd:exer:compInt',
               u'2nd:exer:compInt'),
              (u'Exercise 12: Functions for circumference and area of a circle',
               2,
               u'2nd:exer:funcCircArea',
               u'2nd:exer:funcCircArea'),
              (u'Exercise 13: Function for area of a rectangle',
               2,
               u'2nd:exer:funcAreaRectangle',
               u'2nd:exer:funcAreaRectangle'),
              (u'Exercise 14: Area of a polygon',
               2,
               u'2nd:exer:area:polygon',
               u'2nd:exer:area:polygon'),
              (u'Exercise 15: Average of integers',
               2,
               u'2nd:exer:avNInt',
               u'2nd:exer:avNInt'),
              (u'Exercise 16: While loop with errors',
               2,
               u'2nd:exer:whileLoopErrors',
               u'2nd:exer:whileLoopErrors'),
              (u'Exercise 17: Area of rectangle versus circle',
               2,
               u'2nd:exer:areaRectCircle',
               u'2nd:exer:areaRectCircle'),
              (u'Exercise 18: Find crossing points of two graphs',
               2,
               u'2nd:exer:Cross2Graphs',
               u'2nd:exer:Cross2Graphs'),
              (u'Exercise 19: Sort array with numbers',
               2,
               u'2nd:exer:sortNumbers',
               u'2nd:exer:sortNumbers'),
              (u'Exercise 20: Compute $\\pi$',
               2,
               u'2nd:exer:computingPi',
               u'2nd:exer:computingPi'),
              (u'Exercise 21: Compute combinations of sets',
               2,
               u'2nd:exer:combinatorics1',
               u'2nd:exer:combinatorics1'),
              (u'Exercise 22: Frequency of random numbers',
               2,
               u'2nd:exer:numberOccurrence',
               u'2nd:exer:numberOccurrence'),
              (u'Remarks', 3, None, '___sec61'),
              (u'Exercise 23: Game 21',
               2,
               u'2nd:exer:Game21',
               u'2nd:exer:Game21'),
              (u'Exercise 24: Linear interpolation',
               2,
               u'2nd:exer:linearInterpol',
               u'2nd:exer:linearInterpol'),
              (u'Exercise 25: Test straight line requirement',
               2,
               u'2nd:exer:testStraightLine',
               u'2nd:exer:testStraightLine'),
              (u'Exercise 26: Fit straight line to data',
               2,
               u'2nd:exer:fitLine',
               u'2nd:exer:fitLine'),
              (u'Remarks', 3, None, '___sec66'),
              (u'Exercise 27: Fit sines to straight line',
               2,
               u'2nd:exer:fitSines',
               u'2nd:exer:fitSines'),
              (u'Remarks', 3, None, '___sec68'),
              (u'Exercise 28: Count occurrences of a string in a string',
               2,
               u'2nd:exer:countTextString',
               u'2nd:exer:countTextString'),
              (u'Computing integrals', 0, u'sec:integrals', u'sec:integrals'),
              (u'Basic ideas of numerical integration',
               1,
               u'sec:integrals:basic',
               u'sec:integrals:basic'),
              (u'Computational example', 3, None, '___sec72'),
              (u'The composite trapezoidal rule',
               1,
               u'sec:integrals:trap',
               u'sec:integrals:trap'),
              (u'The general formula',
               2,
               u'sec:integrals:formula',
               u'sec:integrals:formula'),
              (u'Implementation',
               2,
               u'sec:integrals:trap:impl',
               u'sec:integrals:trap:impl'),
              (u'Specific or general implementation?', 3, None, '___sec76'),
              (u'Implementation with functions', 3, None, '___sec77'),
              (u'Solving our specific problem in a session',
               3,
               None,
               '___sec78'),
              (u'Solving our specific problem in a program',
               3,
               None,
               '___sec79'),
              (u'Alternative flat special-purpose implementation',
               2,
               None,
               '___sec80'),
              (u'The composite midpoint method',
               1,
               u'sec:integrals:Midpoint',
               u'sec:integrals:Midpoint'),
              (u'The idea', 3, None, '___sec82'),
              (u'The general formula', 2, None, '___sec83'),
              (u'Implementation',
               2,
               u'sec:midpoint:code',
               u'sec:midpoint:code'),
              (u'Comparing the trapezoidal and the midpoint methods',
               2,
               None,
               '___sec85'),
              (u'Testing', 1, None, '___sec86'),
              (u'Problems with brief testing procedures',
               2,
               None,
               '___sec87'),
              (u'Proper test procedures',
               2,
               u'sec:integrals:testprocs',
               u'sec:integrals:testprocs'),
              (u'Hand-computed results', 3, None, '___sec89'),
              (u'Solving a problem without numerical errors',
               3,
               None,
               '___sec90'),
              (u'Demonstrating correct convergence rates',
               3,
               None,
               '___sec91'),
              (u'Finite precision of floating-point numbers',
               2,
               u'sec:integrals:finite_prec',
               u'sec:integrals:finite_prec'),
              (u'Constructing unit tests and writing test functions',
               2,
               u'sec:integrals:test:functions',
               u'sec:integrals:test:functions'),
              (u'Hand-computed numerical results', 3, None, '___sec94'),
              (u'Solving a problem without numerical errors',
               3,
               None,
               '___sec95'),
              (u'Demonstrating correct convergence rates',
               3,
               None,
               '___sec96'),
              (u'Vectorization', 1, None, '___sec97'),
              (u'Vectorizing the midpoint rule', 3, None, '___sec98'),
              (u'Vectorizing the trapezoidal rule', 3, None, '___sec99'),
              (u'Measuring computational speed', 1, None, '___sec100'),
              (u'Double and triple integrals',
               1,
               u'sec:int:double',
               u'sec:int:double'),
              (u'The midpoint rule for a double integral',
               2,
               u'sec:int:double:midpoint',
               u'sec:int:double:midpoint'),
              (u'Derivation via one-dimensional integrals',
               3,
               None,
               '___sec103'),
              (u'Direct derivation', 3, None, '___sec104'),
              (u'Programming a double sum', 3, None, '___sec105'),
              (u'Reusing code for one-dimensional integrals',
               3,
               None,
               '___sec106'),
              (u'Verification via test functions', 3, None, '___sec107'),
              (u'The midpoint rule for a triple integral',
               2,
               None,
               '___sec108'),
              (u'Theory', 3, None, '___sec109'),
              (u'Implementation', 3, None, '___sec110'),
              (u'Monte Carlo integration for complex-shaped domains',
               2,
               u'sec:int:complex:domain',
               u'sec:int:complex:domain'),
              (u'The Monte Carlo integration algorithm',
               3,
               None,
               '___sec112'),
              (u'Implementation', 3, None, '___sec113'),
              (u'Verification', 3, None, '___sec114'),
              (u'Test function for function with random numbers',
               3,
               None,
               '___sec115'),
              (u'Integral over a circle', 3, None, '___sec116'),
              (u'Exercises', 1, None, '___sec117'),
              (u'Exercise 29: Hand calculations for the trapezoidal method',
               2,
               u'sec:exer:trap:hand',
               u'sec:exer:trap:hand'),
              (u'Exercise 30: Hand calculations for the midpoint method',
               2,
               u'sec:exer:midpt:hand',
               u'sec:exer:midpt:hand'),
              (u'Exercise 31: Compute a simple integral',
               2,
               u'sec:exer:trap:mid:parabola',
               u'sec:exer:trap:mid:parabola'),
              (u'Exercise 32: Hand-calculations with sine integrals',
               2,
               u'sec:exer:hand:sine',
               u'sec:exer:hand:sine'),
              (u'Exercise 33: Make test functions for the midpoint method',
               2,
               u'sec:exer:test:midpoint',
               u'sec:exer:test:midpoint'),
              (u'Exercise 34: Explore rounding errors with large numbers',
               2,
               u'sec:exer:test:roundoff',
               u'sec:exer:test:roundoff'),
              (u'Exercise 35: Write test functions for $\\int_0^4\\sqrt{x}dx$',
               2,
               u'sec:exer:test:convrates:sqrt',
               u'sec:exer:test:convrates:sqrt'),
              (u'Remarks', 3, None, '___sec125'),
              (u'Exercise 36: Rectangle methods',
               2,
               u'sec:exer:rectangleMethod',
               u'sec:exer:rectangleMethod'),
              (u'Exercise 37: Adaptive integration',
               2,
               u'sec:exer:adaptive:int',
               u'sec:exer:adaptive:int'),
              (u'Remarks', 3, None, '___sec128'),
              (u'Exercise 38: Integrating x raised to x',
               2,
               u'sec:exer:integrate:x2x',
               u'sec:exer:integrate:x2x'),
              (u'Exercise 39: Integrate products of sine functions',
               2,
               u'sec:exer:sine:products',
               u'sec:exer:sine:products'),
              (u'Exercise 40: Revisit fit of sines to a function',
               2,
               u'sec:exer:revisitFitSines',
               u'sec:exer:revisitFitSines'),
              (u'Exercise 41: Derive the trapezoidal rule for a double integral',
               2,
               u'sec:exer:trapezoidal:2D',
               u'sec:exer:trapezoidal:2D'),
              (u'Exercise 42: Compute the area of a triangle by Monte Carlo integration',
               2,
               u'sec:exer:MC:ellipse',
               u'sec:exer:MC:ellipse'),
              (u'Solving ordinary differential equations',
               0,
               u'5th:SolvODEs',
               u'5th:SolvODEs'),
              (u'Population growth', 1, u'sec:de:pg', u'sec:de:pg'),
              (u'Derivation of the model',
               2,
               u'sec:de:pg:model',
               u'sec:de:pg:model'),
              (u'Numerical solution',
               2,
               u'sec:de:pg:numerics',
               u'sec:de:pg:numerics'),
              (u'Programming the Forward Euler scheme; the special case',
               2,
               u'sec:de:pg:prog1',
               u'sec:de:pg:prog1'),
              (u'Understanding the Forward Euler method',
               2,
               u'sec:de:pg:geom',
               u'sec:de:pg:geom'),
              (u'Programming the Forward Euler scheme; the general case',
               2,
               u'sec:de:FE:gen',
               u'sec:de:FE:gen'),
              (u'Making the population growth model more realistic',
               2,
               None,
               '___sec141'),
              (u'Verification: exact linear solution of the discrete equations',
               2,
               u'sec:de:growth:test:linear',
               u'sec:de:growth:test:linear'),
              (u'Spreading of diseases', 1, None, '___sec143'),
              (u'Spreading of a flu', 2, u'sec:de:flu', u'sec:de:flu'),
              (u'A Forward Euler method for the differential equation system',
               2,
               u'sec:de:flu:FE',
               u'sec:de:flu:FE'),
              (u'Programming the numerical method; the special case',
               2,
               u'sec:de:flu:prog:spec',
               u'sec:de:flu:prog:spec'),
              (u'Outbreak or not', 2, None, '___sec147'),
              (u'Abstract problem and notation',
               2,
               u'sec:de:flu:generic',
               u'sec:de:flu:generic'),
              (u'Programming the numerical method; the general case',
               2,
               u'sec:de:flu:prog:generic',
               u'sec:de:flu:prog:generic'),
              (u'Time-restricted immunity', 2, None, '___sec150'),
              (u'Incorporating vaccination',
               2,
               u'sec:de:flu:vaccine',
               u'sec:de:flu:vaccine'),
              (u'Discontinuous coefficients: a vaccination campaign',
               2,
               u'sec:de:flu:vaccine:discont',
               u'sec:de:flu:vaccine:discont'),
              (u'Oscillating one-dimensional systems',
               1,
               u'sec:de:vib',
               u'sec:de:vib'),
              (u'Derivation of a simple model', 2, None, '___sec154'),
              (u'Numerical solution', 2, None, '___sec155'),
              (u'Programming the numerical method; the special case',
               2,
               u'sec:de:vib:special',
               u'sec:de:vib:special'),
              (u'A magic fix of the numerical method', 2, None, '___sec157'),
              (u"The 2nd-order Runge-Kutta method (or Heun's method)",
               2,
               u'sec:de:osc:Heun',
               u'sec:de:osc:Heun'),
              (u'Software for solving ODEs',
               2,
               u'sec:de:osc:odespy',
               u'sec:de:osc:odespy'),
              (u'The 4th-order Runge-Kutta method', 2, None, '___sec160'),
              (u'The algorithm', 3, None, '___sec161'),
              (u'Application', 3, None, '___sec162'),
              (u'Implementation', 3, None, '___sec163'),
              (u'Derivation', 3, None, '___sec164'),
              (u'More effects: damping, nonlinearity, and external forces',
               2,
               None,
               '___sec165'),
              (u'The Euler-Cromer scheme', 3, None, '___sec166'),
              (u'The 4-th order Runge-Kutta method', 3, None, '___sec167'),
              (u'Illustration of linear damping', 2, None, '___sec168'),
              (u'Illustration of linear damping with sinusoidal excitation',
               2,
               None,
               '___sec169'),
              (u'Spring-mass system with sliding friction',
               2,
               u'sec:de:vib:ode2:sliding:friction',
               u'sec:de:vib:ode2:sliding:friction'),
              (u'A finite difference method; undamped, linear case',
               2,
               u'sec:de:vib:2nd',
               u'sec:de:vib:2nd'),
              (u'A finite difference method; linear damping',
               2,
               u'sec:de:vib:2nd:damped1',
               u'sec:de:vib:2nd:damped1'),
              (u'Exercises', 1, None, '___sec173'),
              (u'Exercise 43: Geometric construction of the Forward Euler method',
               2,
               u'sec:de:exer:geom',
               u'sec:de:exer:geom'),
              (u'Exercise 44: Make test functions for the Forward Euler method',
               2,
               u'sec:de:exer:FE:test1',
               u'sec:de:exer:FE:test1'),
              (u"Exercise 45: Implement and evaluate Heun's method",
               2,
               u'sec:de:exer:Heun:pg',
               u'sec:de:exer:Heun:pg'),
              (u'Exercise 46: Find an appropriate time step; logistic model',
               2,
               u'sec:de:exer:logistic:dtopt',
               u'sec:de:exer:logistic:dtopt'),
              (u'Exercise 47: Find an appropriate time step; SIR model',
               2,
               u'sec:de:exer:SIR:dtopt',
               u'sec:de:exer:SIR:dtopt'),
              (u'Exercise 48: Model an adaptive vaccination campaign',
               2,
               u'sec:de:exer:SIRV:padapt',
               u'sec:de:exer:SIRV:padapt'),
              (u'Exercise 49: Make a SIRV model with time-limited effect of vaccination',
               2,
               u'sec:de:exer:SIRV:padapt_time_limited',
               u'sec:de:exer:SIRV:padapt_time_limited'),
              (u'Exercise 50: Refactor a flat program',
               2,
               u'sec:de:exer:vib:FE:func',
               u'sec:de:exer:vib:FE:func'),
              (u'Exercise 51: Simulate oscillations by a general ODE solver',
               2,
               u'sec:de:exer:vib:ode_FE',
               u'sec:de:exer:vib:ode_FE'),
              (u'Exercise 52: Compute the energy in oscillations',
               2,
               u'sec:de:exer:vib:energy',
               u'sec:de:exer:vib:energy'),
              (u'Exercise 53: Use a Backward Euler scheme for population growth',
               2,
               u'sec:de:exer:pg:BE',
               u'sec:de:exer:pg:BE'),
              (u'Exercise 54: Use a Crank-Nicolson scheme for population growth',
               2,
               u'sec:de:exer:pg:CN',
               u'sec:de:exer:pg:CN'),
              (u'Exercise 55: Understand finite differences via Taylor series',
               2,
               u'sec:de:exer:fd:Taylor',
               u'sec:de:exer:fd:Taylor'),
              (u'Exercise 56: Use a Backward Euler scheme for oscillations',
               2,
               u'sec:de:exer:vib:BE',
               u'sec:de:exer:vib:BE'),
              (u'Remarks', 3, None, '___sec188'),
              (u"Exercise 57: Use Heun's method for the SIR model",
               2,
               u'sec:de:exer:SIR:Heun',
               u'sec:de:exer:SIR:Heun'),
              (u'Exercise 58: Use Odespy to solve a simple ODE',
               2,
               u'sec:de:exer:odespy:decay',
               u'sec:de:exer:odespy:decay'),
              (u'Exercise 59: Set up a Backward Euler scheme for oscillations',
               2,
               u'sec:de:exer:osc:BE',
               u'sec:de:exer:osc:BE'),
              (u'Exercise 60: Set up a Forward Euler scheme for nonlinear and damped oscillations',
               2,
               u'sec:de:exer:osc:FE:general',
               u'sec:de:exer:osc:FE:general'),
              (u'Exercise 61: Discretize an initial condition',
               2,
               u'sec:de:exer:osc:2nd:V0ic',
               u'sec:de:exer:osc:2nd:V0ic'),
              (u'Solving partial differential equations',
               0,
               u'6th:SolvPDEs',
               u'6th:SolvPDEs'),
              (u'Finite difference methods',
               1,
               u'6th:SolvPDEs:MOLandFE',
               u'6th:SolvPDEs:MOLandFE'),
              (u'Reduction of a PDE to a system of ODEs',
               2,
               u'sec:pde:diff1D:reduce',
               u'sec:pde:diff1D:reduce'),
              (u'Construction of a test problem with known discrete solution',
               2,
               u'sec:pde:diff1D:testproblem',
               u'sec:pde:diff1D:testproblem'),
              (u'Implementation: Forward Euler method', 2, None, '___sec198'),
              (u'Application: heat conduction in a rod',
               2,
               u'sec:pde:diff1D:rod',
               u'sec:pde:diff1D:rod'),
              (u'Vectorization', 2, None, '___sec200'),
              (u'Using Odespy to solve the system of ODEs',
               2,
               None,
               '___sec201'),
              (u'Implicit methods', 2, None, '___sec202'),
              (u'Exercises', 1, None, '___sec203'),
              (u'Exercise 62: Simulate a diffusion equation by hand',
               2,
               u'sec:pde:diff1D:exer:handFE',
               u'sec:pde:diff1D:exer:handFE'),
              (u'Exercise 63: Compute temperature variations in the ground',
               2,
               u'sec:pde:diff1D:exer:groundtemp',
               u'sec:pde:diff1D:exer:groundtemp'),
              (u'Exercise 64: Compare implicit methods',
               2,
               u'sec:pde:diff1D:exer:compare:implicit',
               u'sec:pde:diff1D:exer:compare:implicit'),
              (u'Exercise 65: Explore adaptive and implicit methods',
               2,
               u'sec:pde:diff1D:exer:groundtemp:adapt',
               u'sec:pde:diff1D:exer:groundtemp:adapt'),
              (u'Exercise 66: Investigate the $\\theta$ rule',
               2,
               u'sec:pde:diff1D:exer:CN',
               u'sec:pde:diff1D:exer:CN'),
              (u'Remarks', 3, None, '___sec209'),
              (u'Exercise 67: Compute the diffusion of a Gaussian peak',
               2,
               u'sec:pde:diff1D:exer:Gaussian',
               u'sec:pde:diff1D:exer:Gaussian'),
              (u'Remarks', 3, None, '___sec211'),
              (u'Exercise 68: Vectorize a function for computing the area of a polygon',
               2,
               u'2nd:exer:area:polygon2',
               u'2nd:exer:area:polygon2'),
              (u'Exercise 69: Explore symmetry',
               2,
               u'sec:pde:diff1D:exer:Gaussian:symm',
               u'sec:pde:diff1D:exer:Gaussian:symm'),
              (u'Remarks', 3, None, '___sec214'),
              (u'Exercise 70: Compute solutions as $t\\rightarrow\\infty$',
               2,
               u'sec:pde:diff1D:exer:stationary',
               u'sec:pde:diff1D:exer:stationary'),
              (u'Remarks', 3, None, '___sec216'),
              (u'Exercise 71: Solve a two-point boundary value problem',
               2,
               u'sec:pde:diff1D:exer:stationary2',
               u'sec:pde:diff1D:exer:stationary2'),
              (u'Solving nonlinear algebraic equations',
               0,
               u'4th:NonlinAlgEq',
               u'4th:NonlinAlgEq'),
              (u'Brute force methods',
               1,
               u'4th:bruteforce',
               u'4th:bruteforce'),
              (u'Brute force root finding', 2, None, '___sec220'),
              (u'Numerical algorithm', 3, None, '___sec221'),
              (u'Implementation', 3, None, '___sec222'),
              (u'Brute force optimization', 2, None, '___sec223'),
              (u'Numerical algorithm', 3, None, '___sec224'),
              (u'Implementation', 3, None, '___sec225'),
              (u'Model problem for algebraic equations',
               2,
               None,
               '___sec226'),
              (u"Newton's method",
               1,
               u'4th:NonlinAlgEq:Newt',
               u'4th:NonlinAlgEq:Newt'),
              (u"Deriving and implementing Newton's method",
               2,
               None,
               '___sec228'),
              (u'Making a more efficient and robust implementation',
               2,
               u'4th:Newton:robust',
               u'4th:Newton:robust'),
              (u'The secant method',
               1,
               u'4th:NonlinAlgEq:Secant',
               u'4th:NonlinAlgEq:Secant'),
              (u'The bisection method',
               1,
               u'4th:NonlinAlgEq:Bisect',
               u'4th:NonlinAlgEq:Bisect'),
              (u'Rate of convergence',
               1,
               u'4th:NonlinAlgEq:RateConv',
               u'4th:NonlinAlgEq:RateConv'),
              (u'Solving multiple nonlinear algebraic equations',
               1,
               u'nonlin:Newton:systems',
               u'nonlin:Newton:systems'),
              (u'Abstract notation',
               2,
               u'nonlin:Newton:systems:notation',
               u'nonlin:Newton:systems:notation'),
              (u'Taylor expansions for multi-variable functions',
               2,
               None,
               '___sec235'),
              (u"Newton's method", 2, None, '___sec236'),
              (u'Implementation', 2, None, '___sec237'),
              (u'Exercises', 1, None, '___sec238'),
              (u"Exercise 72: Understand why Newton's method can fail",
               2,
               u'4th:exer:Newton:failure',
               u'4th:exer:Newton:failure'),
              (u'Exercise 73: See if the secant method fails',
               2,
               u'4th:exer:Secant:failure',
               u'4th:exer:Secant:failure'),
              (u'Exercise 74: Understand why the bisection method cannot fail',
               2,
               u'4th:exer:Bisection:failure',
               u'4th:exer:Bisection:failure'),
              (u"Exercise 75: Combine the bisection method with Newton's method",
               2,
               u'4th:exer:Bisection:Newton',
               u'4th:exer:Bisection:Newton'),
              (u"Exercise 76: Write a test function for Newton's method",
               2,
               u'4th:exer:NewtonHand',
               u'4th:exer:NewtonHand'),
              (u'Exercise 77: Solve nonlinear equation for a vibrating beam',
               2,
               u'4th:exer:beam:vib',
               u'4th:exer:beam:vib'),
              (u'References', 0, None, '___sec245')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands.tex -->
$$
\newcommand{\Oof}[1]{\mathcal{O}(#1)}
\newcommand{\F}{\boldsymbol{F}}
\newcommand{\J}{\boldsymbol{J}}
\newcommand{\x}{\boldsymbol{x}}
\renewcommand{\c}{\boldsymbol{c}}
$$




    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="p4c-bootstrap-Matlab.html">Programming for Computations - A Gentle Introduction to Numerical Simulations with MATLAB/Octave</a>
  </div>

  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab001.html#___sec0" style="font-size: 80%;"><b>Preface</b></a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab001.html#___sec1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Why learn programming?</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab001.html#___sec2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Target audience and background knowledge</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab001.html#___sec3" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Numerical methods</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab001.html#___sec4" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The computer language: Matlab</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab001.html#___sec5" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;How this book is different</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab001.html#___sec6" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Supplementary materials</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab001.html#___sec7" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Acknowledgments</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab003.html#1st:TheFirstFewSteps" style="font-size: 80%;"><b>The first few steps</b></a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab003.html#___sec9" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;What is a program? And what is programming?</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab004.html#1st:ex1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;A Matlab program with variables</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab004.html#___sec11" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The program</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab004.html#___sec12" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dissection of the program</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab004.html#___sec13" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Why not just use a pocket calculator?</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab004.html#___sec14" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Why you must use a text editor to write programs</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab004.html#___sec15" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write and run your first program</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab004.html#___sec16" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write and run a program in Matlab</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab004.html#___sec17" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write a program in a text editor and run it in Octave</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab005.html#1st:ex2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;A Matlab program with a library function</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab006.html#1st:ex3" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;A Matlab program with vectorization and plotting</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab007.html#___sec20" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;More basic concepts</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab007.html#___sec21" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Using Matlab interactively</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab007.html#___sec22" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arithmetics, parentheses and rounding errors</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab007.html#___sec23" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Variables</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab007.html#___sec24" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Formatting text and numbers</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab007.html#___sec25" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arrays</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab007.html#___sec26" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Plotting</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab007.html#___sec27" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error messages and warnings</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab007.html#___sec28" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Input data</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab007.html#___sec29" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Symbolic computations</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab007.html#___sec30" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Concluding remarks</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab008.html#___sec31" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercises</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab008.html#1st:exer:ErrorMessages" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 1: Error messages</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab008.html#1st:exer:cubeVolume" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2: Volume of a cube</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab008.html#1st:exer:areaCircle" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 3: Area and circumference of a circle</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab008.html#1st:exer:volumes3cubes" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 4: Volumes of three cubes</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab008.html#1st:exer:averageOf5Integers" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 5: Average of integers</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab008.html#1st:exer:cubeVolInteractively" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 6: Interactive computing of volume and area</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab008.html#1st:exer:updateVarInteractively" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 7: Update variable at command prompt</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab008.html#1st:exer:printfScreen" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 8: Formatted print to screen</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab008.html#1st:exer:PythonDocRandom" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 9: Matlab documentation and random numbers</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab009.html#2nd:BasicConstructins" style="font-size: 80%;"><b>Basic constructions</b></a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab009.html#___sec42" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;If tests</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab010.html#sec:functions" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Functions</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab011.html#sec:for:loops" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;For loops</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab012.html#sec:while:loops" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;While loops</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab012.html#sec:file:reading:writing" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Reading from and writing to files</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab013.html#___sec47" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercises</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab013.html#2nd:exer:IntroducingErrors" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 10: Introducing errors</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab013.html#2nd:exer:compInt" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 11: Compare integers a and b</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab013.html#2nd:exer:funcCircArea" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 12: Functions for circumference and area of a circle</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab013.html#2nd:exer:funcAreaRectangle" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 13: Function for area of a rectangle</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab013.html#2nd:exer:area:polygon" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 14: Area of a polygon</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab013.html#2nd:exer:avNInt" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 15: Average of integers</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab013.html#2nd:exer:whileLoopErrors" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 16: While loop with errors</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab013.html#2nd:exer:areaRectCircle" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 17: Area of rectangle versus circle</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab013.html#2nd:exer:Cross2Graphs" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 18: Find crossing points of two graphs</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab013.html#2nd:exer:sortNumbers" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 19: Sort array with numbers</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab013.html#2nd:exer:computingPi" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 20: Compute \( \pi \)</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab013.html#2nd:exer:combinatorics1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 21: Compute combinations of sets</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab013.html#2nd:exer:numberOccurrence" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 22: Frequency of random numbers</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab013.html#___sec61" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab013.html#2nd:exer:Game21" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 23: Game 21</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab013.html#2nd:exer:linearInterpol" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 24: Linear interpolation</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab013.html#2nd:exer:testStraightLine" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 25: Test straight line requirement</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab013.html#2nd:exer:fitLine" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 26: Fit straight line to data</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab013.html#___sec66" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab013.html#2nd:exer:fitSines" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 27: Fit sines to straight line</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab013.html#___sec68" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab013.html#2nd:exer:countTextString" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 28: Count occurrences of a string in a string</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab014.html#sec:integrals" style="font-size: 80%;"><b>Computing integrals</b></a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab014.html#sec:integrals:basic" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Basic ideas of numerical integration</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab014.html#___sec72" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Computational example</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab015.html#sec:integrals:trap" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The composite trapezoidal rule</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab015.html#sec:integrals:formula" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The general formula</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab015.html#sec:integrals:trap:impl" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab015.html#___sec76" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Specific or general implementation?</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab015.html#___sec77" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation with functions</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab015.html#___sec78" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Solving our specific problem in a session</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab015.html#___sec79" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Solving our specific problem in a program</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab015.html#___sec80" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Alternative flat special-purpose implementation</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#sec:integrals:Midpoint" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The composite midpoint method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec82" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The idea</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec83" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The general formula</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#sec:midpoint:code" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec85" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Comparing the trapezoidal and the midpoint methods</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec86" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Testing</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec87" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problems with brief testing procedures</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#sec:integrals:testprocs" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Proper test procedures</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec89" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hand-computed results</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec90" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Solving a problem without numerical errors</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec91" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Demonstrating correct convergence rates</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#sec:integrals:finite_prec" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Finite precision of floating-point numbers</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#sec:integrals:test:functions" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constructing unit tests and writing test functions</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec94" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hand-computed numerical results</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec95" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Solving a problem without numerical errors</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec96" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Demonstrating correct convergence rates</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec97" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Vectorization</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec98" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vectorizing the midpoint rule</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec99" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vectorizing the trapezoidal rule</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec100" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Measuring computational speed</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#sec:int:double" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Double and triple integrals</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#sec:int:double:midpoint" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The midpoint rule for a double integral</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec103" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Derivation via one-dimensional integrals</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec104" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Direct derivation</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec105" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Programming a double sum</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec106" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reusing code for one-dimensional integrals</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec107" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verification via test functions</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec108" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The midpoint rule for a triple integral</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec109" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Theory</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec110" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#sec:int:complex:domain" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Monte Carlo integration for complex-shaped domains</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec112" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Monte Carlo integration algorithm</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec113" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec114" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verification</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec115" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Test function for function with random numbers</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab016.html#___sec116" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Integral over a circle</a></li>
     <!-- navigation toc: --> <li><a href="#___sec117" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercises</a></li>
     <!-- navigation toc: --> <li><a href="#sec:exer:trap:hand" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 29: Hand calculations for the trapezoidal method</a></li>
     <!-- navigation toc: --> <li><a href="#sec:exer:midpt:hand" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 30: Hand calculations for the midpoint method</a></li>
     <!-- navigation toc: --> <li><a href="#sec:exer:trap:mid:parabola" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 31: Compute a simple integral</a></li>
     <!-- navigation toc: --> <li><a href="#sec:exer:hand:sine" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 32: Hand-calculations with sine integrals</a></li>
     <!-- navigation toc: --> <li><a href="#sec:exer:test:midpoint" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 33: Make test functions for the midpoint method</a></li>
     <!-- navigation toc: --> <li><a href="#sec:exer:test:roundoff" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 34: Explore rounding errors with large numbers</a></li>
     <!-- navigation toc: --> <li><a href="#sec:exer:test:convrates:sqrt" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 35: Write test functions for \( \int_0^4\sqrt{x}dx \)</a></li>
     <!-- navigation toc: --> <li><a href="#___sec125" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="#sec:exer:rectangleMethod" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 36: Rectangle methods</a></li>
     <!-- navigation toc: --> <li><a href="#sec:exer:adaptive:int" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 37: Adaptive integration</a></li>
     <!-- navigation toc: --> <li><a href="#___sec128" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="#sec:exer:integrate:x2x" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 38: Integrating x raised to x</a></li>
     <!-- navigation toc: --> <li><a href="#sec:exer:sine:products" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 39: Integrate products of sine functions</a></li>
     <!-- navigation toc: --> <li><a href="#sec:exer:revisitFitSines" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 40: Revisit fit of sines to a function</a></li>
     <!-- navigation toc: --> <li><a href="#sec:exer:trapezoidal:2D" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 41: Derive the trapezoidal rule for a double integral</a></li>
     <!-- navigation toc: --> <li><a href="#sec:exer:MC:ellipse" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 42: Compute the area of a triangle by Monte Carlo integration</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab018.html#5th:SolvODEs" style="font-size: 80%;"><b>Solving ordinary differential equations</b></a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab019.html#sec:de:pg" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Population growth</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab019.html#sec:de:pg:model" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Derivation of the model</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab019.html#sec:de:pg:numerics" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Numerical solution</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab019.html#sec:de:pg:prog1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Programming the Forward Euler scheme; the special case</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab019.html#sec:de:pg:geom" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Understanding the Forward Euler method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab019.html#sec:de:FE:gen" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Programming the Forward Euler scheme; the general case</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab019.html#___sec141" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Making the population growth model more realistic</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab019.html#sec:de:growth:test:linear" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verification: exact linear solution of the discrete equations</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab020.html#___sec143" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Spreading of diseases</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab020.html#sec:de:flu" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Spreading of a flu</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab020.html#sec:de:flu:FE" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A Forward Euler method for the differential equation system</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab020.html#sec:de:flu:prog:spec" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Programming the numerical method; the special case</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab020.html#___sec147" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Outbreak or not</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab020.html#sec:de:flu:generic" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Abstract problem and notation</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab020.html#sec:de:flu:prog:generic" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Programming the numerical method; the general case</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab020.html#___sec150" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time-restricted immunity</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab020.html#sec:de:flu:vaccine" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Incorporating vaccination</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab020.html#sec:de:flu:vaccine:discont" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Discontinuous coefficients: a vaccination campaign</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#sec:de:vib" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Oscillating one-dimensional systems</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#___sec154" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Derivation of a simple model</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#___sec155" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Numerical solution</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#sec:de:vib:special" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Programming the numerical method; the special case</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#___sec157" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A magic fix of the numerical method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#sec:de:osc:Heun" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The 2nd-order Runge-Kutta method (or Heun's method)</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#sec:de:osc:odespy" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software for solving ODEs</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#___sec160" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The 4th-order Runge-Kutta method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#___sec161" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The algorithm</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#___sec162" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#___sec163" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#___sec164" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Derivation</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#___sec165" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;More effects: damping, nonlinearity, and external forces</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#___sec166" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Euler-Cromer scheme</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#___sec167" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The 4-th order Runge-Kutta method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#___sec168" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Illustration of linear damping</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#___sec169" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Illustration of linear damping with sinusoidal excitation</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#sec:de:vib:ode2:sliding:friction" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Spring-mass system with sliding friction</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#sec:de:vib:2nd" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A finite difference method; undamped, linear case</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab021.html#sec:de:vib:2nd:damped1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A finite difference method; linear damping</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#___sec173" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercises</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:geom" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 43: Geometric construction of the Forward Euler method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:FE:test1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 44: Make test functions for the Forward Euler method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:Heun:pg" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 45: Implement and evaluate Heun's method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:logistic:dtopt" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 46: Find an appropriate time step; logistic model</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:SIR:dtopt" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 47: Find an appropriate time step; SIR model</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:SIRV:padapt" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 48: Model an adaptive vaccination campaign</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:SIRV:padapt_time_limited" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 49: Make a SIRV model with time-limited effect of vaccination</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:vib:FE:func" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 50: Refactor a flat program</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:vib:ode_FE" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 51: Simulate oscillations by a general ODE solver</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:vib:energy" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 52: Compute the energy in oscillations</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:pg:BE" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 53: Use a Backward Euler scheme for population growth</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:pg:CN" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 54: Use a Crank-Nicolson scheme for population growth</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:fd:Taylor" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 55: Understand finite differences via Taylor series</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:vib:BE" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 56: Use a Backward Euler scheme for oscillations</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#___sec188" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:SIR:Heun" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 57: Use Heun's method for the SIR model</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:odespy:decay" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 58: Use Odespy to solve a simple ODE</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:osc:BE" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 59: Set up a Backward Euler scheme for oscillations</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:osc:FE:general" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 60: Set up a Forward Euler scheme for nonlinear and damped oscillations</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab022.html#sec:de:exer:osc:2nd:V0ic" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 61: Discretize an initial condition</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab023.html#6th:SolvPDEs" style="font-size: 80%;"><b>Solving partial differential equations</b></a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#6th:SolvPDEs:MOLandFE" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Finite difference methods</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#sec:pde:diff1D:reduce" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reduction of a PDE to a system of ODEs</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#sec:pde:diff1D:testproblem" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Construction of a test problem with known discrete solution</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#___sec198" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation: Forward Euler method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#sec:pde:diff1D:rod" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application: heat conduction in a rod</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#___sec200" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vectorization</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#___sec201" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Using Odespy to solve the system of ODEs</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#___sec202" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implicit methods</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#___sec203" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercises</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#sec:pde:diff1D:exer:handFE" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 62: Simulate a diffusion equation by hand</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#sec:pde:diff1D:exer:groundtemp" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 63: Compute temperature variations in the ground</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#sec:pde:diff1D:exer:compare:implicit" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 64: Compare implicit methods</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#sec:pde:diff1D:exer:groundtemp:adapt" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 65: Explore adaptive and implicit methods</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#sec:pde:diff1D:exer:CN" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 66: Investigate the \( \theta \) rule</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#___sec209" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#sec:pde:diff1D:exer:Gaussian" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 67: Compute the diffusion of a Gaussian peak</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#___sec211" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#2nd:exer:area:polygon2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 68: Vectorize a function for computing the area of a polygon</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#sec:pde:diff1D:exer:Gaussian:symm" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 69: Explore symmetry</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#___sec214" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#sec:pde:diff1D:exer:stationary" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 70: Compute solutions as \( t\rightarrow\infty \)</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#___sec216" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab024.html#sec:pde:diff1D:exer:stationary2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 71: Solve a two-point boundary value problem</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab025.html#4th:NonlinAlgEq" style="font-size: 80%;"><b>Solving nonlinear algebraic equations</b></a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab025.html#4th:bruteforce" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Brute force methods</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab025.html#___sec220" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Brute force root finding</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab025.html#___sec221" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Numerical algorithm</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab025.html#___sec222" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab025.html#___sec223" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Brute force optimization</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab025.html#___sec224" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Numerical algorithm</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab025.html#___sec225" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab025.html#___sec226" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Model problem for algebraic equations</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab026.html#4th:NonlinAlgEq:Newt" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Newton's method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab026.html#___sec228" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Deriving and implementing Newton's method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab026.html#4th:Newton:robust" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Making a more efficient and robust implementation</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab027.html#4th:NonlinAlgEq:Secant" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The secant method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab028.html#4th:NonlinAlgEq:Bisect" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The bisection method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab029.html#4th:NonlinAlgEq:RateConv" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Rate of convergence</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab030.html#nonlin:Newton:systems" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Solving multiple nonlinear algebraic equations</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab030.html#nonlin:Newton:systems:notation" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Abstract notation</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab030.html#___sec235" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Taylor expansions for multi-variable functions</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab030.html#___sec236" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Newton's method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab030.html#___sec237" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab031.html#___sec238" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercises</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab031.html#4th:exer:Newton:failure" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 72: Understand why Newton's method can fail</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab031.html#4th:exer:Secant:failure" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 73: See if the secant method fails</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab031.html#4th:exer:Bisection:failure" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 74: Understand why the bisection method cannot fail</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab031.html#4th:exer:Bisection:Newton" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 75: Combine the bisection method with Newton's method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab031.html#4th:exer:NewtonHand" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 76: Write a test function for Newton's method</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab031.html#4th:exer:beam:vib" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 77: Solve nonlinear equation for a vibrating beam</a></li>
     <!-- navigation toc: --> <li><a href="._p4c-bootstrap-Matlab032.html#___sec245" style="font-size: 80%;"><b>References</b></a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0017"></a>
<!-- !split -->

<h1 id="___sec117">Exercises </h1>

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:exer:trap:hand">Exercise 29: Hand calculations for the trapezoidal method</h2>

<p>
<!-- solution=`sol_trapezoidal_test_func.pdf` -->

<p>
Compute by hand the area composed of two trapezoids (of equal width) that
approximates the integral \( \int_1^3 2x^3dx \). Make a test function
that calls the <code>trapezoidal</code> function in <code>trapezoidal.m</code>
and compares the return value with the hand-calculated value.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_29_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_29_1">

<p>
The code may be written as follows

<p>

<!-- code=matlab (!bc mpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">test_trapezoidal</span>()<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>f = @(x) <span style="color: #666666">2*</span>x^<span style="color: #666666">3</span>;
    a = <span style="color: #666666">1</span>; b = <span style="color: #666666">3</span>; 
    n = <span style="color: #666666">2</span>;
    numerical = trapezoidal(f, a, b, n);
    hand = <span style="color: #666666">44.0</span>;
    error = <span style="color: #008000">abs</span>(numerical <span style="color: #666666">-</span> hand);
    tol = <span style="color: #666666">1E-14</span>;
    assert(error <span style="color: #666666">&lt;</span> tol, <span style="color: #BA2121">&#39;%f&#39;</span>, error);
<span style="color: #008000; font-weight: bold">end</span>
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>trapezoidal_test_func.m</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:exer:midpt:hand">Exercise 30: Hand calculations for the midpoint method</h2>

<p>
<!-- solution=`sol_midpoint_test_func.pdf` -->

<p>
Compute by hand the area composed of two rectangles (of equal width) that
approximates the integral \( \int_1^3 2x^3dx \). Make a test function
that calls the <code>midpoint</code> function in <code>midpoint.m</code>
and compares the return value with the hand-calculated value.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_30_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_30_1">

<p>
The code may be written as follows

<p>

<!-- code=matlab (!bc mpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">test_midpoint</span>()<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>f = @(x) <span style="color: #666666">2*</span>x^<span style="color: #666666">3</span>;
    a = <span style="color: #666666">1</span>; b = <span style="color: #666666">3</span>; 
    n = <span style="color: #666666">2</span>;
    numerical = midpoint(f, a, b, n);
    hand = <span style="color: #666666">38.0</span>;
    error = <span style="color: #008000">abs</span>(numerical <span style="color: #666666">-</span> hand);
    tol = <span style="color: #666666">1E-14</span>;
    assert(error <span style="color: #666666">&lt;</span> tol, <span style="color: #BA2121">&#39;%f&#39;</span>, error);
<span style="color: #008000; font-weight: bold">end</span>
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>midpoint_test_func.m</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:exer:trap:mid:parabola">Exercise 31: Compute a simple integral</h2>

<p>
<!-- solution=`sol_integrate_parabola.pdf` -->

<p>
Apply the <code>trapezoidal</code> and <code>midpoint</code> functions to compute
the integral \( \int_2^6 x(x -1)dx \) with 2 and 100 subintervals.
Compute the error too.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_31_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_31_1">

<p>
The code may be written as follows

<p>

<!-- code=matlab (!bc mpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">integrate_parabola</span>()<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>f = @(x) x<span style="color: #666666">*</span>(x<span style="color: #666666">-1</span>);
    a = <span style="color: #666666">2</span>; b = <span style="color: #666666">6</span>; 
    n = <span style="color: #666666">2</span>
    <span style="color: #408080; font-style: italic">%n = 100</span>

    numerical_trap = trapezoidal(f, a, b, n);
    numerical_mid = midpoint(f, a, b, n);

    exact = <span style="color: #666666">53.333</span>        <span style="color: #408080; font-style: italic">% Rounded</span>
    error_trap = <span style="color: #008000">abs</span>(numerical_trap <span style="color: #666666">-</span> exact);
    error_mid = <span style="color: #008000">abs</span>(numerical_mid <span style="color: #666666">-</span> exact);

    fprintf(<span style="color: #BA2121">&#39;For n = %d, we get: \n&#39;</span>, n);
    fprintf(<span style="color: #BA2121">&#39;Numerical trapezoid: %g , Error: %g \n&#39;</span>,<span style="color: #408080; font-style: italic">...</span>
                               numerical_trap, error_trap);
    fprintf(<span style="color: #BA2121">&#39;Numerical midpoint: %g , Error: %g \n&#39;</span>,<span style="color: #408080; font-style: italic">...</span>
                                 numerical_mid, error_mid);
<span style="color: #008000; font-weight: bold">end</span>
</pre></div>
<p>
In the code, we have taken the opportunity to show
how commenting often is used to switch between two
code fragments, typically single statements. The
alternatives <code>n = 2</code> and <code>n = 100</code> are switched by
removing/adding the comment sign <code>#</code>, before running
the code anew. Another alternative would of course be
to ask the user for the value of <code>n</code>.
Running the program with <code>n = 2</code>, produces the following printout:
<p>

<!-- code=text (!bc dat) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">For n = 2, we get:
Numerical trapezoid: 56 , Error: 2.667
Numerical midpoint: 52 , Error: 1.333
</pre></div>
<p>
while running it with <code>n = 100</code> gives:
<p>

<!-- code=text (!bc dat) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">For n = 100, we get:
Numerical trapezoid: 53.3344 , Error: 0.0014
Numerical midpoint: 53.3328 , Error: 0.0002
</pre></div>
<p>
The analytical value of the integral is 53.333 (rounded).

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>integrate_parabola.m</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:exer:hand:sine">Exercise 32: Hand-calculations with sine integrals</h2>

<p>
<!-- solution=`sol_integrate_sine.pdf` -->

<p>
We consider integrating the sine function: \( \int_0^b \sin (x)dx \).

<p>
<b>a)</b>
Let \( b=\pi \) and use two intervals in the trapezoidal and midpoint method.
Compute the integral by hand and illustrate how the two numerical
methods approximates the integral. Compare with the exact value.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_32_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_32_1">

<p>
Analytically, the integral computes to 2. By hand, with the trapezoidal method,
we get 1.570. Graphically (Figure <a href="#fig:intgr_sine_a_trap">10</a>), it is clear that
the numerical approach will have to under-estimate the true result.

<p>
The area under the blue graph in Figure <a href="#fig:intgr_sine_a_trap">10</a>
corresponds to the "true" area under the graph of the integrand. The area
under the red graph corresponds to what you get with the trapezoidal method and
two intervals.

<p>
<center> <!-- figure label: --> <div id="fig:intgr_sine_a_trap"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 10:  The integral computed with the trapezoidal method (n = 2).  <!-- caption label: fig:intgr_sine_a_trap --> </p></center>
<p><img src="figs/integrate_sine_a_trap.png" align="bottom" width=400></p>
</center>

<p>
By hand, with the midpoint method, we get 2.221. Graphically (Figure <a href="#fig:intgr_sine_a_mid">11</a>),
we might see that the numerical approach will have to over-estimate the true result.
Again, the area under the blue graph in Figure <a href="#fig:intgr_sine_a_mid">11</a>
corresponds to the "true" area under the graph of the integrand. The area
under the red graph corresponds to what you get with the midpoint method and
two intervals.

<p>
<center> <!-- figure label: --> <div id="fig:intgr_sine_a_mid"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 11:  The integral computed with the midpoint method (n = 2).  <!-- caption label: fig:intgr_sine_a_mid --> </p></center>
<p><img src="figs/integrate_sine_a_mid.png" align="bottom" width=400></p>
</center>

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>b)</b>
Do a) when \( b=2\pi \).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_32_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_32_2">

<p>
Analytically, the integral computes to zero. In this case, both numerical methods will correctly calculate the integral to zero even with just two intervals! Graphically, we see that they arrive at zero for "different reasons". The trapezoidal method constructs both its trapezoids by use of the function (integrand) value at the midpoint of the whole interval. However, there the integrand crosses the x-axis, i.e. it evaluates to zero. The "area" computed by the trapezoidal method becomes the zero area located "between" the green graph and the x-axis in Figure <a href="#fig:intgr_sine_b_trap_mid">12</a>. The midpoint method computes the areas of two rectangles (red graph in Figure <a href="#fig:intgr_sine_b_trap_mid">12</a>), but since the signs of these equal areas differ, they add to zero.

<p>
<center> <!-- figure label: --> <div id="fig:intgr_sine_b_trap_mid"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 12:  The integral computed with the trapezoidal and midpoint method (n = 2).  <!-- caption label: fig:intgr_sine_b_trap_mid --> </p></center>
<p><img src="figs/integrate_sine_b_trap_mid.png" align="bottom" width=400></p>
</center>

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
Filename: <code>integrate_sine.pdf</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:exer:test:midpoint">Exercise 33: Make test functions for the midpoint method</h2>

<p>
<!-- solution=`sol_test_midpoint.pdf` -->

<p>
Modify the file <code>test_trapezoidal.m</code> such that the
three tests are applied to the function <code>midpoint</code> implementing
the midpoint method for integration.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_33_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_33_1">

<p>
Note that also the midpoint method will do an exact (to within machine precision)
integration when the integrand is a straight line. This is so, since the errors
from each rectangle will cancel. The code reads:

<p>

<!-- code=matlab (!bc mpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">test_midpoint</span>()<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>test_midpoint_one_exact_result();
    test_midpoint_linear();
    test_midpoint_conv_rate(); 
<span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">    </span>
<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">test_midpoint_one_exact_result</span>()<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span><span style="color: #408080; font-style: italic">% Compare one hand-computed result.</span>
    v = @(t) <span style="color: #666666">3*</span>(t^<span style="color: #666666">2</span>)<span style="color: #666666">*</span><span style="color: #008000">exp</span>(t^<span style="color: #666666">3</span>);
    n = <span style="color: #666666">2</span>;
    numerical = midpoint(v, <span style="color: #666666">0</span>, <span style="color: #666666">1</span>, n);
    exact = <span style="color: #666666">1.3817914596908085</span>;
    err = <span style="color: #008000">abs</span>(exact <span style="color: #666666">-</span> numerical);
    tol = <span style="color: #666666">1E-14</span>;
    assert(err <span style="color: #666666">&lt;</span> tol, <span style="color: #BA2121">&#39;%f&#39;</span>, err);
<span style="color: #008000; font-weight: bold">end</span>

<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">test_midpoint_linear</span>()<span style="color: #bbbbbb"> </span>
<span style="color: #bbbbbb">    </span><span style="color: #408080; font-style: italic">% Check that linear functions are integrated exactly</span>
    <span style="color: #408080; font-style: italic">% ...they should, because errors with each rectangle cancel</span>
    f = @(x) <span style="color: #666666">6*</span>x <span style="color: #666666">-</span> <span style="color: #666666">4</span>;
    F = @(x) <span style="color: #666666">3*</span>x^<span style="color: #666666">2</span> <span style="color: #666666">-</span> <span style="color: #666666">4*</span>x;   <span style="color: #408080; font-style: italic">% Anti-derivative</span>
    a = <span style="color: #666666">1.2</span>; b = <span style="color: #666666">4.4</span>;
    exact = F(b) <span style="color: #666666">-</span> F(a);
    tol = <span style="color: #666666">1E-14</span>;
    <span style="color: #008000; font-weight: bold">for</span> n = [<span style="color: #666666">2</span> <span style="color: #666666">20</span> <span style="color: #666666">21</span>]
        numerical = midpoint(f, a, b, n);
        err = <span style="color: #008000">abs</span>(exact <span style="color: #666666">-</span> numerical);
        assert(err <span style="color: #666666">&lt;</span> tol, <span style="color: #BA2121">&#39;n = %d, err = %g&#39;</span>, n, err);
    <span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">end</span>

<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">test_midpoint_conv_rate</span>()<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span><span style="color: #408080; font-style: italic">% Check empirical convergence rates against the expected -2.</span>
    v = @(t) <span style="color: #666666">3*</span>(t^<span style="color: #666666">2</span>)<span style="color: #666666">*</span><span style="color: #008000">exp</span>(t^<span style="color: #666666">3</span>);
    V = @(t) <span style="color: #008000">exp</span>(t^<span style="color: #666666">3</span>);
    a = <span style="color: #666666">1.1</span>; b = <span style="color: #666666">1.9</span>;
    num_experiments = <span style="color: #666666">14</span>;
    r = convergence_rates(v, V, a, b, num_experiments)
    tol = <span style="color: #666666">0.01</span>;
    assert(<span style="color: #008000">abs</span>(r(num_experiments<span style="color: #666666">-1</span>)) <span style="color: #666666">-</span> <span style="color: #666666">2</span> <span style="color: #666666">&lt;</span> tol,<span style="color: #408080; font-style: italic">...</span>
                   <span style="color: #BA2121">&#39;%f, %f, %f, %f, %f&#39;</span>,<span style="color: #408080; font-style: italic">...</span>
                   r((num_experiments<span style="color: #666666">-1</span>)<span style="color: #666666">-4</span>:num_experiments<span style="color: #666666">-1</span>));
<span style="color: #008000; font-weight: bold">end</span>

<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span>r =<span style="color: #bbbbbb"> </span><span style="color: #0000FF">convergence_rates</span>(f, F, a, b, num_experiments)<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>exact = F(b) <span style="color: #666666">-</span> F(a);
    n = <span style="color: #008000">zeros</span>(num_experiments, <span style="color: #666666">1</span>);
    E = <span style="color: #008000">zeros</span>(num_experiments, <span style="color: #666666">1</span>);
    r = <span style="color: #008000">zeros</span>(num_experiments<span style="color: #666666">-1</span>, <span style="color: #666666">1</span>);

    <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = <span style="color: #666666">1</span>:num_experiments
        n(<span style="color: #008000">i</span>) = <span style="color: #666666">2</span>^<span style="color: #008000">i</span>;
        numerical = midpoint(f, a, b, n(<span style="color: #008000">i</span>));
        err = <span style="color: #008000">abs</span>(exact <span style="color: #666666">-</span> numerical);
        E(<span style="color: #008000">i</span>) = err;
        <span style="color: #008000; font-weight: bold">if</span> (<span style="color: #008000">i</span> <span style="color: #666666">&gt;</span> <span style="color: #666666">1</span>)
            r(<span style="color: #008000">i</span><span style="color: #666666">-1</span>) = <span style="color: #008000">log</span>(E(<span style="color: #008000">i</span><span style="color: #666666">-1</span>)<span style="color: #666666">/</span>E(<span style="color: #008000">i</span>))<span style="color: #666666">/</span><span style="color: #008000">log</span>(n(<span style="color: #008000">i</span><span style="color: #666666">-1</span>)<span style="color: #666666">/</span>n(<span style="color: #008000">i</span>));
            r(<span style="color: #008000">i</span><span style="color: #666666">-1</span>) = <span style="color: #008000">round</span>(r(<span style="color: #008000">i</span><span style="color: #666666">-1</span>)<span style="color: #666666">*100</span>)<span style="color: #666666">/100</span>;  <span style="color: #408080; font-style: italic">% Truncate, two decimals</span>
        <span style="color: #008000; font-weight: bold">end</span>
    <span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">end</span>
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>test_midpoint.m</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:exer:test:roundoff">Exercise 34: Explore rounding errors with large numbers</h2>

<p>
<!-- solution=`sol_test_trapezoidal2.pdf` -->

<p>
The trapezoidal method integrates linear functions exactly, and this
property was used in the test function <code>test_trapezoidal_linear</code> in the file
<code>test_trapezoidal.m</code>. Change the function used in
the section <a href="._p4c-bootstrap-Matlab016.html#sec:integrals:testprocs">Proper test procedures</a> to \( f(x)=6\cdot 10^8 x - 4\cdot 10^6 \)
and rerun the test. What happens? How must you change the test
to make it useful? How does the convergence rate test behave? Any need
for adjustment?

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_34_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_34_1">

<p>
With the new function given, we get the error message that includes:

<p>

<!-- code=text (!bc dat) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">AssertionError: n = 2, err = 9.53674e-07
</pre></div>
<p>
The numerical calculation then obviously differs from the exact value by
more than what is specified in the tolerance <code>tol</code>. We may understand this
by considering the new function, i.e., \( f(x)=6\cdot 10^8 x - 4\cdot 10^6 \).
Any rounding error in \( x \) will get magnified big time by the factor \( 6\cdot 10^8 \) in front,
i.e. the slope of the line. This makes the numerical calculation more inaccurate than previously.
To fix this problem, we have several options. One possibility is to relax the tolerance, but
this is not very satisfactory. After all, the calculation is supposed to be &quot;exact&quot; for a straight
line. Another alternative is to introduce a new integration variable such
that we scale the interval \( [a,b] \) into \( [\frac{a}{6\cdot 10^8},\frac{b}{6\cdot 10^8}] \), as
this will neutralize the huge factor in front of \( x \), bringing the accuracy back to where it was previously. This
alternative is implemented in
<a href="https://github.com/hplgit/prog4comp/tree/master/src/m/test_trapezoidal2.m" target="_self"><tt>test_trapezoidal2.m</tt></a>.

<p>

<!-- code=matlab (!bc mcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">test_trapezoidal_linear_scale</span>()<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span><span style="color: #408080; font-style: italic">% Check that linear functions are integrated exactly</span>
    f = @(x) <span style="color: #666666">6E8*</span>x <span style="color: #666666">-</span> <span style="color: #666666">4E6</span>;
    F = @(x) <span style="color: #666666">3E8*</span>x^<span style="color: #666666">2</span> <span style="color: #666666">-</span> <span style="color: #666666">4E6*</span>x;       <span style="color: #408080; font-style: italic">% Anti-derivative</span>
    a = <span style="color: #666666">1.2/6E8</span>;  b = <span style="color: #666666">4.4/6E8</span>;      <span style="color: #408080; font-style: italic">% Scale interval down</span>
    exact = F(b) <span style="color: #666666">-</span> F(a);
    tol = <span style="color: #666666">1E-14</span>;
    <span style="color: #008000; font-weight: bold">for</span> n = [<span style="color: #666666">2</span> <span style="color: #666666">20</span> <span style="color: #666666">21</span>]
        numerical = trapezoidal(f, a, b, n);
        err = <span style="color: #008000">abs</span>(exact <span style="color: #666666">-</span> numerical);
        assert(err <span style="color: #666666">&lt;</span> tol, <span style="color: #BA2121">&#39;n = %d, err = %g&#39;</span>, n, err);
    <span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">end</span>
</pre></div>
<p>

<!-- code=matlab (!bc mpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">test_trapezoidal2</span>()<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>test_trapezoidal_linear_scale();
    test_trapezoidal_linear_reldiff();
    test_trapezoidal_conv_rate();
<span style="color: #008000; font-weight: bold">end</span>

<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">test_trapezoidal_linear_scale</span>()<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span><span style="color: #408080; font-style: italic">% Check that linear functions are integrated exactly</span>
    f = @(x) <span style="color: #666666">6E8*</span>x <span style="color: #666666">-</span> <span style="color: #666666">4E6</span>;
    F = @(x) <span style="color: #666666">3E8*</span>x^<span style="color: #666666">2</span> <span style="color: #666666">-</span> <span style="color: #666666">4E6*</span>x;       <span style="color: #408080; font-style: italic">% Anti-derivative</span>
    a = <span style="color: #666666">1.2/6E8</span>;  b = <span style="color: #666666">4.4/6E8</span>;      <span style="color: #408080; font-style: italic">% Scale interval down</span>
    exact = F(b) <span style="color: #666666">-</span> F(a);
    tol = <span style="color: #666666">1E-14</span>;
    <span style="color: #008000; font-weight: bold">for</span> n = [<span style="color: #666666">2</span> <span style="color: #666666">20</span> <span style="color: #666666">21</span>]
        numerical = trapezoidal(f, a, b, n);
        err = <span style="color: #008000">abs</span>(exact <span style="color: #666666">-</span> numerical);
        assert(err <span style="color: #666666">&lt;</span> tol, <span style="color: #BA2121">&#39;n = %d, err = %g&#39;</span>, n, err);
    <span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">end</span>

<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">test_trapezoidal_linear_reldiff</span>()<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span><span style="color: #408080; font-style: italic">% Check that linear functions are integrated exactly</span>
    f = @(x) <span style="color: #666666">6E8*</span>x <span style="color: #666666">-</span> <span style="color: #666666">4E6</span>;
    F = @(x) <span style="color: #666666">3E8*</span>x^<span style="color: #666666">2</span> <span style="color: #666666">-</span> <span style="color: #666666">4E6*</span>x;       <span style="color: #408080; font-style: italic">% Anti-derivative</span>
    a = <span style="color: #666666">1.2</span>;  b = <span style="color: #666666">4.4</span>
    exact = F(b) <span style="color: #666666">-</span> F(a);
    tol = <span style="color: #666666">1E-14</span>;
    <span style="color: #008000; font-weight: bold">for</span> n = [<span style="color: #666666">2</span> <span style="color: #666666">20</span> <span style="color: #666666">21</span>]
        numerical = trapezoidal(f, a, b, n);
        err = <span style="color: #008000">abs</span>(exact <span style="color: #666666">-</span> numerical)<span style="color: #666666">/</span>exact;
        assert(err <span style="color: #666666">&lt;</span> tol, <span style="color: #BA2121">&#39;n = %d, err = %g&#39;</span>, n, err);
    <span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">end</span>
</pre></div>
<p>
The best alternative, however, is to consider relative differences instead
of absolute differences. That is, we compute <code>(exact - numerical)/exact</code>
instead of just <code>exact - numerical</code>. This relative error is \( 10^{-16} \)
even if we compute with very big numbers.

<p>

<!-- code=matlab (!bc mcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">test_trapezoidal_linear_reldiff</span>()<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span><span style="color: #408080; font-style: italic">% Check that linear functions are integrated exactly</span>
    f = @(x) <span style="color: #666666">6E8*</span>x <span style="color: #666666">-</span> <span style="color: #666666">4E6</span>;
    F = @(x) <span style="color: #666666">3E8*</span>x^<span style="color: #666666">2</span> <span style="color: #666666">-</span> <span style="color: #666666">4E6*</span>x;       <span style="color: #408080; font-style: italic">% Anti-derivative</span>
    a = <span style="color: #666666">1.2</span>;  b = <span style="color: #666666">4.4</span>
    exact = F(b) <span style="color: #666666">-</span> F(a);
    tol = <span style="color: #666666">1E-14</span>;
    <span style="color: #008000; font-weight: bold">for</span> n = [<span style="color: #666666">2</span> <span style="color: #666666">20</span> <span style="color: #666666">21</span>]
        numerical = trapezoidal(f, a, b, n);
        err = <span style="color: #008000">abs</span>(exact <span style="color: #666666">-</span> numerical)<span style="color: #666666">/</span>exact;
        assert(err <span style="color: #666666">&lt;</span> tol, <span style="color: #BA2121">&#39;n = %d, err = %g&#39;</span>, n, err);
    <span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">end</span>
</pre></div>
<p>
Computing convergence rates is not meaningful in this test, because the
error is mathematically zero.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>test_trapezoidal2.m</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:exer:test:convrates:sqrt">Exercise 35: Write test functions for \( \int_0^4\sqrt{x}dx \)</h2>

<p>
<!-- solution=`sol_test_trapezoidal3.pdf` -->

<p>
We want to test how the <code>trapezoidal</code> function works for the integral
\( \int_0^4\sqrt{x}dx \). Two of the tests in <code>test_trapezoidal.m</code>
are meaningful for this integral. Compute by hand the result of
using 2 or 3 trapezoids and modify the <code>test_trapezoidal_one_exact_result</code>
function accordingly. Then modify <code>test_trapezoidal_conv_rate</code>
to handle the square root integral.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_35_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_35_1">

<p>
Adjustments to the code are made according to the remark below and
hand calculations are written into the code. The code then reads:

<p>

<!-- code=matlab (!bc mpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">test_trapezoidal3</span>()<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>test_trapezoidal_one_exact_result();
    test_trapezoidal_conv_rate();   
<span style="color: #008000; font-weight: bold">end</span>

<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">test_trapezoidal_one_exact_result</span>()<span style="color: #bbbbbb"> </span>
<span style="color: #bbbbbb">    </span><span style="color: #408080; font-style: italic">% Compare one hand-computed result.</span>
    f = @(x) x^<span style="color: #666666">0.5</span>;
    tol = <span style="color: #666666">1E-14</span>;
    exact = [<span style="color: #666666">4.82842712474619</span>, <span style="color: #666666">5.050258266979605</span>]; <span style="color: #408080; font-style: italic">%n=2, n=3</span>
    <span style="color: #008000; font-weight: bold">for</span> n = [<span style="color: #666666">2</span> <span style="color: #666666">3</span>]
        numerical = trapezoidal(f, <span style="color: #666666">0</span>, <span style="color: #666666">4</span>, n);
        err = <span style="color: #008000">abs</span>(exact(n<span style="color: #666666">-1</span>) <span style="color: #666666">-</span> numerical);
        assert(err <span style="color: #666666">&lt;</span> tol, <span style="color: #BA2121">&#39;%f&#39;</span>, err);
    <span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">end</span>


<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">test_trapezoidal_conv_rate</span>()<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span><span style="color: #408080; font-style: italic">% Check empirical convergence rates against the expected -2.</span>
    f = @(x) x^<span style="color: #666666">0.5</span>; 
    F = @(x) (<span style="color: #666666">2/3</span>)<span style="color: #666666">*</span>x^(<span style="color: #666666">3/2</span>);
    a = <span style="color: #666666">0.0</span> <span style="color: #666666">+</span> <span style="color: #666666">0.1</span>; b = <span style="color: #666666">4.0</span>;        <span style="color: #408080; font-style: italic">% a adjusted by 0.1</span>
    num_experiments = <span style="color: #666666">14</span>;
    r = convergence_rates(f, F, a, b, num_experiments)
    tol = <span style="color: #666666">0.01</span>;
    assert(<span style="color: #008000">abs</span>(r(num_experiments<span style="color: #666666">-1</span>)) <span style="color: #666666">-</span> <span style="color: #666666">2</span> <span style="color: #666666">&lt;</span> tol,<span style="color: #408080; font-style: italic">...</span>
                   <span style="color: #BA2121">&#39;%f, %f, %f, %f, %f&#39;</span>,<span style="color: #408080; font-style: italic">...</span>
                   r((num_experiments<span style="color: #666666">-1</span>)<span style="color: #666666">-4</span>:num_experiments<span style="color: #666666">-1</span>));
<span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">    </span>
<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span>r =<span style="color: #bbbbbb"> </span><span style="color: #0000FF">convergence_rates</span>(f, F, a, b, num_experiments)<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>exact = F(b) <span style="color: #666666">-</span> F(a);
    n = <span style="color: #008000">zeros</span>(num_experiments, <span style="color: #666666">1</span>);
    E = <span style="color: #008000">zeros</span>(num_experiments, <span style="color: #666666">1</span>);
    r = <span style="color: #008000">zeros</span>(num_experiments<span style="color: #666666">-1</span>, <span style="color: #666666">1</span>);
    <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = <span style="color: #666666">1</span>:<span style="color: #008000">length</span>(num_experiments)
        n(<span style="color: #008000">i</span>) = <span style="color: #666666">2</span>^(<span style="color: #008000">i</span><span style="color: #666666">+1</span>);
        numerical = trapezoidal(f, a, b, n(<span style="color: #008000">i</span>));
        E(<span style="color: #008000">i</span>) = <span style="color: #008000">abs</span>(exact <span style="color: #666666">-</span> numerical);
        <span style="color: #008000; font-weight: bold">if</span> (<span style="color: #008000">i</span> <span style="color: #666666">&gt;</span> <span style="color: #666666">1</span>)
            r(<span style="color: #008000">i</span><span style="color: #666666">-1</span>) = <span style="color: #008000">log</span>(E(<span style="color: #008000">i</span><span style="color: #666666">-1</span>)<span style="color: #666666">/</span>E(<span style="color: #008000">i</span>))<span style="color: #666666">/</span><span style="color: #008000">log</span>(n(<span style="color: #008000">i</span><span style="color: #666666">-1</span>)<span style="color: #666666">/</span>n(<span style="color: #008000">i</span>));
            r(<span style="color: #008000">i</span><span style="color: #666666">-1</span>) = <span style="color: #008000">round</span>(r(<span style="color: #008000">i</span><span style="color: #666666">-1</span>)<span style="color: #666666">*100</span>)<span style="color: #666666">/100</span>;  <span style="color: #408080; font-style: italic">% Truncate, two decimals</span>
        <span style="color: #008000; font-weight: bold">end</span>
    <span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">end</span>
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>test_trapezoidal3.m</code>.

<p>
<!-- Closing remarks for this Exercise -->

<h3 id="___sec125">Remarks </h3>

<p>
The convergence rate test fails. Printing out <code>r</code> shows that the
actual convergence rate for this integral is \( -1.5 \) and not \( -2 \).
The reason is that the <a href="http://en.wikipedia.org/wiki/Trapezoidal_rule#Error_analysis" target="_self">error in the trapezoidal method</a>
is \( -(b-a)^3n^{-2}f''(\xi) \) for some (unknown) \( \xi\in [a,b] \).
With \( f(x)=\sqrt{x} \), \( f''(\xi)\rightarrow -\infty \) as \( \xi\rightarrow 0 \),
pointing to a potential problem in the size of the error.
Running a test with \( a>0 \), say \( \int_{0.1}^4\sqrt{x}dx \) shows that
the convergence rate is indeed restored to -2.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:exer:rectangleMethod">Exercise 36: Rectangle methods</h2>

<p>
<!-- solution=`sol_rectangle_methods.pdf` -->

<p>
The midpoint method divides the interval of integration into equal-sized
subintervals and approximates the integral in each subinterval by
a rectangle whose height equals the function value at the midpoint of
the subinterval. Instead, one might use either the left or right end of
the subinterval as illustrated in Figure <a href="#fig:vCarRectangle">13</a>.
This defines a <em>rectangle method</em> of integration. The height of the
rectangle can be based on the left or right end or the midpoint.

<p>
<center> <!-- figure label: --> <div id="fig:vCarRectangle"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 13:  Illustration of the rectangle method with evaluating the rectangle height by either the left or right point.  <!-- caption label: fig:vCarRectangle --> </p></center>
<p><img src="figs/viz_rectangle.png" align="bottom" width=800></p>
</center>

<p>
<b>a)</b>
Write a function <code>rectangle(f, a, b, n, height='left')</code> for
computing an integral \( \int_a^bf(x)dx \) by the rectangle method
with height computed based on the value of <code>height</code>, which is either
 <code>left</code>, <code>right</code>, or <code>mid</code>.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_36_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_36_2">

<p>
Placing the code for both <em>a</em> and <em>b</em> into one file, the code may read:

<p>

<!-- code=matlab (!bc mpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">rectangle_methods</span>()<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>test_rectangle_one_exact_result();
    test_rectangle_linear();
    test_rectangle_conv_rate(); 
<span style="color: #008000; font-weight: bold">end</span>

<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span>result =<span style="color: #bbbbbb"> </span><span style="color: #0000FF">rectangle</span>(f, a, b, n, height)<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span><span style="color: #408080; font-style: italic">% Uses a rectangle method for integrating f. The height of</span>
    <span style="color: #408080; font-style: italic">% each rectangle is computed either at the left end, middle or </span>
    <span style="color: #408080; font-style: italic">% right end of each sub-interval</span>
    h = (b<span style="color: #666666">-</span>a)<span style="color: #666666">/</span>n;
    <span style="color: #008000; font-weight: bold">if</span> height <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;l&#39;</span>
        start = a;
    <span style="color: #008000; font-weight: bold">elseif</span> height <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;m&#39;</span>
        start = a <span style="color: #666666">+</span> h<span style="color: #666666">/2</span>;
    <span style="color: #008000; font-weight: bold">else</span>                   <span style="color: #408080; font-style: italic">% Must be right end</span>
        start = a <span style="color: #666666">+</span> h;
    <span style="color: #008000; font-weight: bold">end</span>
    result = <span style="color: #666666">0</span>;
    <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = <span style="color: #666666">0</span>:(n<span style="color: #666666">-1</span>)
        result = result <span style="color: #666666">+</span> f((start) <span style="color: #666666">+</span> <span style="color: #008000">i</span><span style="color: #666666">*</span>h);
    <span style="color: #008000; font-weight: bold">end</span>
    result = h<span style="color: #666666">*</span>result;
<span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">    </span>
<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">test_rectangle_one_exact_result</span>()<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span><span style="color: #408080; font-style: italic">% Compare one hand-computed result</span>
    v = @(t) <span style="color: #666666">3*</span>(t^<span style="color: #666666">2</span>)<span style="color: #666666">*</span><span style="color: #008000">exp</span>(t^<span style="color: #666666">3</span>);
    method = [<span style="color: #BA2121">&#39;l&#39;</span>; <span style="color: #BA2121">&#39;m&#39;</span>; <span style="color: #BA2121">&#39;r&#39;</span>];  <span style="color: #408080; font-style: italic">% ... left, mid and right</span>
    n = <span style="color: #666666">2</span>;
    exact = [<span style="color: #666666">0.4249306699000599</span> <span style="color: #666666">1.3817914596908085</span><span style="color: #408080; font-style: italic">...</span>
                                    <span style="color: #666666">4.5023534125886275</span>];
    tol = <span style="color: #666666">1E-14</span>;
    <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = <span style="color: #666666">1</span>:<span style="color: #008000">length</span>(method)
        numerical = rectangle(v, <span style="color: #666666">0</span>, <span style="color: #666666">1</span>, n, method(<span style="color: #008000">i</span>));
        err = <span style="color: #008000">abs</span>(exact(<span style="color: #008000">i</span>) <span style="color: #666666">-</span> numerical);
        assert(err <span style="color: #666666">&lt;</span> tol, <span style="color: #BA2121">&#39;%f&#39;</span>, err);
    <span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">end</span>

<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">test_rectangle_linear</span>()<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span><span style="color: #408080; font-style: italic">% Check that linear functions are integrated exactly </span>
    <span style="color: #408080; font-style: italic">% (with midpoint) or with a known correctable error (left </span>
    <span style="color: #408080; font-style: italic">% and right)</span>
    method = [<span style="color: #BA2121">&#39;l&#39;</span>; <span style="color: #BA2121">&#39;m&#39;</span>; <span style="color: #BA2121">&#39;r&#39;</span>];  <span style="color: #408080; font-style: italic">% ... left, mid and right</span>
    f = @(x) <span style="color: #666666">6*</span>x <span style="color: #666666">-</span> <span style="color: #666666">4</span>;
    slope = <span style="color: #666666">6</span>;
    F = @(x) <span style="color: #666666">3*</span>x^<span style="color: #666666">2</span> <span style="color: #666666">-</span> <span style="color: #666666">4*</span>x;     <span style="color: #408080; font-style: italic">% Anti-derivative</span>
    <span style="color: #408080; font-style: italic">% From the slope of f (i.e. 6), we know that left will </span>
    <span style="color: #408080; font-style: italic">% under-estimate the inegral by C (given below), while</span>
    <span style="color: #408080; font-style: italic">% right will over-estimate by C</span>
    a = <span style="color: #666666">1.2</span>; b = <span style="color: #666666">4.4</span>;
    exact = F(b) <span style="color: #666666">-</span> F(a);
    <span style="color: #408080; font-style: italic">%tol = 1E-14</span>
    tol = <span style="color: #666666">1E-13</span>;        <span style="color: #408080; font-style: italic">% Slightly relaxed compared to previously</span>
    <span style="color: #008000; font-weight: bold">for</span> n = [<span style="color: #666666">2</span> <span style="color: #666666">20</span> <span style="color: #666666">21</span>] 
        h = (b<span style="color: #666666">-</span>a)<span style="color: #666666">/</span>n;
        C = n<span style="color: #666666">*</span>(<span style="color: #666666">0.5*</span>slope<span style="color: #666666">*</span>h^<span style="color: #666666">2</span>);    <span style="color: #408080; font-style: italic">% Correction term for left/right</span>
        <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = <span style="color: #666666">1</span>:<span style="color: #008000">length</span>(method)
            numerical = rectangle(f, a, b, n, method(<span style="color: #008000">i</span>));
            <span style="color: #008000; font-weight: bold">if</span> (method(<span style="color: #008000">i</span>) <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;l&#39;</span>)
                numerical = numerical <span style="color: #666666">+</span> C;
            <span style="color: #008000; font-weight: bold">elseif</span> (method(<span style="color: #008000">i</span>) <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;r&#39;</span>)
                numerical = numerical <span style="color: #666666">-</span> C;
            <span style="color: #008000; font-weight: bold">end</span>
            err = <span style="color: #008000">abs</span>(exact <span style="color: #666666">-</span> numerical);
            assert(err <span style="color: #666666">&lt;</span> tol, <span style="color: #BA2121">&#39;n = %d, err = %g&#39;</span>, n, err);
        <span style="color: #008000; font-weight: bold">end</span>
    <span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">end</span>

<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">test_rectangle_conv_rate</span>()<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span><span style="color: #408080; font-style: italic">% Check empirical convergence rates against the expected rate,</span>
    <span style="color: #408080; font-style: italic">% which is -2 for midpoint and -1 for left and right.</span>
    method = [<span style="color: #BA2121">&#39;l&#39;</span>; <span style="color: #BA2121">&#39;m&#39;</span>; <span style="color: #BA2121">&#39;r&#39;</span>];  <span style="color: #408080; font-style: italic">% ... left, mid and right</span>
    v = @(t) <span style="color: #666666">3*</span>(t^<span style="color: #666666">2</span>)<span style="color: #666666">*</span><span style="color: #008000">exp</span>(t^<span style="color: #666666">3</span>);
    V = @(t) <span style="color: #008000">exp</span>(t^<span style="color: #666666">3</span>);
    a = <span style="color: #666666">1.1</span>; b = <span style="color: #666666">1.9</span>;
    tol = <span style="color: #666666">0.01</span>;
    <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = <span style="color: #666666">1</span>:<span style="color: #008000">length</span>(method)
        r = convergence_rates(v, V, a, b, method(<span style="color: #008000">i</span>), <span style="color: #666666">14</span>)
        <span style="color: #008000; font-weight: bold">if</span> (method(<span style="color: #008000">i</span>) <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;l&#39;</span>) <span style="color: #666666">||</span> (method(<span style="color: #008000">i</span>) <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;r&#39;</span>)
            assert(<span style="color: #008000">abs</span>(r(<span style="color: #008000">length</span>(r)<span style="color: #666666">-1</span>)) <span style="color: #666666">-</span> <span style="color: #666666">1</span> <span style="color: #666666">&lt;</span> tol,<span style="color: #408080; font-style: italic">...</span>
                   <span style="color: #BA2121">&#39;%f, %f, %f, %f, %f&#39;</span>,<span style="color: #408080; font-style: italic">...</span>
                   r((num_experiments<span style="color: #666666">-1</span>)<span style="color: #666666">-4</span>:num_experiments<span style="color: #666666">-1</span>));
        <span style="color: #008000; font-weight: bold">else</span>
            assert(<span style="color: #008000">abs</span>(r(<span style="color: #008000">length</span>(r)<span style="color: #666666">-1</span>)) <span style="color: #666666">-</span> <span style="color: #666666">2</span> <span style="color: #666666">&lt;</span> tol,<span style="color: #408080; font-style: italic">...</span>
                   <span style="color: #BA2121">&#39;%f, %f, %f, %f, %f&#39;</span>,<span style="color: #408080; font-style: italic">...</span>
                   r((num_experiments<span style="color: #666666">-1</span>)<span style="color: #666666">-4</span>:num_experiments<span style="color: #666666">-1</span>));
        <span style="color: #008000; font-weight: bold">end</span>
    <span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">end</span>

<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span>r =<span style="color: #bbbbbb"> </span><span style="color: #0000FF">convergence_rates</span>(f, F, a, b, height, num_experiments)<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>exact = F(b) <span style="color: #666666">-</span> F(a);
    n = <span style="color: #008000">zeros</span>(num_experiments, <span style="color: #666666">1</span>);
    E = <span style="color: #008000">zeros</span>(num_experiments, <span style="color: #666666">1</span>);
    r = <span style="color: #008000">zeros</span>(num_experiments<span style="color: #666666">-1</span>, <span style="color: #666666">1</span>);
    <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = <span style="color: #666666">1</span>:num_experiments
        n(<span style="color: #008000">i</span>) = <span style="color: #666666">2</span>^<span style="color: #008000">i</span>;
        numerical = rectangle(f, a, b, n(<span style="color: #008000">i</span>), height);
        E(<span style="color: #008000">i</span>) = <span style="color: #008000">abs</span>(exact <span style="color: #666666">-</span> numerical);
        <span style="color: #008000; font-weight: bold">if</span> (<span style="color: #008000">i</span> <span style="color: #666666">&gt;</span> <span style="color: #666666">1</span>)
            r(<span style="color: #008000">i</span><span style="color: #666666">-1</span>) = <span style="color: #008000">log</span>(E(<span style="color: #008000">i</span><span style="color: #666666">-1</span>)<span style="color: #666666">/</span>E(<span style="color: #008000">i</span>))<span style="color: #666666">/</span><span style="color: #008000">log</span>(n(<span style="color: #008000">i</span><span style="color: #666666">-1</span>)<span style="color: #666666">/</span>n(<span style="color: #008000">i</span>));
            r(<span style="color: #008000">i</span><span style="color: #666666">-1</span>) = <span style="color: #008000">round</span>(r(<span style="color: #008000">i</span><span style="color: #666666">-1</span>)<span style="color: #666666">*100</span>)<span style="color: #666666">/100</span>;  <span style="color: #408080; font-style: italic">% Truncate, two decimals</span>
        <span style="color: #008000; font-weight: bold">end</span>
    <span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">end</span>
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>b)</b>
Write three test functions for the three unit test procedures
described in the section <a href="._p4c-bootstrap-Matlab016.html#sec:integrals:testprocs">Proper test procedures</a>. Make sure you
test for <code>height</code> equal to <code>left</code>, <code>right</code>, and <code>mid</code>. You may
call the <code>midpoint</code> function for checking the result when <code>height=mid</code>.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_36_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_36_1">

<p>
Edit <code>test_trapezoidal.m</code>.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_36_3" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_36_3">

<p>
See code above.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
Filename: <code>rectangle_methods.m</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:exer:adaptive:int">Exercise 37: Adaptive integration</h2>

<p>
<!-- solution=`sol_adaptive_integration.pdf` -->

<p>
Suppose we want to use the trapezoidal or midpoint method to
compute an integral \( \int_a^b f(x)dx \) with an error less than
a prescribed tolerance \( \epsilon \). What is the appropriate
size of \( n \)?

<p>
To answer this question, we may enter an iterative procedure where
we compare the results produced by \( n \) and \( 2n \) intervals,
and if the difference is smaller than \( \epsilon \), the value corresponding
to \( 2n \) is returned. Otherwise, we halve \( n \) and repeat the procedure.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_37_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_37_1">

<p>
It may be a good idea to organize your code so that the function <code>adaptive_integration</code> can be used
easily in future programs you write.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->

<p>
<b>a)</b>
Write a function

<p>

<!-- code=text typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">adaptive_integration(f, a, b, eps, method=midpoint)
</pre></div>
<p>
that implements the idea above (<code>eps</code> corresponds to the tolerance
\( \epsilon \), and <code>method</code> can be <code>midpoint</code> or <code>trapezoidal</code>).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_37_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_37_2">

<p>
To ease future use of adaptive integration, we save the function <code>adaptive_integration</code>
in a separate file <code>adaptive_integration.m</code>:

<p>

<!-- code=matlab (!bc mpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span>n_final =<span style="color: #bbbbbb"> </span><span style="color: #0000FF">adaptive_integration</span>(f, a, b, eps, method)<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>n_limit = <span style="color: #666666">1000000</span>; <span style="color: #408080; font-style: italic">% Just a choice (to avoid inf loop)</span>
    n = <span style="color: #666666">2</span>; 
    <span style="color: #008000; font-weight: bold">if</span> (method <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;t&#39;</span>)
        integral_n = trapezoidal(f, a, b, n);
        integral_2n = trapezoidal(f, a, b, <span style="color: #666666">2*</span>n);
        diff = <span style="color: #008000">abs</span>(integral_2n <span style="color: #666666">-</span> integral_n);
        fprintf(<span style="color: #BA2121">&#39;trapezoidal diff: %g \n&#39;</span>, diff); 
        <span style="color: #008000; font-weight: bold">while</span> (diff <span style="color: #666666">&gt;</span> <span style="color: #008000">eps</span>) <span style="color: #666666">&amp;&amp;</span> (n <span style="color: #666666">&lt;</span> n_limit)
            integral_n = trapezoidal(f, a, b, n);
            integral_2n = trapezoidal(f, a, b, <span style="color: #666666">2*</span>n);
            diff = <span style="color: #008000">abs</span>(integral_2n <span style="color: #666666">-</span> integral_n);
            fprintf(<span style="color: #BA2121">&#39;trapezoidal diff: %g \n&#39;</span>, diff);
            n = <span style="color: #666666">2*</span>n;
        <span style="color: #008000; font-weight: bold">end</span>
    <span style="color: #008000; font-weight: bold">elseif</span> method <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;m&#39;</span>
        integral_n = midpoint(f, a, b, n);
        integral_2n = midpoint(f, a, b, <span style="color: #666666">2*</span>n);
        diff = <span style="color: #008000">abs</span>(integral_2n <span style="color: #666666">-</span> integral_n);
        fprintf(<span style="color: #BA2121">&#39;midpoint diff: %g \n&#39;</span>, diff); 
        <span style="color: #008000; font-weight: bold">while</span> (diff <span style="color: #666666">&gt;</span> <span style="color: #008000">eps</span>) <span style="color: #666666">&amp;&amp;</span> (n <span style="color: #666666">&lt;</span> n_limit)
            integral_n = midpoint(f, a, b, n);
            integral_2n = midpoint(f, a, b, <span style="color: #666666">2*</span>n);
            diff = <span style="color: #008000">abs</span>(integral_2n <span style="color: #666666">-</span> integral_n);
            fprintf(<span style="color: #BA2121">&#39;midpoint diff: %g \n&#39;</span>, diff);
            n = <span style="color: #666666">2*</span>n;
        <span style="color: #008000; font-weight: bold">end</span>
    <span style="color: #008000; font-weight: bold">else</span>
        display(<span style="color: #BA2121">&#39;Error - adaptive integr called with unknown par&#39;</span>);
    <span style="color: #008000; font-weight: bold">end</span>
    <span style="color: #408080; font-style: italic">% Now we check if acceptable n was found or not</span>
    <span style="color: #008000; font-weight: bold">if</span> diff <span style="color: #666666">&lt;</span>= <span style="color: #008000">eps</span>     <span style="color: #408080; font-style: italic">% Success </span>
        fprintf(<span style="color: #BA2121">&#39;The integral computes to: %g \n&#39;</span>, integral_2n);
        n_final = n;
    <span style="color: #008000; font-weight: bold">else</span>
        n_final = <span style="color: #666666">-</span>n;   <span style="color: #408080; font-style: italic">% Return negative n to tell &quot;not found&quot;</span>
    <span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">end</span>
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>b)</b>
Test the method on \( \int_0^2x^2dx \) and \( \int_0^2\sqrt{x}dx \)
for \( \epsilon = 10^{-1}, 10^{-10} \) and write out the exact error.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_37_3" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_37_3">

<p>
The function <code>adaptive_integration</code> may be applied (as required in <em>b</em> and <em>c</em>)
by the statements in <code>use_my_adaptive_integration.m</code>:

<p>

<!-- code=matlab (!bc mpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #408080; font-style: italic">%...tasks b) and c)</span>

f = @(x) x^<span style="color: #666666">2</span>;
g = @(x) <span style="color: #008000">sqrt</span>(x);

<span style="color: #408080; font-style: italic">%eps = 1E-1;        % Just switch between these two eps values</span>
<span style="color: #008000">eps</span> = <span style="color: #666666">1E-10</span>;

<span style="color: #408080; font-style: italic">%a = 0.0;</span>
a = <span style="color: #666666">0.0</span> <span style="color: #666666">+</span> <span style="color: #666666">0.01</span>;     <span style="color: #408080; font-style: italic">% If we adjust a, sqrt(x) is handled easily</span>
b = <span style="color: #666666">2.0</span>;

<span style="color: #408080; font-style: italic">%...f</span>

n = adaptive_integration(f, a, b, <span style="color: #008000">eps</span>, <span style="color: #BA2121">&#39;m&#39;</span>);  <span style="color: #408080; font-style: italic">% &#39;m&#39; for midpoint</span>
<span style="color: #008000; font-weight: bold">if</span> n <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>
    fprintf(<span style="color: #BA2121">&#39;Sufficient n is: %d&#39;</span>, n);
<span style="color: #008000; font-weight: bold">else</span>
    fprintf(<span style="color: #BA2121">&#39;No n was found in %d iterations \n&#39;</span>, <span style="color: #008000">abs</span>(n));
<span style="color: #008000; font-weight: bold">end</span>

n = adaptive_integration(f, a, b, <span style="color: #008000">eps</span>, <span style="color: #BA2121">&#39;t&#39;</span>);  <span style="color: #408080; font-style: italic">% &#39;t&#39; for trapezoid</span>
<span style="color: #008000; font-weight: bold">if</span> n <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>
    fprintf(<span style="color: #BA2121">&#39;Sufficient n is: %d&#39;</span>, n);
<span style="color: #008000; font-weight: bold">else</span>
    fprintf(<span style="color: #BA2121">&#39;No n was found in %d iterations \n&#39;</span>, <span style="color: #008000">abs</span>(n));
<span style="color: #008000; font-weight: bold">end</span>

<span style="color: #408080; font-style: italic">%...g</span>

n = adaptive_integration(g, a, b, <span style="color: #008000">eps</span>, <span style="color: #BA2121">&#39;m&#39;</span>);
<span style="color: #008000; font-weight: bold">if</span> n <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>
    fprintf(<span style="color: #BA2121">&#39;Sufficient n is: %d&#39;</span>, n);
<span style="color: #008000; font-weight: bold">else</span>
    fprintf(<span style="color: #BA2121">&#39;No n was found in %d iterations \n&#39;</span>, <span style="color: #008000">abs</span>(n));
<span style="color: #008000; font-weight: bold">end</span>

n = adaptive_integration(g, a, b, <span style="color: #008000">eps</span>, <span style="color: #BA2121">&#39;t&#39;</span>);
<span style="color: #008000; font-weight: bold">if</span> n <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>
    fprintf(<span style="color: #BA2121">&#39;Sufficient n is: %d&#39;</span>, n);
<span style="color: #008000; font-weight: bold">else</span>
    fprintf(<span style="color: #BA2121">&#39;No n was found in %d iterations \n&#39;</span>, <span style="color: #008000">abs</span>(n));
<span style="color: #008000; font-weight: bold">end</span>

<span style="color: #408080; font-style: italic">%task c, make plot for both midpoint and trapezoidal</span>
    
<span style="color: #008000">eps</span> = <span style="color: #008000">linspace</span>(<span style="color: #666666">1E-1</span>, <span style="color: #666666">10E-10</span>, <span style="color: #666666">10</span>);
n_m = <span style="color: #008000">zeros</span>(<span style="color: #008000">length</span>(<span style="color: #008000">eps</span>), <span style="color: #666666">1</span>);
n_t = <span style="color: #008000">zeros</span>(<span style="color: #008000">length</span>(<span style="color: #008000">eps</span>), <span style="color: #666666">1</span>);
<span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = <span style="color: #666666">1</span>:<span style="color: #008000">length</span>(n_m)
    n_m(<span style="color: #008000">i</span>) = adaptive_integration(g, a, b, <span style="color: #008000">eps</span>(<span style="color: #008000">i</span>), <span style="color: #BA2121">&#39;m&#39;</span>);
    n_t(<span style="color: #008000">i</span>) = adaptive_integration(g, a, b, <span style="color: #008000">eps</span>(<span style="color: #008000">i</span>), <span style="color: #BA2121">&#39;t&#39;</span>);
<span style="color: #008000; font-weight: bold">end</span> 
plot(<span style="color: #008000">log</span>(<span style="color: #008000">eps</span>), n_m, <span style="color: #BA2121">&#39;b-&#39;</span>, <span style="color: #008000">log</span>(<span style="color: #008000">eps</span>), n_t, <span style="color: #BA2121">&#39;r-&#39;</span>);
xlabel(<span style="color: #BA2121">&#39;log(eps)&#39;</span>);
ylabel(<span style="color: #BA2121">&#39;n for midpoint (blue) and trapezoidal (red)&#39;</span>);
n
<span style="color: #008000">eps</span>
</pre></div>
<p>
Note that, in our suggested code, it is foreseen that the programmer switches between the
two epsilon values by use of commenting, i.e.
adding/removing <code>%</code>. This may of course be avoided, if desirable, by asking the user for epsilon.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>c)</b>
Make a plot of \( n \) versus \( \epsilon \in [10^{-1}, 10^{-10}] \) for
\( \int_0^2\sqrt{x}dx \). Use logarithmic scale for \( \epsilon \).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_37_4" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_37_4">

<p>
From Figure <a href="#fig:adaptIntegr">14</a>, we see that the stricter the value of epsilon, the larger the
difference between the midpoint and the trapezoidal methods. For a given value for epsilon, the
midpoint method comes within the tolerance with fewer intervals (lower value of <code>n</code>) than does
the trapezoidal method. This should be expected, since the midpoint method is somewhat more accurate
than the trapezoidal method.

<p>
<center> <!-- figure label: --> <div id="fig:adaptIntegr"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 14:  Showing <code>n</code> as a function of <code>log(eps)</code> when \( \int_0^2\sqrt{x}dx \) is computed by the midpoint (blue) and the trapezoidal (red) method.  <!-- caption label: fig:adaptIntegr --> </p></center>
<p><img src="figs/adaptive_integration.png" align="bottom" width=800></p>
</center>

<p>
One way of producing this plot, is by using the code lines included at the end of
<code>use_my_adaptive_integration.m</code> (see the above).

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
Filename: <code>adaptive_integration.m</code>.

<p>
<!-- Closing remarks for this Exercise -->

<h3 id="___sec128">Remarks </h3>

<p>
The type of method explored in this exercise is called <em>adaptive</em>,
because it tries to adapt the value of \( n \) to meet a given
error criterion. The true error can very seldom be computed
(since we do not know the exact answer to the computational
problem), so one has to find other indicators of the error, such
as the one here where the changes in the integral value, as
the number of intervals is doubled, is taken to reflect the error.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:exer:integrate:x2x">Exercise 38: Integrating x raised to x</h2>

<p>
<!-- solution=`sol_integrate_x2x.pdf` -->

<p>
Consider the integral

$$ I = \int_0^4 x^x\,dx\thinspace .$$

The integrand \( x^x \) does not have an anti-derivative that can be expressed in terms of standard functions (visit <a href="http://wolframalpha.com" target="_self"><tt>http://wolframalpha.com</tt></a> and type
<code>integral(x^x,x)</code> to convince yourself that
our claim is right. Note that Wolfram alpha does give you an answer, but that answer is an approximation, it is <em>not</em> exact. This is because
Wolfram alpha too uses numerical methods to arrive at the answer, just as you will in this exercise). Therefore, we are forced to compute the integral by numerical methods. Compute a result that is right to four digits.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_38_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_38_1">

<p>
Use ideas from <a href="#sec:exer:adaptive:int">Exercise 37: Adaptive integration</a>.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_38_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_38_2">

<p>
When the function <code>adaptive_integration</code> is available, the code may be written as:

<p>

<!-- code=matlab (!bc mpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">f = @(x) x^x;

<span style="color: #008000">eps</span> = <span style="color: #666666">1E-4</span>;
a = <span style="color: #666666">0.0</span>; b = <span style="color: #666666">2.0</span>

<span style="color: #408080; font-style: italic">% ...choose the midpoint method</span>
n = adaptive_integration(f, a, b, <span style="color: #008000">eps</span>, <span style="color: #BA2121">&#39;m&#39;</span>);  <span style="color: #408080; font-style: italic">% m for midpoint</span>

<span style="color: #008000; font-weight: bold">if</span> n <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>
    fprintf(<span style="color: #BA2121">&#39;Sufficient n is: %d \n&#39;</span>, n); 
<span style="color: #008000; font-weight: bold">else</span>
    <span style="color: #408080; font-style: italic">% The negative n is returned to signal that the upper </span>
    <span style="color: #408080; font-style: italic">% limit of n was passed. </span>
    fprintf(<span style="color: #BA2121">&#39;No n was found in %d iterations \n&#39;</span>, <span style="color: #008000">abs</span>(n));
<span style="color: #008000; font-weight: bold">end</span>
</pre></div>
<p>
Remember that <code>adaptive_integration</code> prints out the computed integral, so no effort
in that respect is required here.

<p>
Running the program, gives a printout to the screen showing how <code>diff</code> gets smaller and
smaller each time. The final two lines of the printout read:

<p>

<!-- code=text (!bc dat) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">The integral computes to: 2.83384395958
Sufficient n is: 256
</pre></div>
<p>
The computed value may be compared to what Wolfram alpha gives. Remember that since we
have not computed the exact error, we can <em>not</em> guarantee that the
&quot;result is right to four digits&quot;. However, we have reason to believe that we "are close".
Typically, when it is known that the error measure used is not precise, the tolerance is
made stricter.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>integrate_x2x.m</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:exer:sine:products">Exercise 39: Integrate products of sine functions</h2>

<p>
In this exercise we shall integrate

$$ I_{j,k} = \int_{-\pi}^{\pi} \sin(jx)\sin(kx)dx,$$

where \( j \) and \( k \) are integers.

<p>
<b>a)</b>
Plot \( \sin(x)\sin(2x) \) and \( \sin(2x)\sin(3x) \) for \( x\in ]-\pi,\pi] \)
in separate plots.
Explain why you expect
\( \int_{-\pi}^{\pi}\sin x\sin 2x\,dx=0 \) and
\( \int_{-\pi}^{\pi}\sin 2x\sin 3x\,dx=0 \).

<p>
<b>b)</b>
Use the trapezoidal rule to compute \( I_{j,k} \) for \( j=1,\ldots,10 \) and
\( k=1,\ldots,10 \).

<p>
Filename: <code>products_sines.m</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:exer:revisitFitSines">Exercise 40: Revisit fit of sines to a function</h2>

<p>
<!-- solution=`sol_autofit_sines.pdf` -->

<p>
This is a continuation of <a href="._p4c-bootstrap-Matlab013.html#2nd:exer:fitSines">Exercise 27: Fit sines to straight line</a>. The task is to
approximate a given function \( f(t) \) on \( [-\pi,\pi] \) by a sum of sines,

$$
\begin{equation}
S_N(t) = \sum_{n=1}^{N} b_n \sin(nt)\thinspace .
\tag{3.27}
\end{equation}
$$

We are now interested in computing the unknown coefficients \( b_n \)
such that \( S_N(t) \) is in some sense the <em>best approximation</em> to \( f(t) \).
One common way of doing this is to first set up a general expression
for the <em>approximation error</em>, measured by &quot;summing up&quot; the
squared deviation of \( S_N \) from \( f \):

$$ E = \int_{-\pi}^{\pi}(S_N(t)-f(t))^2dt\thinspace .$$

We may view \( E \) as a function of \( b_1,\ldots,b_N \). Minimizing \( E \)
with respect to \( b_1,\ldots,b_N \) will give us a <em>best approximation</em>,
in the sense that we adjust \( b_1,\ldots,b_N \) such that \( S_N \) deviates
as little as possible from \( f \).

<p>
Minimization of a function of \( N \) variables, \( E(b_1,\ldots,b_N) \) is
mathematically performed by requiring all the partial derivatives
to be zero:

$$
\begin{align*}
\frac{\partial E}{\partial b_1} & = 0,\\ 
\frac{\partial E}{\partial b_2} & = 0,\\ 
&\vdots\\ 
\frac{\partial E}{\partial b_N} & = 0\thinspace .
\end{align*}
$$

<p>
<b>a)</b>
Compute the partial derivative \( \partial E/\partial b_1 \) and
generalize to the arbitrary case \( \partial E/\partial b_n \), \( 1\leq n\leq N \).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_40_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_40_1">

$$
\begin{align}
\frac{\partial E}{\partial b_1} & = \frac{\partial}{\partial b_1} (\int_{-\pi}^{\pi}(S_N(t)-f(t))^2dt),                 \nonumber \\ 
                                & = \int_{-\pi}^{\pi} \frac{\partial}{\partial b_1}((S_N(t)-f(t))^2dt),                 \nonumber \\ 
                                & = 2\int_{-\pi}^{\pi} (S_N(t)-f(t))\sin(t)dt,                                           \nonumber
\end{align}
$$

where it has been assumed that the integrand is such that the partial derivative can be moved inside the integration.

<p>
We see that the partial derivative of \( E \) with respect to any one of the \( b \) coefficients will take on the same form, meaning that

$$
\begin{equation*}
\frac{\partial E}{\partial b_n} = 2\int_{-\pi}^{\pi} (S_N(t)-f(t))\sin(nt)dt,              \nonumber
\end{equation*}
$$

where \( 1\leq n\leq N \).

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>b)</b>
Show that

$$ b_n = \frac{1}{\pi}\int_{-\pi}^{\pi}f(t)\sin(nt)\,dt\thinspace .$$

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_40_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_40_2">

<p>
Requiring
$$
\begin{equation*}
\frac{\partial E}{\partial b_n} = 0,              \nonumber
\end{equation*}
$$

means that the following must apply,
$$
\begin{equation*}
2\int_{-\pi}^{\pi} (S_N(t)-f(t))\sin(nt)dt = 0.              \nonumber
\end{equation*}
$$

This may be rewritten as
$$
\begin{equation*}
\int_{-\pi}^{\pi} S_N(t)\sin(nt)dt = \int_{-\pi}^{\pi} f(t)\sin(nt)dt              \nonumber
\end{equation*}
$$

or, if we insert the expression for \( S_N \), we get
$$
\begin{equation*}
\int_{-\pi}^{\pi} (\sum_{i=1}^{N} b_i \sin(it))\sin(nt)dt = \int_{-\pi}^{\pi} f(t)\sin(nt)dt,              \nonumber
\end{equation*}
$$

where the summation variable in \( S_N \) has been changed from \( n \) to \( i \), avoiding conflict with the \( n \) already present in \( \sin(nt) \).

<p>
Now, since
$$
\begin{equation*}
\int_{-\pi}^{\pi} \sin^2(nt)dt = \pi,              \nonumber
\end{equation*}
$$

while
$$
\begin{equation*}
\int_{-\pi}^{\pi} \sin(it)\sin(nt)dt = 0,              \nonumber
\end{equation*}
$$

when \( i \neq n \), we arrive at
$$ b_n = \frac{1}{\pi}\int_{-\pi}^{\pi}f(t)\sin(nt)\,dt\thinspace .$$

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>c)</b>
Write a function <code>integrate_coeffs(f, N, M)</code> that computes \( b_1,\ldots,b_N \)
by numerical integration, using \( M \) intervals in the trapezoidal rule.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_40_3" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_40_3">

<p>
Answers to all (programming) questions in this exercise are collected in one script
which reads:

<p>

<!-- code=matlab (!bc mpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">autofit_sines</span>()<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>f = @(t) (<span style="color: #666666">1/</span><span style="color: #008000">pi</span>)<span style="color: #666666">*</span>t;
    N = <span style="color: #666666">3</span>;
    M = <span style="color: #666666">100</span>;
    b = integrate_coeffs(f, N, M)
    <span style="color: #008000; font-weight: bold">for</span> N = [<span style="color: #666666">3</span> <span style="color: #666666">6</span> <span style="color: #666666">12</span> <span style="color: #666666">24</span>]
       plot_filename = strcat(<span style="color: #BA2121">&#39;S_whenNis&#39;</span>, num2str(N), <span style="color: #BA2121">&#39;.pdf&#39;</span>);
       plot_approx(f, N, M, plot_filename);
    <span style="color: #008000; font-weight: bold">end</span>
    
    g = @(t) <span style="color: #008000">exp</span>(<span style="color: #666666">-</span>(t<span style="color: #666666">-</span><span style="color: #008000">pi</span>));
    plot_filename = <span style="color: #408080; font-style: italic">...</span>
         strcat(<span style="color: #BA2121">&#39;new_f_S_whenNis&#39;</span>, num2str(<span style="color: #666666">100</span>), <span style="color: #BA2121">&#39;.pdf&#39;</span>);
    plot_approx(g, <span style="color: #666666">100</span>, M, plot_filename);
<span style="color: #008000; font-weight: bold">end</span>

<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span>b_coeffs =<span style="color: #bbbbbb"> </span><span style="color: #0000FF">integrate_coeffs</span>(f, N, M)<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>b = <span style="color: #008000">zeros</span>(N,<span style="color: #666666">1</span>);
    left_end = <span style="color: #666666">-</span><span style="color: #008000">pi</span>; right_end = <span style="color: #008000">pi</span>;
    <span style="color: #008000; font-weight: bold">for</span> n = <span style="color: #666666">1</span>:N
        f_sin = @(t) f(t)<span style="color: #666666">*</span><span style="color: #008000">sin</span>(n<span style="color: #666666">*</span>t);     
        b(n) = (<span style="color: #666666">1/</span><span style="color: #008000">pi</span>)<span style="color: #666666">*</span>trapezoidal(f_sin, left_end, right_end, M);
    <span style="color: #008000; font-weight: bold">end</span>
    b_coeffs = b;
<span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">    </span>
<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">test_integrate_coeffs</span>()<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span><span style="color: #408080; font-style: italic">% Check that sin(nt) are integrated exactly by trapezoidal</span>
    f = @() <span style="color: #666666">1</span>;
    tol = <span style="color: #666666">1E-14</span>;
    N = <span style="color: #666666">10</span>;  M = <span style="color: #666666">100</span>;
    b = integrate_coeffs(f, N, M);
    b
    <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = <span style="color: #666666">1</span>:N
        err = <span style="color: #008000">abs</span>(b(<span style="color: #008000">i</span>))  <span style="color: #408080; font-style: italic">% Supposed to be zero</span>
        assert(err <span style="color: #666666">&lt;</span> tol, <span style="color: #BA2121">&#39;n = %d, err = %g&#39;</span>, n, err);
    <span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">end</span>

<span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">plot_approx</span>(f, N, M, filename)<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span><span style="color: #008000; font-weight: bold">function</span> result = S_N(b,t)
        sum = <span style="color: #666666">0</span>;
        <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = <span style="color: #666666">1</span>:N
            sum = sum <span style="color: #666666">+</span> b(<span style="color: #008000">i</span>)<span style="color: #666666">*</span><span style="color: #008000">sin</span>((<span style="color: #008000">i</span>)<span style="color: #666666">*</span>t);
        <span style="color: #008000; font-weight: bold">end</span>
        result = sum;
    <span style="color: #008000; font-weight: bold">end</span>        
    left_end = <span style="color: #666666">-</span><span style="color: #008000">pi</span>;  right_end = <span style="color: #008000">pi</span>;
    time = <span style="color: #008000">linspace</span>(<span style="color: #666666">-</span><span style="color: #008000">pi</span>,<span style="color: #008000">pi</span>,<span style="color: #666666">100</span>);
    y = f(time);
    b = integrate_coeffs(f, N, M);
    y_approx = S_N(b,time);
    h = figure;    plot(time,y,<span style="color: #BA2121">&#39;k-&#39;</span>,time,y_approx,<span style="color: #BA2121">&#39;k--&#39;</span>);
    xlabel(<span style="color: #BA2121">&#39;t&#39;</span>);  ylabel(<span style="color: #BA2121">&#39;f (solid line) and S (dashed line)&#39;</span>);
    print(filename, <span style="color: #BA2121">&#39;-dpdf&#39;</span>);
<span style="color: #008000; font-weight: bold">end</span>
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>d)</b>
A remarkable property of the trapezoidal rule is that it is exact for integrals
\( \int_{-\pi}^{\pi}\sin nt\,dt \) (when subintervals are of equal size). Use this
property to create a function <code>test_integrate_coeff</code> to verify the
implementation of <code>integrate_coeffs</code>.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_40_4" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_40_4">

<p>
See code given above.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>e)</b>
Implement the choice \( f(t) = \frac{1}{\pi}t \) as a Matlab function
<code>f(t)</code> and call <code>integrate_coeffs(f, 3, 100)</code> to see what the
optimal choice of \( b_1, b_2, b_3 \) is.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_40_5" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_40_5">

<p>
See code given above. Running the script produces a printout of the following values
for the \( b \) coefficients:

<p>

<!-- code=text (!bc dat) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"> 0.63641032
-0.3178909
 0.2115779
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>f)</b>
Make a function <code>plot_approx(f, N, M, filename)</code> where you plot <code>f(t)</code>
together with the best approximation \( S_N \) as computed above,
using \( M \) intervals for numerical integration. Save the plot to a file
with name <code>filename</code>.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_40_6" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_40_6">

<p>
See code given above.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<!-- !bsubex -->
<!-- Run <code>plot_approx(f, N, M, 'frame_%04d.png')</code> for \( f(t) = \frac{1}{\pi}t \) -->
<!-- for \( N=1,\ldots,100 \). Make an animation of the plot files to illustrate -->
<!-- how the approximation improves as \( N \) is increased. -->
<!-- !esubex -->

<p>
<b>g)</b>
Run <code>plot_approx(f, N, M, filename)</code> for \( f(t) = \frac{1}{\pi}t \)
for \( N=3,6,12,24 \). Observe how the approximation improves.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_40_7" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_40_7">

<p>
See code given above. Running the program will produce one plot (Figure <a href="#fig:S_N3">15</a>, Figure <a href="#fig:S_N6">16</a>, Figure <a href="#fig:S_N12">17</a> and Figure <a href="#fig:S_N24">18</a>) for each value of \( N \). We see from the plots that the larger the \( N \), the better the approximation.

<p>
<center> <!-- figure label: --> <div id="fig:S_N3"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 15:  The function \( f(t) \) and its approximation \( S_N(t) \) when \( N = 3 \).  <!-- caption label: fig:S_N3 --> </p></center>
<p><img src="figs/S_whenNis3.png" align="bottom" width=800></p>
</center>

<p>
<center> <!-- figure label: --> <div id="fig:S_N6"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 16:  The function \( f(t) \) and its approximation \( S_N(t) \) when \( N = 6 \).  <!-- caption label: fig:S_N6 --> </p></center>
<p><img src="figs/S_whenNis6.png" align="bottom" width=800></p>
</center>

<p>
<center> <!-- figure label: --> <div id="fig:S_N12"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 17:  The function \( f(t) \) and its approximation \( S_N(t) \) when \( N = 12 \).  <!-- caption label: fig:S_N12 --> </p></center>
<p><img src="figs/S_whenNis12.png" align="bottom" width=800></p>
</center>

<p>
<center> <!-- figure label: --> <div id="fig:S_N24"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 18:  The function \( f(t) \) and its approximation \( S_N(t) \) when \( N = 24 \).  <!-- caption label: fig:S_N24 --> </p></center>
<p><img src="figs/S_whenNis24.png" align="bottom" width=800></p>
</center>

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>h)</b>
Run <code>plot_approx</code> for \( f(t) = e^{-(t-\pi)} \) and \( N=100 \).
Observe a fundamental problem: regardless of \( N \), \( S_N(-\pi)=0 \), not
\( e^{2\pi}\approx 535 \). (There are ways to fix this issue.)

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_40_8" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_40_8">

<p>
See code given above. Running the program (also) produces the plot seen in Figure <a href="#fig:new_f_S_N100">19</a>. Clearly, the approximation is no good at the endpoints of the interval.

<p>
<center> <!-- figure label: --> <div id="fig:new_f_S_N100"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 19:  The new function \( f(t) \) and its approximation \( S_N(t) \) when \( N = 100 \).  <!-- caption label: fig:new_f_S_N100 --> </p></center>
<p><img src="figs/S_whenNis3.png" align="bottom" width=800></p>
</center>

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<!-- More real applications of integrals, arc etc -->
<!-- More: Monte Carlo? -->
<!-- Unequal intervals -->

<p>
Filename: <code>autofit_sines.m</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:exer:trapezoidal:2D">Exercise 41: Derive the trapezoidal rule for a double integral</h2>

<p>
Use ideas in the section <a href="._p4c-bootstrap-Matlab016.html#sec:int:double:midpoint">The midpoint rule for a double integral</a> to derive a formula
for computing a double integral \( \int_a^b\int_c^d f(x,y)dydx \) by the
trapezoidal rule.  Implement and test this rule.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_41_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_41_1">

<p>
We introduce a help function \( g(x) \) and write

$$ \int_a^b \int_c^d f(x,y) dydx = \int_a^b g(x)dx,\quad
g(x) = \int_c^d f(x,y) dy\thinspace .$$

Next, we apply the trapezoidal rule (<a href="._p4c-bootstrap-Matlab015.html#sec:integrals:trap">The composite trapezoidal rule</a>) to each of the integrals

$$ \int_a^b g(x)dx,\quad
g(x) = \int_c^d f(x,y) dy\thinspace .$$

<p>
Starting with \( g(x)=\int_c^d f(x,y)dy \), we introduce
\( n_y \) intervals on \( [c,d] \) with length \( h_y \). The trapezoidal rule
for this integral then becomes

$$ g(x) = \int_c^d f(x,y) dy \approx  h_y \left[\frac{1}{2}f(x,c) + \sum_{j=1}^{n_y-1}f(x,y_j) + \frac{1}{2}f(x,d) \right],$$

with \( y_j = c + jh_y \).
For the outer integral \( \int_a^b g(x)dx \), we get:

$$ \int_a^b g(x)dx \approx h_x \left[\frac{1}{2}g(a) + \sum_{i=1}^{n_x-1}g(x_i) + \frac{1}{2}g(b) \right],
\quad x_i=a + ih_x\thinspace .$$

Combining the formulas, we get the <em>composite trapezoidal method
for a double integral</em>:

$$
\begin{align}
\int_a^b \int_c^d f(x,y) dydx &\approx
h_x \biggl[\frac{1}{2}\left(h_y \left[\frac{1}{2}f(a,c) +
\sum_{j=1}^{n_y-1}f(a,y_j) + \frac{1}{2}f(a,d) \right]\right) + \nonumber\\ 
&\quad \sum_{i=1}^{n_x-1}\left(h_y \left[\frac{1}{2}f(x_i,c) + \sum_{j=1}^{n_y-1}f(x_i,y_j) + \frac{1}{2}f(x_i,d) \right]\right)+\nonumber\\ 
&\quad \frac{1}{2}\left(h_y \left[\frac{1}{2}f(b,c) + \sum_{j=1}^{n_y-1}f(b,y_j) + \frac{1}{2}f(b,d) \right]\right) \biggr]\nonumber\\ 
&=
h_xh_y \biggl[\frac{1}{4}\left(f(a,c) + f(a,d) + f(b,c) + f(b,d) \right) +\nonumber\\ 
&\quad \frac{1}{2}\sum_{i=1}^{n_x-1}\left(f(a + ih_x,c) + f(a + ih_x,d)\right) +
\nonumber\\ 
&\quad \frac{1}{2}\sum_{j=1}^{n_y-1}\left(f(a,c + jh_y) + f(b,c + jh_y)\right) +
\nonumber\\ 
&\quad \sum_{i=1}^{n_x-1} \sum_{j=1}^{n_y-1} f(a + ih_x, c + jh_y)\biggr]\thinspace .
\nonumber
\end{align}
$$

<p>
The formula may be implemented and tested as shown in <code>trapezoidal_double.m</code> and
<code>test_trapezoidal_double.m</code>, respectively:

<p>

<!-- code=matlab (!bc mpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span>result =<span style="color: #bbbbbb"> </span><span style="color: #0000FF">trapezoidal_double</span>(f, a, b, c, d, nx, ny)<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span>hx = (b <span style="color: #666666">-</span> a)<span style="color: #666666">/</span>nx;
    hy = (d <span style="color: #666666">-</span> c)<span style="color: #666666">/</span>ny;
    I = <span style="color: #666666">0.25*</span>(f(a, c) <span style="color: #666666">+</span> f(a, d) <span style="color: #666666">+</span> f(b, c) <span style="color: #666666">+</span> f(b, d));
    Ix = <span style="color: #666666">0</span>;
    <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = <span style="color: #666666">1</span>:(nx<span style="color: #666666">-1</span>)
        xi = a <span style="color: #666666">+</span> <span style="color: #008000">i</span><span style="color: #666666">*</span>hx;
        Ix = Ix <span style="color: #666666">+</span> f(xi, c) <span style="color: #666666">+</span> f(xi, d);
    <span style="color: #008000; font-weight: bold">end</span>
    I = I <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>Ix;
    Iy = <span style="color: #666666">0</span>;
    <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">j</span> = <span style="color: #666666">1</span>:(ny<span style="color: #666666">-1</span>)
        yj = c <span style="color: #666666">+</span> <span style="color: #008000">j</span><span style="color: #666666">*</span>hy;
        Iy = Iy <span style="color: #666666">+</span> f(a, yj) <span style="color: #666666">+</span> f(b, yj);
    <span style="color: #008000; font-weight: bold">end</span>
    I = I <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>Iy;
    Ixy = <span style="color: #666666">0</span>;
    <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = <span style="color: #666666">1</span>:(nx<span style="color: #666666">-1</span>) 
        <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">j</span> = <span style="color: #666666">1</span>:(ny<span style="color: #666666">-1</span>) 
            xi = a <span style="color: #666666">+</span> <span style="color: #008000">i</span><span style="color: #666666">*</span>hx;
            yj = c <span style="color: #666666">+</span> <span style="color: #008000">j</span><span style="color: #666666">*</span>hy;
            Ixy = Ixy <span style="color: #666666">+</span> f(xi, yj);
        <span style="color: #008000; font-weight: bold">end</span>
    <span style="color: #008000; font-weight: bold">end</span>
    I = I <span style="color: #666666">+</span> Ixy;
    I = hx<span style="color: #666666">*</span>hy<span style="color: #666666">*</span>I;
    result = I;
<span style="color: #008000; font-weight: bold">end</span>
</pre></div>
<p>

<!-- code=matlab (!bc mpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">test_trapezoidal_double</span>()<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span><span style="color: #408080; font-style: italic">% Test that a linear function is integrated exactly.</span>
    f = @(x, y) <span style="color: #666666">2*</span>x <span style="color: #666666">+</span> y;

    a = <span style="color: #666666">0</span>;  b = <span style="color: #666666">2</span>;  c = <span style="color: #666666">2</span>;  d = <span style="color: #666666">3</span>;
    syms x y;
    I_expected = int(int(f, y, c, d), x, a, b);
    <span style="color: #408080; font-style: italic">% Test three cases: nx &lt; ny, nx = ny, nx &gt; ny</span>
    nx = <span style="color: #666666">3</span>;  ny = <span style="color: #666666">5</span>;
    <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = (<span style="color: #666666">0</span>:<span style="color: #666666">2</span>)
        nx = nx <span style="color: #666666">+</span> <span style="color: #666666">1</span>;  ny = ny <span style="color: #666666">-</span> <span style="color: #666666">1</span>;
        I_computed = trapezoidal_double(f, a, b, c, d, nx, ny)
        tol = <span style="color: #666666">1E-14</span>;       
        <span style="color: #408080; font-style: italic">%fprintf(&#39;I_expected = %g, I_computed = %g\n&#39;,...</span>
        <span style="color: #408080; font-style: italic">%                                    I_expected, I_computed);</span>
        err = <span style="color: #008000">abs</span>(I_computed <span style="color: #666666">-</span> I_expected);
        assert(absI_computed <span style="color: #666666">-</span> I_expected) <span style="color: #666666">&lt;</span> tol);
    <span style="color: #008000; font-weight: bold">end</span>
<span style="color: #008000; font-weight: bold">end</span>
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>trapezoidal_double.m</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:exer:MC:ellipse">Exercise 42: Compute the area of a triangle by Monte Carlo integration</h2>

<p>
Use the Monte Carlo method from the section <a href="._p4c-bootstrap-Matlab016.html#sec:int:complex:domain">Monte Carlo integration for complex-shaped domains</a> to
compute the area of a triangle with vertices at \( (-1,0) \), \( (1,0) \),
and \( (3,0) \).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_42_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_42_1">

<p>
The program <code>MC_triangle.m</code> may be written as:

<p>

<!-- code=matlab (!bc mpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span><span style="color: #0000FF">MC_triangle</span>()<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span><span style="color: #408080; font-style: italic">% Utlize the symmetry of domain about y-axis</span>
    g = @(x, y) <span style="color: #666666">-1</span> <span style="color: #666666">+</span> <span style="color: #666666">2*</span>(<span style="color: #666666">0</span> <span style="color: #666666">&lt;</span>= y <span style="color: #666666">&amp;&amp;</span> y <span style="color: #666666">&lt;</span>= <span style="color: #666666">-3*</span><span style="color: #008000">abs</span>(x) <span style="color: #666666">+</span> <span style="color: #666666">3</span>);
    MonteCarlo_double(@(x, y) <span style="color: #666666">1</span>, g, <span style="color: #666666">-1</span>, <span style="color: #666666">1</span>, <span style="color: #666666">0</span>, <span style="color: #666666">3</span>, <span style="color: #666666">1000</span>)
<span style="color: #008000; font-weight: bold">end</span>
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>MC_triangle.m</code>.

<p>
<!-- --- end exercise --- -->

<p>
<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">
  <li class="previous">
    <a href="._p4c-bootstrap-Matlab016.html">&larr; Prev</a>
  </li>
  <li class="next">
    <a href="._p4c-bootstrap-Matlab018.html">Next &rarr;</a>
  </li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


</body>
</html>
    

